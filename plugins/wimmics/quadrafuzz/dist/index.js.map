{"version":3,"file":"index.js","sources":["../../sdk/dist/index.js","../../sdk-parammgr/dist/index.js","../src/Node.js","../src/utils/webaudio-controls.js","../src/Gui/assets/background.png","../src/Gui/assets/MiniMoog_Main.png","../src/Gui/assets/switch_1.png","../src/Gui/Gui.js","../src/Gui/index.js","../src/index.js"],"sourcesContent":["// src/WebAudioModule.js\nvar WebAudioModule = class {\n  static get isWebAudioModuleConstructor() {\n    return true;\n  }\n  static createInstance(groupId, audioContext, initialState) {\n    return new this(groupId, audioContext).initialize(initialState);\n  }\n  constructor(groupId, audioContext) {\n    this._groupId = groupId;\n    this._audioContext = audioContext;\n    this._initialized = false;\n    this._audioNode = void 0;\n    this._timestamp = performance.now();\n    this._guiModuleUrl = void 0;\n    this._descriptorUrl = \"./descriptor.json\";\n    this._descriptor = {\n      name: `WebAudioModule_${this.constructor.name}`,\n      vendor: \"WebAudioModuleVendor\",\n      description: \"\",\n      version: \"0.0.0\",\n      apiVersion: \"2.0.0\",\n      thumbnail: \"\",\n      keywords: [],\n      isInstrument: false,\n      website: \"\",\n      hasAudioInput: true,\n      hasAudioOutput: true,\n      hasAutomationInput: true,\n      hasAutomationOutput: true,\n      hasMidiInput: true,\n      hasMidiOutput: true,\n      hasMpeInput: true,\n      hasMpeOutput: true,\n      hasOscInput: true,\n      hasOscOutput: true,\n      hasSysexInput: true,\n      hasSysexOutput: true\n    };\n  }\n  get isWebAudioModule() {\n    return true;\n  }\n  get groupId() {\n    return this._groupId;\n  }\n  get moduleId() {\n    return this.vendor + this.name;\n  }\n  get instanceId() {\n    return this.moduleId + this._timestamp;\n  }\n  get descriptor() {\n    return this._descriptor;\n  }\n  get name() {\n    return this.descriptor.name;\n  }\n  get vendor() {\n    return this.descriptor.vendor;\n  }\n  get audioContext() {\n    return this._audioContext;\n  }\n  get audioNode() {\n    if (!this.initialized)\n      console.warn(\"WAM should be initialized before getting the audioNode\");\n    return this._audioNode;\n  }\n  set audioNode(node) {\n    this._audioNode = node;\n  }\n  get initialized() {\n    return this._initialized;\n  }\n  set initialized(value) {\n    this._initialized = value;\n  }\n  async createAudioNode(initialState) {\n    throw new TypeError(\"createAudioNode() not provided\");\n  }\n  async initialize(state) {\n    if (!this._audioNode)\n      this.audioNode = await this.createAudioNode();\n    this.initialized = true;\n    return this;\n  }\n  async _loadGui() {\n    const url = this._guiModuleUrl;\n    if (!url)\n      throw new TypeError(\"Gui module not found\");\n    return import(\n      /* webpackIgnore: true */\n      url\n    );\n  }\n  async _loadDescriptor() {\n    const url = this._descriptorUrl;\n    if (!url)\n      throw new TypeError(\"Descriptor not found\");\n    const response = await fetch(url);\n    const descriptor = await response.json();\n    Object.assign(this._descriptor, descriptor);\n    return this._descriptor;\n  }\n  async createGui() {\n    if (!this.initialized)\n      console.warn(\"Plugin should be initialized before getting the gui\");\n    if (!this._guiModuleUrl)\n      return void 0;\n    const { createElement } = await this._loadGui();\n    return createElement(this);\n  }\n  destroyGui() {\n  }\n};\nvar WebAudioModule_default = WebAudioModule;\n\n// src/RingBuffer.js\nvar getRingBuffer = (moduleId) => {\n  const audioWorkletGlobalScope = globalThis;\n  class RingBuffer2 {\n    static getStorageForCapacity(capacity, Type) {\n      if (!Type.BYTES_PER_ELEMENT) {\n        throw new Error(\"Pass in a ArrayBuffer subclass\");\n      }\n      const bytes = 8 + (capacity + 1) * Type.BYTES_PER_ELEMENT;\n      return new SharedArrayBuffer(bytes);\n    }\n    constructor(sab, Type) {\n      if (!Type.BYTES_PER_ELEMENT) {\n        throw new Error(\"Pass a concrete typed array class as second argument\");\n      }\n      this._Type = Type;\n      this._capacity = (sab.byteLength - 8) / Type.BYTES_PER_ELEMENT;\n      this.buf = sab;\n      this.write_ptr = new Uint32Array(this.buf, 0, 1);\n      this.read_ptr = new Uint32Array(this.buf, 4, 1);\n      this.storage = new Type(this.buf, 8, this._capacity);\n    }\n    get type() {\n      return this._Type.name;\n    }\n    push(elements) {\n      const rd = Atomics.load(this.read_ptr, 0);\n      const wr = Atomics.load(this.write_ptr, 0);\n      if ((wr + 1) % this._storageCapacity() === rd) {\n        return 0;\n      }\n      const toWrite = Math.min(this._availableWrite(rd, wr), elements.length);\n      const firstPart = Math.min(this._storageCapacity() - wr, toWrite);\n      const secondPart = toWrite - firstPart;\n      this._copy(elements, 0, this.storage, wr, firstPart);\n      this._copy(elements, firstPart, this.storage, 0, secondPart);\n      Atomics.store(this.write_ptr, 0, (wr + toWrite) % this._storageCapacity());\n      return toWrite;\n    }\n    pop(elements) {\n      const rd = Atomics.load(this.read_ptr, 0);\n      const wr = Atomics.load(this.write_ptr, 0);\n      if (wr === rd) {\n        return 0;\n      }\n      const isArray = !Number.isInteger(elements);\n      const toRead = Math.min(this._availableRead(rd, wr), isArray ? elements.length : elements);\n      if (isArray) {\n        const firstPart = Math.min(this._storageCapacity() - rd, toRead);\n        const secondPart = toRead - firstPart;\n        this._copy(this.storage, rd, elements, 0, firstPart);\n        this._copy(this.storage, 0, elements, firstPart, secondPart);\n      }\n      Atomics.store(this.read_ptr, 0, (rd + toRead) % this._storageCapacity());\n      return toRead;\n    }\n    get empty() {\n      const rd = Atomics.load(this.read_ptr, 0);\n      const wr = Atomics.load(this.write_ptr, 0);\n      return wr === rd;\n    }\n    get full() {\n      const rd = Atomics.load(this.read_ptr, 0);\n      const wr = Atomics.load(this.write_ptr, 0);\n      return (wr + 1) % this._capacity !== rd;\n    }\n    get capacity() {\n      return this._capacity - 1;\n    }\n    get availableRead() {\n      const rd = Atomics.load(this.read_ptr, 0);\n      const wr = Atomics.load(this.write_ptr, 0);\n      return this._availableRead(rd, wr);\n    }\n    get availableWrite() {\n      const rd = Atomics.load(this.read_ptr, 0);\n      const wr = Atomics.load(this.write_ptr, 0);\n      return this._availableWrite(rd, wr);\n    }\n    _availableRead(rd, wr) {\n      if (wr > rd) {\n        return wr - rd;\n      }\n      return wr + this._storageCapacity() - rd;\n    }\n    _availableWrite(rd, wr) {\n      let rv = rd - wr - 1;\n      if (wr >= rd) {\n        rv += this._storageCapacity();\n      }\n      return rv;\n    }\n    _storageCapacity() {\n      return this._capacity;\n    }\n    _copy(input, offsetInput, output, offsetOutput, size) {\n      for (let i = 0; i < size; i++) {\n        output[offsetOutput + i] = input[offsetInput + i];\n      }\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    const ModuleScope = audioWorkletGlobalScope.webAudioModules.getModuleScope(moduleId);\n    if (!ModuleScope.RingBuffer)\n      ModuleScope.RingBuffer = RingBuffer2;\n  }\n  return RingBuffer2;\n};\nvar RingBuffer_default = getRingBuffer;\n\n// src/WamArrayRingBuffer.js\nvar getWamArrayRingBuffer = (moduleId) => {\n  const audioWorkletGlobalScope = globalThis;\n  class WamArrayRingBuffer {\n    static DefaultArrayCapacity = 2;\n    static getStorageForEventCapacity(RingBuffer2, arrayLength, arrayType, maxArrayCapacity = void 0) {\n      if (maxArrayCapacity === void 0)\n        maxArrayCapacity = WamArrayRingBuffer.DefaultArrayCapacity;\n      else\n        maxArrayCapacity = Math.max(maxArrayCapacity, WamArrayRingBuffer.DefaultArrayCapacity);\n      if (!arrayType.BYTES_PER_ELEMENT) {\n        throw new Error(\"Pass in a ArrayBuffer subclass\");\n      }\n      const capacity = arrayLength * maxArrayCapacity;\n      return RingBuffer2.getStorageForCapacity(capacity, arrayType);\n    }\n    constructor(RingBuffer2, sab, arrayLength, arrayType, maxArrayCapacity = void 0) {\n      if (!arrayType.BYTES_PER_ELEMENT) {\n        throw new Error(\"Pass in a ArrayBuffer subclass\");\n      }\n      this._arrayLength = arrayLength;\n      this._arrayType = arrayType;\n      this._arrayElementSizeBytes = arrayType.BYTES_PER_ELEMENT;\n      this._arraySizeBytes = this._arrayLength * this._arrayElementSizeBytes;\n      this._sab = sab;\n      if (maxArrayCapacity === void 0)\n        maxArrayCapacity = WamArrayRingBuffer.DefaultArrayCapacity;\n      else\n        maxArrayCapacity = Math.max(maxArrayCapacity, WamArrayRingBuffer.DefaultArrayCapacity);\n      this._arrayArray = new arrayType(this._arrayLength);\n      this._rb = new RingBuffer2(this._sab, arrayType);\n    }\n    write(array) {\n      if (array.length !== this._arrayLength)\n        return false;\n      const elementsAvailable = this._rb.availableWrite;\n      if (elementsAvailable < this._arrayLength)\n        return false;\n      let success = true;\n      const elementsWritten = this._rb.push(array);\n      if (elementsWritten != this._arrayLength)\n        success = false;\n      return success;\n    }\n    read(array, newest) {\n      if (array.length !== this._arrayLength)\n        return false;\n      const elementsAvailable = this._rb.availableRead;\n      if (elementsAvailable < this._arrayLength)\n        return false;\n      if (newest && elementsAvailable > this._arrayLength)\n        this._rb.pop(elementsAvailable - this._arrayLength);\n      let success = false;\n      const elementsRead = this._rb.pop(array);\n      if (elementsRead === this._arrayLength)\n        success = true;\n      return success;\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    const ModuleScope = audioWorkletGlobalScope.webAudioModules.getModuleScope(moduleId);\n    if (!ModuleScope.WamArrayRingBuffer)\n      ModuleScope.WamArrayRingBuffer = WamArrayRingBuffer;\n  }\n  return WamArrayRingBuffer;\n};\nvar WamArrayRingBuffer_default = getWamArrayRingBuffer;\n\n// src/WamEnv.js\nvar initializeWamEnv = (apiVersion) => {\n  const audioWorkletGlobalScope = globalThis;\n  if (audioWorkletGlobalScope.AudioWorkletProcessor && audioWorkletGlobalScope.webAudioModules)\n    return;\n  const moduleScopes = /* @__PURE__ */ new Map();\n  const groups = /* @__PURE__ */ new Map();\n  class WamEnv {\n    constructor() {\n    }\n    get apiVersion() {\n      return apiVersion;\n    }\n    getModuleScope(moduleId) {\n      if (!moduleScopes.has(moduleId))\n        moduleScopes.set(moduleId, {});\n      return moduleScopes.get(moduleId);\n    }\n    getGroup(groupId, groupKey) {\n      const group = groups.get(groupId);\n      if (group.validate(groupKey))\n        return group;\n      else\n        throw \"Invalid key\";\n    }\n    addGroup(group) {\n      if (!groups.has(group.groupId))\n        groups.set(group.groupId, group);\n    }\n    removeGroup(group) {\n      groups.delete(group.groupId);\n    }\n    addWam(wam) {\n      const group = groups.get(wam.groupId);\n      group.addWam(wam);\n    }\n    removeWam(wam) {\n      const group = groups.get(wam.groupId);\n      group.removeWam(wam);\n    }\n    connectEvents(groupId, fromId, toId, output = 0) {\n      const group = groups.get(groupId);\n      group.connectEvents(fromId, toId, output);\n    }\n    disconnectEvents(groupId, fromId, toId, output) {\n      const group = groups.get(groupId);\n      group.disconnectEvents(fromId, toId, output);\n    }\n    emitEvents(from, ...events) {\n      const group = groups.get(from.groupId);\n      group.emitEvents(from, ...events);\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    if (!audioWorkletGlobalScope.webAudioModules)\n      audioWorkletGlobalScope.webAudioModules = new WamEnv();\n  }\n};\nvar WamEnv_default = initializeWamEnv;\n\n// src/WamGroup.js\nvar initializeWamGroup = (groupId, groupKey) => {\n  const audioWorkletGlobalScope = globalThis;\n  class WamGroup {\n    constructor(groupId2, groupKey2) {\n      this._groupId = groupId2;\n      this._validate = (key) => {\n        return key == groupKey2;\n      };\n      this._processors = /* @__PURE__ */ new Map();\n      this._eventGraph = /* @__PURE__ */ new Map();\n    }\n    get groupId() {\n      return this._groupId;\n    }\n    get processors() {\n      return this._processors;\n    }\n    get eventGraph() {\n      return this._eventGraph;\n    }\n    validate(groupKey2) {\n      return this._validate(groupKey2);\n    }\n    addWam(wam) {\n      this._processors.set(wam.instanceId, wam);\n    }\n    removeWam(wam) {\n      if (this._eventGraph.has(wam))\n        this._eventGraph.delete(wam);\n      this._eventGraph.forEach((outputMap) => {\n        outputMap.forEach((set) => {\n          if (set && set.has(wam))\n            set.delete(wam);\n        });\n      });\n      this._processors.delete(wam.instanceId);\n    }\n    connectEvents(fromId, toId, output) {\n      const from = this._processors.get(fromId);\n      const to = this._processors.get(toId);\n      let outputMap;\n      if (this._eventGraph.has(from)) {\n        outputMap = this._eventGraph.get(from);\n      } else {\n        outputMap = [];\n        this._eventGraph.set(from, outputMap);\n      }\n      if (outputMap[output]) {\n        outputMap[output].add(to);\n      } else {\n        const set = /* @__PURE__ */ new Set();\n        set.add(to);\n        outputMap[output] = set;\n      }\n    }\n    disconnectEvents(fromId, toId, output) {\n      const from = this._processors.get(fromId);\n      if (!this._eventGraph.has(from))\n        return;\n      const outputMap = this._eventGraph.get(from);\n      if (typeof toId === \"undefined\") {\n        outputMap.forEach((set) => {\n          if (set)\n            set.clear();\n        });\n        return;\n      }\n      const to = this._processors.get(toId);\n      if (typeof output === \"undefined\") {\n        outputMap.forEach((set) => {\n          if (set)\n            set.delete(to);\n        });\n        return;\n      }\n      if (!outputMap[output])\n        return;\n      outputMap[output].delete(to);\n    }\n    emitEvents(from, ...events) {\n      if (!this._eventGraph.has(from))\n        return;\n      const downstream = this._eventGraph.get(from);\n      downstream.forEach((set) => {\n        if (set)\n          set.forEach((wam) => wam.scheduleEvents(...events));\n      });\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    audioWorkletGlobalScope.webAudioModules.addGroup(new WamGroup(groupId, groupKey));\n  }\n};\nvar WamGroup_default = initializeWamGroup;\n\n// src/WamEventRingBuffer.js\nvar getWamEventRingBuffer = (moduleId) => {\n  const audioWorkletGlobalScope = globalThis;\n  class WamEventRingBuffer2 {\n    static DefaultExtraBytesPerEvent = 64;\n    static WamEventBaseBytes = 4 + 1 + 8;\n    static WamAutomationEventBytes = WamEventRingBuffer2.WamEventBaseBytes + 2 + 8 + 1;\n    static WamTransportEventBytes = WamEventRingBuffer2.WamEventBaseBytes + 4 + 8 + 8 + 1 + 1 + 1;\n    static WamMidiEventBytes = WamEventRingBuffer2.WamEventBaseBytes + 1 + 1 + 1;\n    static WamBinaryEventBytes = WamEventRingBuffer2.WamEventBaseBytes + 4;\n    static getStorageForEventCapacity(RingBuffer2, eventCapacity, maxBytesPerEvent = void 0) {\n      if (maxBytesPerEvent === void 0)\n        maxBytesPerEvent = WamEventRingBuffer2.DefaultExtraBytesPerEvent;\n      else\n        maxBytesPerEvent = Math.max(maxBytesPerEvent, WamEventRingBuffer2.DefaultExtraBytesPerEvent);\n      const capacity = (Math.max(WamEventRingBuffer2.WamAutomationEventBytes, WamEventRingBuffer2.WamTransportEventBytes, WamEventRingBuffer2.WamMidiEventBytes, WamEventRingBuffer2.WamBinaryEventBytes) + maxBytesPerEvent) * eventCapacity;\n      return RingBuffer2.getStorageForCapacity(capacity, Uint8Array);\n    }\n    constructor(RingBuffer2, sab, parameterIds, maxBytesPerEvent = void 0) {\n      this._eventSizeBytes = {};\n      this._encodeEventType = {};\n      this._decodeEventType = {};\n      const wamEventTypes = [\"wam-automation\", \"wam-transport\", \"wam-midi\", \"wam-sysex\", \"wam-mpe\", \"wam-osc\", \"wam-info\"];\n      wamEventTypes.forEach((type, encodedType) => {\n        let byteSize = 0;\n        switch (type) {\n          case \"wam-automation\":\n            byteSize = WamEventRingBuffer2.WamAutomationEventBytes;\n            break;\n          case \"wam-transport\":\n            byteSize = WamEventRingBuffer2.WamTransportEventBytes;\n            break;\n          case \"wam-mpe\":\n          case \"wam-midi\":\n            byteSize = WamEventRingBuffer2.WamMidiEventBytes;\n            break;\n          case \"wam-osc\":\n          case \"wam-sysex\":\n          case \"wam-info\":\n            byteSize = WamEventRingBuffer2.WamBinaryEventBytes;\n            break;\n          default:\n            break;\n        }\n        this._eventSizeBytes[type] = byteSize;\n        this._encodeEventType[type] = encodedType;\n        this._decodeEventType[encodedType] = type;\n      });\n      this._parameterCode = 0;\n      this._parameterCodes = {};\n      this._encodeParameterId = {};\n      this._decodeParameterId = {};\n      this.setParameterIds(parameterIds);\n      this._sab = sab;\n      if (maxBytesPerEvent === void 0)\n        maxBytesPerEvent = WamEventRingBuffer2.DefaultExtraBytesPerEvent;\n      else\n        maxBytesPerEvent = Math.max(maxBytesPerEvent, WamEventRingBuffer2.DefaultExtraBytesPerEvent);\n      this._eventBytesAvailable = Math.max(WamEventRingBuffer2.WamAutomationEventBytes, WamEventRingBuffer2.WamTransportEventBytes, WamEventRingBuffer2.WamMidiEventBytes, WamEventRingBuffer2.WamBinaryEventBytes) + maxBytesPerEvent;\n      this._eventBytes = new ArrayBuffer(this._eventBytesAvailable);\n      this._eventBytesView = new DataView(this._eventBytes);\n      this._rb = new RingBuffer2(this._sab, Uint8Array);\n      this._eventSizeArray = new Uint8Array(this._eventBytes, 0, 4);\n      this._eventSizeView = new DataView(this._eventBytes, 0, 4);\n    }\n    _writeHeader(byteSize, type, time) {\n      let byteOffset = 0;\n      this._eventBytesView.setUint32(byteOffset, byteSize);\n      byteOffset += 4;\n      this._eventBytesView.setUint8(byteOffset, this._encodeEventType[type]);\n      byteOffset += 1;\n      this._eventBytesView.setFloat64(byteOffset, Number.isFinite(time) ? time : -1);\n      byteOffset += 8;\n      return byteOffset;\n    }\n    _encode(event) {\n      let byteOffset = 0;\n      const { type, time } = event;\n      switch (event.type) {\n        case \"wam-automation\":\n          {\n            if (!(event.data.id in this._encodeParameterId))\n              break;\n            const byteSize = this._eventSizeBytes[type];\n            byteOffset = this._writeHeader(byteSize, type, time);\n            const { data } = event;\n            const encodedParameterId = this._encodeParameterId[data.id];\n            const { value, normalized } = data;\n            this._eventBytesView.setUint16(byteOffset, encodedParameterId);\n            byteOffset += 2;\n            this._eventBytesView.setFloat64(byteOffset, value);\n            byteOffset += 8;\n            this._eventBytesView.setUint8(byteOffset, normalized ? 1 : 0);\n            byteOffset += 1;\n          }\n          break;\n        case \"wam-transport\":\n          {\n            const byteSize = this._eventSizeBytes[type];\n            byteOffset = this._writeHeader(byteSize, type, time);\n            const { data } = event;\n            const {\n              currentBar,\n              currentBarStarted,\n              tempo,\n              timeSigNumerator,\n              timeSigDenominator,\n              playing\n            } = data;\n            this._eventBytesView.setUint32(byteOffset, currentBar);\n            byteOffset += 4;\n            this._eventBytesView.setFloat64(byteOffset, currentBarStarted);\n            byteOffset += 8;\n            this._eventBytesView.setFloat64(byteOffset, tempo);\n            byteOffset += 8;\n            this._eventBytesView.setUint8(byteOffset, timeSigNumerator);\n            byteOffset += 1;\n            this._eventBytesView.setUint8(byteOffset, timeSigDenominator);\n            byteOffset += 1;\n            this._eventBytesView.setUint8(byteOffset, playing ? 1 : 0);\n            byteOffset += 1;\n          }\n          break;\n        case \"wam-mpe\":\n        case \"wam-midi\":\n          {\n            const byteSize = this._eventSizeBytes[type];\n            byteOffset = this._writeHeader(byteSize, type, time);\n            const { data } = event;\n            const { bytes } = data;\n            let b = 0;\n            while (b < 3) {\n              this._eventBytesView.setUint8(byteOffset, bytes[b]);\n              byteOffset += 1;\n              b++;\n            }\n          }\n          break;\n        case \"wam-osc\":\n        case \"wam-sysex\":\n        case \"wam-info\":\n          {\n            let bytes = null;\n            if (event.type === \"wam-info\") {\n              const { data } = event;\n              bytes = new TextEncoder().encode(data.instanceId);\n            } else {\n              const { data } = event;\n              bytes = data.bytes;\n            }\n            const numBytes = bytes.length;\n            const byteSize = this._eventSizeBytes[type];\n            byteOffset = this._writeHeader(byteSize + numBytes, type, time);\n            this._eventBytesView.setUint32(byteOffset, numBytes);\n            byteOffset += 4;\n            const bytesRequired = byteOffset + numBytes;\n            if (bytesRequired > this._eventBytesAvailable)\n              console.error(`Event requires ${bytesRequired} bytes but only ${this._eventBytesAvailable} have been allocated!`);\n            const buffer = new Uint8Array(this._eventBytes, byteOffset, numBytes);\n            buffer.set(bytes);\n            byteOffset += numBytes;\n          }\n          break;\n        default:\n          break;\n      }\n      return new Uint8Array(this._eventBytes, 0, byteOffset);\n    }\n    _decode() {\n      let byteOffset = 0;\n      const type = this._decodeEventType[this._eventBytesView.getUint8(byteOffset)];\n      byteOffset += 1;\n      let time = this._eventBytesView.getFloat64(byteOffset);\n      if (time === -1)\n        time = void 0;\n      byteOffset += 8;\n      switch (type) {\n        case \"wam-automation\": {\n          const encodedParameterId = this._eventBytesView.getUint16(byteOffset);\n          byteOffset += 2;\n          const value = this._eventBytesView.getFloat64(byteOffset);\n          byteOffset += 8;\n          const normalized = !!this._eventBytesView.getUint8(byteOffset);\n          byteOffset += 1;\n          if (!(encodedParameterId in this._decodeParameterId))\n            break;\n          const id = this._decodeParameterId[encodedParameterId];\n          const event = {\n            type,\n            time,\n            data: {\n              id,\n              value,\n              normalized\n            }\n          };\n          return event;\n        }\n        case \"wam-transport\": {\n          const currentBar = this._eventBytesView.getUint32(byteOffset);\n          byteOffset += 4;\n          const currentBarStarted = this._eventBytesView.getFloat64(byteOffset);\n          byteOffset += 8;\n          const tempo = this._eventBytesView.getFloat64(byteOffset);\n          byteOffset += 8;\n          const timeSigNumerator = this._eventBytesView.getUint8(byteOffset);\n          byteOffset += 1;\n          const timeSigDenominator = this._eventBytesView.getUint8(byteOffset);\n          byteOffset += 1;\n          const playing = this._eventBytesView.getUint8(byteOffset) == 1;\n          byteOffset += 1;\n          const event = {\n            type,\n            time,\n            data: {\n              currentBar,\n              currentBarStarted,\n              tempo,\n              timeSigNumerator,\n              timeSigDenominator,\n              playing\n            }\n          };\n          return event;\n        }\n        case \"wam-mpe\":\n        case \"wam-midi\": {\n          const bytes = [0, 0, 0];\n          let b = 0;\n          while (b < 3) {\n            bytes[b] = this._eventBytesView.getUint8(byteOffset);\n            byteOffset += 1;\n            b++;\n          }\n          const event = {\n            type,\n            time,\n            data: { bytes }\n          };\n          return event;\n        }\n        case \"wam-osc\":\n        case \"wam-sysex\":\n        case \"wam-info\": {\n          const numBytes = this._eventBytesView.getUint32(byteOffset);\n          byteOffset += 4;\n          const bytes = new Uint8Array(numBytes);\n          bytes.set(new Uint8Array(this._eventBytes, byteOffset, numBytes));\n          byteOffset += numBytes;\n          if (type === \"wam-info\") {\n            const instanceId = new TextDecoder().decode(bytes);\n            const data = { instanceId };\n            return { type, time, data };\n          } else {\n            const data = { bytes };\n            return { type, time, data };\n          }\n        }\n        default:\n          break;\n      }\n      return false;\n    }\n    write(...events) {\n      const numEvents = events.length;\n      let bytesAvailable = this._rb.availableWrite;\n      let numSkipped = 0;\n      let i = 0;\n      while (i < numEvents) {\n        const event = events[i];\n        const bytes = this._encode(event);\n        const eventSizeBytes = bytes.byteLength;\n        let bytesWritten = 0;\n        if (bytesAvailable >= eventSizeBytes) {\n          if (eventSizeBytes === 0)\n            numSkipped++;\n          else\n            bytesWritten = this._rb.push(bytes);\n        } else\n          break;\n        bytesAvailable -= bytesWritten;\n        i++;\n      }\n      return i - numSkipped;\n    }\n    read() {\n      if (this._rb.empty)\n        return [];\n      const events = [];\n      let bytesAvailable = this._rb.availableRead;\n      let bytesRead = 0;\n      while (bytesAvailable > 0) {\n        bytesRead = this._rb.pop(this._eventSizeArray);\n        bytesAvailable -= bytesRead;\n        const eventSizeBytes = this._eventSizeView.getUint32(0);\n        const eventBytes = new Uint8Array(this._eventBytes, 0, eventSizeBytes - 4);\n        bytesRead = this._rb.pop(eventBytes);\n        bytesAvailable -= bytesRead;\n        const decodedEvent = this._decode();\n        if (decodedEvent)\n          events.push(decodedEvent);\n      }\n      return events;\n    }\n    setParameterIds(parameterIds) {\n      this._encodeParameterId = {};\n      this._decodeParameterId = {};\n      parameterIds.forEach((parameterId) => {\n        let parameterCode = -1;\n        if (parameterId in this._parameterCodes)\n          parameterCode = this._parameterCodes[parameterId];\n        else {\n          parameterCode = this._generateParameterCode();\n          this._parameterCodes[parameterId] = parameterCode;\n        }\n        this._encodeParameterId[parameterId] = parameterCode;\n        this._decodeParameterId[parameterCode] = parameterId;\n      });\n    }\n    _generateParameterCode() {\n      if (this._parameterCode > 65535)\n        throw Error(\"Too many parameters have been registered!\");\n      return this._parameterCode++;\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    const ModuleScope = audioWorkletGlobalScope.webAudioModules.getModuleScope(moduleId);\n    if (!ModuleScope.WamEventRingBuffer)\n      ModuleScope.WamEventRingBuffer = WamEventRingBuffer2;\n  }\n  return WamEventRingBuffer2;\n};\nvar WamEventRingBuffer_default = getWamEventRingBuffer;\n\n// src/addFunctionModule.js\nvar addFunctionModule = (audioWorklet, processorFunction, ...injection) => {\n  const text = `(${processorFunction.toString()})(${injection.map((s) => JSON.stringify(s)).join(\", \")});`;\n  const url = URL.createObjectURL(new Blob([text], { type: \"text/javascript\" }));\n  return audioWorklet.addModule(url);\n};\nvar addFunctionModule_default = addFunctionModule;\n\n// src/WamParameter.js\nvar getWamParameter = (moduleId) => {\n  const audioWorkletGlobalScope = globalThis;\n  class WamParameter {\n    constructor(info) {\n      this.info = info;\n      this._value = info.defaultValue;\n    }\n    set value(value) {\n      this._value = value;\n    }\n    get value() {\n      return this._value;\n    }\n    set normalizedValue(valueNorm) {\n      this.value = this.info.denormalize(valueNorm);\n    }\n    get normalizedValue() {\n      return this.info.normalize(this.value);\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    const ModuleScope = audioWorkletGlobalScope.webAudioModules.getModuleScope(moduleId);\n    if (!ModuleScope.WamParameter)\n      ModuleScope.WamParameter = WamParameter;\n  }\n  return WamParameter;\n};\nvar WamParameter_default = getWamParameter;\n\n// src/WamParameterInfo.js\nvar getWamParameterInfo = (moduleId) => {\n  const audioWorkletGlobalScope = globalThis;\n  const normExp = (x, e) => e === 0 ? x : x ** 1.5 ** -e;\n  const denormExp = (x, e) => e === 0 ? x : x ** 1.5 ** e;\n  const normalize = (x, min, max, e = 0) => min === 0 && max === 1 ? normExp(x, e) : normExp((x - min) / (max - min) || 0, e);\n  const denormalize = (x, min, max, e = 0) => min === 0 && max === 1 ? denormExp(x, e) : denormExp(x, e) * (max - min) + min;\n  const inRange = (x, min, max) => x >= min && x <= max;\n  class WamParameterInfo {\n    constructor(id, config = {}) {\n      let {\n        type,\n        label,\n        defaultValue,\n        minValue,\n        maxValue,\n        discreteStep,\n        exponent,\n        choices,\n        units\n      } = config;\n      if (type === void 0)\n        type = \"float\";\n      if (label === void 0)\n        label = \"\";\n      if (defaultValue === void 0)\n        defaultValue = 0;\n      if (choices === void 0)\n        choices = [];\n      if (type === \"boolean\" || type === \"choice\") {\n        discreteStep = 1;\n        minValue = 0;\n        if (choices.length)\n          maxValue = choices.length - 1;\n        else\n          maxValue = 1;\n      } else {\n        if (minValue === void 0)\n          minValue = 0;\n        if (maxValue === void 0)\n          maxValue = 1;\n        if (discreteStep === void 0)\n          discreteStep = 0;\n        if (exponent === void 0)\n          exponent = 0;\n        if (units === void 0)\n          units = \"\";\n      }\n      const errBase = `Param config error | ${id}: `;\n      if (minValue >= maxValue)\n        throw Error(errBase.concat(\"minValue must be less than maxValue\"));\n      if (!inRange(defaultValue, minValue, maxValue))\n        throw Error(errBase.concat(\"defaultValue out of range\"));\n      if (discreteStep % 1 || discreteStep < 0) {\n        throw Error(errBase.concat(\"discreteStep must be a non-negative integer\"));\n      } else if (discreteStep > 0 && (minValue % 1 || maxValue % 1 || defaultValue % 1)) {\n        throw Error(errBase.concat(\"non-zero discreteStep requires integer minValue, maxValue, and defaultValue\"));\n      }\n      if (type === \"choice\" && !choices.length) {\n        throw Error(errBase.concat(\"choice type parameter requires list of strings in choices\"));\n      }\n      this.id = id;\n      this.label = label;\n      this.type = type;\n      this.defaultValue = defaultValue;\n      this.minValue = minValue;\n      this.maxValue = maxValue;\n      this.discreteStep = discreteStep;\n      this.exponent = exponent;\n      this.choices = choices;\n      this.units = units;\n    }\n    normalize(value) {\n      return normalize(value, this.minValue, this.maxValue, this.exponent);\n    }\n    denormalize(valueNorm) {\n      return denormalize(valueNorm, this.minValue, this.maxValue, this.exponent);\n    }\n    valueString(value) {\n      if (this.choices)\n        return this.choices[value];\n      if (this.units !== \"\")\n        return `${value} ${this.units}`;\n      return `${value}`;\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    const ModuleScope = audioWorkletGlobalScope.webAudioModules.getModuleScope(moduleId);\n    if (!ModuleScope.WamParameterInfo)\n      ModuleScope.WamParameterInfo = WamParameterInfo;\n  }\n  return WamParameterInfo;\n};\nvar WamParameterInfo_default = getWamParameterInfo;\n\n// src/WamParameterInterpolator.js\nvar getWamParameterInterpolator = (moduleId) => {\n  const audioWorkletGlobalScope = globalThis;\n  const samplesPerQuantum = 128;\n  const nullTableKey = \"0_0\";\n  class WamParameterInterpolator {\n    static _tables;\n    static _tableReferences;\n    constructor(info, samplesPerInterpolation, skew = 0) {\n      if (!WamParameterInterpolator._tables) {\n        WamParameterInterpolator._tables = { nullTableKey: new Float32Array(0) };\n        WamParameterInterpolator._tableReferences = { nullTableKey: [] };\n      }\n      this.info = info;\n      this.values = new Float32Array(samplesPerQuantum);\n      this._tableKey = nullTableKey;\n      this._table = WamParameterInterpolator._tables[this._tableKey];\n      this._skew = 2;\n      const { discreteStep } = info;\n      this._discrete = !!discreteStep;\n      this._N = this._discrete ? 0 : samplesPerInterpolation;\n      this._n = 0;\n      this._startValue = info.defaultValue;\n      this._endValue = info.defaultValue;\n      this._currentValue = info.defaultValue;\n      this._deltaValue = 0;\n      this._inverted = false;\n      this._changed = true;\n      this._filled = 0;\n      if (!this._discrete)\n        this.setSkew(skew);\n      else\n        this._skew = 0;\n      this.setStartValue(this._startValue);\n    }\n    _removeTableReference(oldKey) {\n      if (oldKey === nullTableKey)\n        return;\n      const { id } = this.info;\n      const references = WamParameterInterpolator._tableReferences[oldKey];\n      if (references) {\n        const index = references.indexOf(id);\n        if (index !== -1)\n          references.splice(index, 1);\n        if (references.length === 0) {\n          delete WamParameterInterpolator._tables[oldKey];\n          delete WamParameterInterpolator._tableReferences[oldKey];\n        }\n      }\n    }\n    setSkew(skew) {\n      if (this._skew === skew || this._discrete)\n        return;\n      if (skew < -1 || skew > 1)\n        throw Error(\"skew must be in range [-1.0, 1.0]\");\n      const newKey = [this._N, skew].join(\"_\");\n      const oldKey = this._tableKey;\n      const { id } = this.info;\n      if (newKey === oldKey)\n        return;\n      if (WamParameterInterpolator._tables[newKey]) {\n        const references = WamParameterInterpolator._tableReferences[newKey];\n        if (references)\n          references.push(id);\n        else\n          WamParameterInterpolator._tableReferences[newKey] = [id];\n      } else {\n        let e = Math.abs(skew);\n        e = Math.pow(3 - e, e * (e + 2));\n        const linear = e === 1;\n        const N = this._N;\n        const table = new Float32Array(N + 1);\n        if (linear)\n          for (let n = 0; n <= N; ++n)\n            table[n] = n / N;\n        else\n          for (let n = 0; n <= N; ++n)\n            table[n] = (n / N) ** e;\n        WamParameterInterpolator._tables[newKey] = table;\n        WamParameterInterpolator._tableReferences[newKey] = [id];\n      }\n      this._removeTableReference(oldKey);\n      this._skew = skew;\n      this._tableKey = newKey;\n      this._table = WamParameterInterpolator._tables[this._tableKey];\n    }\n    setStartValue(value, fill = true) {\n      this._n = this._N;\n      this._startValue = value;\n      this._endValue = value;\n      this._currentValue = value;\n      this._deltaValue = 0;\n      this._inverted = false;\n      if (fill) {\n        this.values.fill(value);\n        this._changed = true;\n        this._filled = this.values.length;\n      } else {\n        this._changed = false;\n        this._filled = 0;\n      }\n    }\n    setEndValue(value) {\n      if (value === this._endValue)\n        return;\n      this._n = 0;\n      this._startValue = this._currentValue;\n      this._endValue = value;\n      this._deltaValue = this._endValue - this._startValue;\n      this._inverted = this._deltaValue > 0 && this._skew >= 0 || this._deltaValue <= 0 && this._skew < 0;\n      this._changed = false;\n      this._filled = 0;\n    }\n    process(startSample, endSample) {\n      if (this.done)\n        return;\n      const length = endSample - startSample;\n      let fill = 0;\n      const change = this._N - this._n;\n      if (this._discrete || !change)\n        fill = length;\n      else {\n        if (change < length) {\n          fill = Math.min(length - change, samplesPerQuantum);\n          endSample -= fill;\n        }\n        if (endSample > startSample) {\n          if (this._inverted) {\n            for (let i = startSample; i < endSample; ++i) {\n              const tableValue = 1 - this._table[this._N - ++this._n];\n              this.values[i] = this._startValue + tableValue * this._deltaValue;\n            }\n          } else {\n            for (let i = startSample; i < endSample; ++i) {\n              const tableValue = this._table[++this._n];\n              this.values[i] = this._startValue + tableValue * this._deltaValue;\n            }\n          }\n        }\n        if (fill > 0) {\n          startSample = endSample;\n          endSample += fill;\n        }\n      }\n      if (fill > 0) {\n        this.values.fill(this._endValue, startSample, endSample);\n        this._filled += fill;\n      }\n      this._currentValue = this.values[endSample - 1];\n      if (this._n === this._N) {\n        if (!this._changed)\n          this._changed = true;\n        else if (this._filled >= this.values.length) {\n          this.setStartValue(this._endValue, false);\n          this._changed = true;\n          this._filled = this.values.length;\n        }\n      }\n    }\n    get done() {\n      return this._changed && this._filled === this.values.length;\n    }\n    is(value) {\n      return this._endValue === value && this.done;\n    }\n    destroy() {\n      this._removeTableReference(this._tableKey);\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    const ModuleScope = audioWorkletGlobalScope.webAudioModules.getModuleScope(moduleId);\n    if (!ModuleScope.WamParameterInterpolator)\n      ModuleScope.WamParameterInterpolator = WamParameterInterpolator;\n  }\n  return WamParameterInterpolator;\n};\nvar WamParameterInterpolator_default = getWamParameterInterpolator;\n\n// src/WamProcessor.js\nvar getWamProcessor = (moduleId) => {\n  const audioWorkletGlobalScope = globalThis;\n  const {\n    AudioWorkletProcessor,\n    webAudioModules\n  } = audioWorkletGlobalScope;\n  const ModuleScope = audioWorkletGlobalScope.webAudioModules.getModuleScope(moduleId);\n  const {\n    RingBuffer: RingBuffer2,\n    WamEventRingBuffer: WamEventRingBuffer2,\n    WamParameter,\n    WamParameterInterpolator\n  } = ModuleScope;\n  class WamProcessor extends AudioWorkletProcessor {\n    constructor(options) {\n      super();\n      const {\n        groupId,\n        moduleId: moduleId2,\n        instanceId,\n        useSab\n      } = options.processorOptions;\n      if (!moduleId2)\n        throw Error(\"must provide moduleId argument in processorOptions!\");\n      if (!instanceId)\n        throw Error(\"must provide instanceId argument in processorOptions!\");\n      this.groupId = groupId;\n      this.moduleId = moduleId2;\n      this.instanceId = instanceId;\n      this._samplesPerQuantum = 128;\n      this._compensationDelay = 0;\n      this._parameterInfo = {};\n      this._parameterState = {};\n      this._parameterInterpolators = {};\n      this._eventQueue = [];\n      this._pendingResponses = {};\n      this._useSab = !!useSab && !!globalThis.SharedArrayBuffer;\n      this._eventSabReady = false;\n      this._audioToMainEventSab = null;\n      this._mainToAudioEventSab = null;\n      this._eventWriter = null;\n      this._eventReader = null;\n      this._initialized = false;\n      this._destroyed = false;\n      webAudioModules.addWam(this);\n      this.port.onmessage = this._onMessage.bind(this);\n      if (this._useSab)\n        this._configureSab();\n    }\n    getCompensationDelay() {\n      return this._compensationDelay;\n    }\n    scheduleEvents(...events) {\n      let i = 0;\n      while (i < events.length) {\n        this._eventQueue.push({ id: 0, event: events[i] });\n        i++;\n      }\n    }\n    emitEvents(...events) {\n      webAudioModules.emitEvents(this, ...events);\n    }\n    clearEvents() {\n      this._eventQueue = [];\n    }\n    process(inputs, outputs, parameters) {\n      if (!this._initialized)\n        return true;\n      if (this._destroyed)\n        return false;\n      if (this._eventSabReady)\n        this.scheduleEvents(...this._eventReader.read());\n      const processingSlices = this._getProcessingSlices();\n      let i = 0;\n      while (i < processingSlices.length) {\n        const { range, events } = processingSlices[i];\n        const [startSample, endSample] = range;\n        let j = 0;\n        while (j < events.length) {\n          this._processEvent(events[j]);\n          j++;\n        }\n        this._interpolateParameterValues(startSample, endSample);\n        this._process(startSample, endSample, inputs, outputs, parameters);\n        i++;\n      }\n      return true;\n    }\n    destroy() {\n      this._destroyed = true;\n      this.port.close();\n      webAudioModules.removeWam(this);\n    }\n    _generateWamParameterInfo() {\n      return {};\n    }\n    _initialize() {\n      this._parameterState = {};\n      this._parameterInterpolators = {};\n      this._parameterInfo = this._generateWamParameterInfo();\n      Object.keys(this._parameterInfo).forEach((parameterId) => {\n        const info = this._parameterInfo[parameterId];\n        this._parameterState[parameterId] = new WamParameter(this._parameterInfo[parameterId]);\n        this._parameterInterpolators[parameterId] = new WamParameterInterpolator(info, 256);\n      });\n    }\n    _configureSab() {\n      const eventCapacity = 2 ** 10;\n      const parameterIds = Object.keys(this._parameterInfo);\n      if (this._eventSabReady) {\n        this._eventWriter.setParameterIds(parameterIds);\n        this._eventReader.setParameterIds(parameterIds);\n      }\n      this.port.postMessage({ eventSab: { eventCapacity, parameterIds } });\n    }\n    async _onMessage(message) {\n      if (message.data.request) {\n        const {\n          id,\n          request,\n          content\n        } = message.data;\n        const response = { id, response: request };\n        const requestComponents = request.split(\"/\");\n        const verb = requestComponents[0];\n        const noun = requestComponents[1];\n        response.content = \"error\";\n        if (verb === \"get\") {\n          if (noun === \"parameterInfo\") {\n            let { parameterIds } = content;\n            if (!parameterIds.length)\n              parameterIds = Object.keys(this._parameterInfo);\n            const parameterInfo = {};\n            let i = 0;\n            while (i < parameterIds.length) {\n              const parameterId = parameterIds[i];\n              parameterInfo[parameterId] = this._parameterInfo[parameterId];\n              i++;\n            }\n            response.content = parameterInfo;\n          } else if (noun === \"parameterValues\") {\n            let { normalized, parameterIds } = content;\n            response.content = this._getParameterValues(normalized, parameterIds);\n          } else if (noun === \"state\") {\n            response.content = this._getState();\n          } else if (noun === \"compensationDelay\") {\n            response.content = this.getCompensationDelay();\n          }\n        } else if (verb === \"set\") {\n          if (noun === \"parameterValues\") {\n            const { parameterValues } = content;\n            this._setParameterValues(parameterValues, true);\n            delete response.content;\n          } else if (noun === \"state\") {\n            const { state } = content;\n            this._setState(state);\n            delete response.content;\n          }\n        } else if (verb === \"add\") {\n          if (noun === \"event\") {\n            const { event } = content;\n            this._eventQueue.push({ id, event });\n            return;\n          }\n        } else if (verb === \"remove\") {\n          if (noun === \"events\") {\n            const ids = this._eventQueue.map((queued) => queued.id);\n            this.clearEvents();\n            response.content = ids;\n          }\n        } else if (verb === \"connect\") {\n          if (noun === \"events\") {\n            const { wamInstanceId, output } = content;\n            this._connectEvents(wamInstanceId, output);\n            delete response.content;\n          }\n        } else if (verb === \"disconnect\") {\n          if (noun === \"events\") {\n            const { wamInstanceId, output } = content;\n            this._disconnectEvents(wamInstanceId, output);\n            delete response.content;\n          }\n        } else if (verb === \"initialize\") {\n          if (noun === \"processor\") {\n            this._initialize();\n            this._initialized = true;\n            delete response.content;\n          } else if (noun === \"eventSab\") {\n            const { mainToAudioEventSab, audioToMainEventSab } = content;\n            this._audioToMainEventSab = audioToMainEventSab;\n            this._mainToAudioEventSab = mainToAudioEventSab;\n            const parameterIds = Object.keys(this._parameterInfo);\n            this._eventWriter = new WamEventRingBuffer2(RingBuffer2, this._audioToMainEventSab, parameterIds);\n            this._eventReader = new WamEventRingBuffer2(RingBuffer2, this._mainToAudioEventSab, parameterIds);\n            this._eventSabReady = true;\n            delete response.content;\n          }\n        }\n        this.port.postMessage(response);\n      } else if (message.data.destroy) {\n        this.destroy();\n      }\n    }\n    _onTransport(transportData) {\n      console.error(\"_onTransport not implemented!\");\n    }\n    _onMidi(midiData) {\n      console.error(\"_onMidi not implemented!\");\n    }\n    _onSysex(sysexData) {\n      console.error(\"_onMidi not implemented!\");\n    }\n    _onMpe(mpeData) {\n      console.error(\"_onMpe not implemented!\");\n    }\n    _onOsc(oscData) {\n      console.error(\"_onOsc not implemented!\");\n    }\n    _setState(state) {\n      if (state.parameterValues)\n        this._setParameterValues(state.parameterValues, false);\n    }\n    _getState() {\n      return { parameterValues: this._getParameterValues(false) };\n    }\n    _getParameterValues(normalized, parameterIds) {\n      const parameterValues = {};\n      if (!parameterIds || !parameterIds.length)\n        parameterIds = Object.keys(this._parameterState);\n      let i = 0;\n      while (i < parameterIds.length) {\n        const id = parameterIds[i];\n        const parameter = this._parameterState[id];\n        parameterValues[id] = {\n          id,\n          value: normalized ? parameter.normalizedValue : parameter.value,\n          normalized\n        };\n        i++;\n      }\n      return parameterValues;\n    }\n    _setParameterValues(parameterUpdates, interpolate) {\n      const parameterIds = Object.keys(parameterUpdates);\n      let i = 0;\n      while (i < parameterIds.length) {\n        this._setParameterValue(parameterUpdates[parameterIds[i]], interpolate);\n        i++;\n      }\n    }\n    _setParameterValue(parameterUpdate, interpolate) {\n      const { id, value, normalized } = parameterUpdate;\n      const parameter = this._parameterState[id];\n      if (!parameter)\n        return;\n      if (!normalized)\n        parameter.value = value;\n      else\n        parameter.normalizedValue = value;\n      const interpolator = this._parameterInterpolators[id];\n      if (interpolate)\n        interpolator.setEndValue(parameter.value);\n      else\n        interpolator.setStartValue(parameter.value);\n    }\n    _interpolateParameterValues(startIndex, endIndex) {\n      const parameterIds = Object.keys(this._parameterInterpolators);\n      let i = 0;\n      while (i < parameterIds.length) {\n        this._parameterInterpolators[parameterIds[i]].process(startIndex, endIndex);\n        i++;\n      }\n    }\n    _connectEvents(wamInstanceId, output) {\n      webAudioModules.connectEvents(this.groupId, this.instanceId, wamInstanceId, output);\n    }\n    _disconnectEvents(wamInstanceId, output) {\n      if (typeof wamInstanceId === \"undefined\") {\n        webAudioModules.disconnectEvents(this.groupId, this.instanceId);\n        return;\n      }\n      webAudioModules.disconnectEvents(this.groupId, this.instanceId, wamInstanceId, output);\n    }\n    _getProcessingSlices() {\n      const response = \"add/event\";\n      const { currentTime, sampleRate } = audioWorkletGlobalScope;\n      const eventsBySampleIndex = {};\n      let i = 0;\n      while (i < this._eventQueue.length) {\n        const { id, event } = this._eventQueue[i];\n        const offsetSec = event.time - currentTime;\n        const sampleIndex = offsetSec > 0 ? Math.round(offsetSec * sampleRate) : 0;\n        if (sampleIndex < this._samplesPerQuantum) {\n          if (eventsBySampleIndex[sampleIndex])\n            eventsBySampleIndex[sampleIndex].push(event);\n          else\n            eventsBySampleIndex[sampleIndex] = [event];\n          if (id)\n            this.port.postMessage({ id, response });\n          else if (this._eventSabReady)\n            this._eventWriter.write(event);\n          else\n            this.port.postMessage({ event });\n          this._eventQueue.shift();\n          i = -1;\n        } else\n          break;\n        i++;\n      }\n      const processingSlices = [];\n      const keys = Object.keys(eventsBySampleIndex);\n      if (keys[0] !== \"0\") {\n        keys.unshift(\"0\");\n        eventsBySampleIndex[\"0\"] = [];\n      }\n      const lastIndex = keys.length - 1;\n      i = 0;\n      while (i < keys.length) {\n        const key = keys[i];\n        const startSample = parseInt(key);\n        const endSample = i < lastIndex ? parseInt(keys[i + 1]) : this._samplesPerQuantum;\n        processingSlices.push({ range: [startSample, endSample], events: eventsBySampleIndex[key] });\n        i++;\n      }\n      return processingSlices;\n    }\n    _processEvent(event) {\n      switch (event.type) {\n        case \"wam-automation\":\n          this._setParameterValue(event.data, true);\n          break;\n        case \"wam-transport\":\n          this._onTransport(event.data);\n          break;\n        case \"wam-midi\":\n          this._onMidi(event.data);\n          break;\n        case \"wam-sysex\":\n          this._onSysex(event.data);\n          break;\n        case \"wam-mpe\":\n          this._onMpe(event.data);\n          break;\n        case \"wam-osc\":\n          this._onOsc(event.data);\n          break;\n        default:\n          break;\n      }\n    }\n    _process(startSample, endSample, inputs, outputs, parameters) {\n      console.error(\"_process not implemented!\");\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    if (!ModuleScope.WamProcessor)\n      ModuleScope.WamProcessor = WamProcessor;\n  }\n  return WamProcessor;\n};\nvar WamProcessor_default = getWamProcessor;\n\n// src/WamNode.js\nvar RingBuffer = RingBuffer_default();\nvar WamEventRingBuffer = WamEventRingBuffer_default();\nvar WamNode = class extends AudioWorkletNode {\n  static async addModules(audioContext, moduleId) {\n    const { audioWorklet } = audioContext;\n    await addFunctionModule_default(audioWorklet, RingBuffer_default, moduleId);\n    await addFunctionModule_default(audioWorklet, WamEventRingBuffer_default, moduleId);\n    await addFunctionModule_default(audioWorklet, WamArrayRingBuffer_default, moduleId);\n    await addFunctionModule_default(audioWorklet, WamParameter_default, moduleId);\n    await addFunctionModule_default(audioWorklet, WamParameterInfo_default, moduleId);\n    await addFunctionModule_default(audioWorklet, WamParameterInterpolator_default, moduleId);\n    await addFunctionModule_default(audioWorklet, WamProcessor_default, moduleId);\n  }\n  constructor(module, options) {\n    const { audioContext, groupId, moduleId, instanceId } = module;\n    options.processorOptions = {\n      groupId,\n      moduleId,\n      instanceId,\n      ...options.processorOptions\n    };\n    super(audioContext, moduleId, options);\n    this.module = module;\n    this._supportedEventTypes = /* @__PURE__ */ new Set([\"wam-automation\", \"wam-transport\", \"wam-midi\", \"wam-sysex\", \"wam-mpe\", \"wam-osc\"]);\n    this._messageId = 1;\n    this._pendingResponses = {};\n    this._pendingEvents = {};\n    this._useSab = false;\n    this._eventSabReady = false;\n    this._destroyed = false;\n    this.port.onmessage = this._onMessage.bind(this);\n  }\n  get groupId() {\n    return this.module.groupId;\n  }\n  get moduleId() {\n    return this.module.moduleId;\n  }\n  get instanceId() {\n    return this.module.instanceId;\n  }\n  async getParameterInfo(...parameterIds) {\n    const request = \"get/parameterInfo\";\n    const id = this._generateMessageId();\n    return new Promise((resolve) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({\n        id,\n        request,\n        content: { parameterIds }\n      });\n    });\n  }\n  async getParameterValues(normalized, ...parameterIds) {\n    const request = \"get/parameterValues\";\n    const id = this._generateMessageId();\n    return new Promise((resolve) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({\n        id,\n        request,\n        content: { normalized, parameterIds }\n      });\n    });\n  }\n  async setParameterValues(parameterValues) {\n    const request = \"set/parameterValues\";\n    const id = this._generateMessageId();\n    return new Promise((resolve) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({\n        id,\n        request,\n        content: { parameterValues }\n      });\n    });\n  }\n  async getState() {\n    const request = \"get/state\";\n    const id = this._generateMessageId();\n    return new Promise((resolve) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({ id, request });\n    });\n  }\n  async setState(state) {\n    const request = \"set/state\";\n    const id = this._generateMessageId();\n    return new Promise((resolve) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({\n        id,\n        request,\n        content: { state }\n      });\n    });\n  }\n  async getCompensationDelay() {\n    const request = \"get/compensationDelay\";\n    const id = this._generateMessageId();\n    return new Promise((resolve) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({ id, request });\n    });\n  }\n  addEventListener(type, callback, options) {\n    if (this._supportedEventTypes.has(type))\n      super.addEventListener(type, callback, options);\n  }\n  removeEventListener(type, callback, options) {\n    if (this._supportedEventTypes.has(type))\n      super.removeEventListener(type, callback, options);\n  }\n  scheduleEvents(...events) {\n    let i = 0;\n    const numEvents = events.length;\n    if (this._eventSabReady) {\n      i = this._eventWriter.write(...events);\n    }\n    while (i < numEvents) {\n      const event = events[i];\n      const request = \"add/event\";\n      const id = this._generateMessageId();\n      let processed = false;\n      new Promise((resolve, reject) => {\n        this._pendingResponses[id] = resolve;\n        this._pendingEvents[id] = () => {\n          if (!processed)\n            reject();\n        };\n        this.port.postMessage({\n          id,\n          request,\n          content: { event }\n        });\n      }).then((resolved) => {\n        processed = true;\n        delete this._pendingEvents[id];\n        this._onEvent(event);\n      }).catch((rejected) => {\n        delete this._pendingResponses[id];\n      });\n      i++;\n    }\n  }\n  async clearEvents() {\n    const request = \"remove/events\";\n    const id = this._generateMessageId();\n    const ids = Object.keys(this._pendingEvents);\n    if (ids.length) {\n      return new Promise((resolve) => {\n        this._pendingResponses[id] = resolve;\n        this.port.postMessage({ id, request });\n      }).then((clearedIds) => {\n        clearedIds.forEach((clearedId) => {\n          this._pendingEvents[clearedId]();\n          delete this._pendingEvents[clearedId];\n        });\n      });\n    }\n  }\n  connectEvents(toId, output) {\n    const request = \"connect/events\";\n    const id = this._generateMessageId();\n    new Promise((resolve, reject) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({\n        id,\n        request,\n        content: { wamInstanceId: toId, output }\n      });\n    });\n  }\n  disconnectEvents(toId, output) {\n    const request = \"disconnect/events\";\n    const id = this._generateMessageId();\n    new Promise((resolve, reject) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({\n        id,\n        request,\n        content: { wamInstanceId: toId, output }\n      });\n    });\n  }\n  destroy() {\n    if (this._audioToMainInterval)\n      clearInterval(this._audioToMainInterval);\n    this.port.postMessage({ destroy: true });\n    this.port.close();\n    this.disconnect();\n    this._destroyed = true;\n  }\n  _generateMessageId() {\n    return this._messageId++;\n  }\n  async _initialize() {\n    const request = \"initialize/processor\";\n    const id = this._generateMessageId();\n    return new Promise((resolve) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({ id, request });\n    });\n  }\n  _onMessage(message) {\n    const { data } = message;\n    const { response, event, eventSab } = data;\n    if (response) {\n      const { id, content } = data;\n      const resolvePendingResponse = this._pendingResponses[id];\n      if (resolvePendingResponse) {\n        delete this._pendingResponses[id];\n        resolvePendingResponse(content);\n      }\n    } else if (eventSab) {\n      this._useSab = true;\n      const { eventCapacity, parameterIds } = eventSab;\n      if (this._eventSabReady) {\n        this._eventWriter.setParameterIds(parameterIds);\n        this._eventReader.setParameterIds(parameterIds);\n        return;\n      }\n      this._mainToAudioEventSab = WamEventRingBuffer.getStorageForEventCapacity(RingBuffer, eventCapacity);\n      this._audioToMainEventSab = WamEventRingBuffer.getStorageForEventCapacity(RingBuffer, eventCapacity);\n      this._eventWriter = new WamEventRingBuffer(RingBuffer, this._mainToAudioEventSab, parameterIds);\n      this._eventReader = new WamEventRingBuffer(RingBuffer, this._audioToMainEventSab, parameterIds);\n      const request = \"initialize/eventSab\";\n      const id = this._generateMessageId();\n      new Promise((resolve, reject) => {\n        this._pendingResponses[id] = resolve;\n        this.port.postMessage({\n          id,\n          request,\n          content: {\n            mainToAudioEventSab: this._mainToAudioEventSab,\n            audioToMainEventSab: this._audioToMainEventSab\n          }\n        });\n      }).then((resolved) => {\n        this._eventSabReady = true;\n        this._audioToMainInterval = setInterval(() => {\n          const events = this._eventReader.read();\n          events.forEach((e) => {\n            this._onEvent(e);\n          });\n        }, 100);\n      });\n    } else if (event)\n      this._onEvent(event);\n  }\n  _onEvent(event) {\n    const { type } = event;\n    this.dispatchEvent(new CustomEvent(type, {\n      bubbles: true,\n      detail: event\n    }));\n  }\n};\n\n// src/apiVersion.js\nvar apiVersion_default = \"2.0.0-alpha.4\";\n\n// src/initializeWamHost.js\nvar initializeWamHost = async (audioContext, hostGroupId = `wam-host-${performance.now().toString()}`, hostGroupKey = performance.now().toString()) => {\n  await addFunctionModule_default(audioContext.audioWorklet, WamEnv_default, apiVersion_default);\n  await addFunctionModule_default(audioContext.audioWorklet, WamGroup_default, hostGroupId, hostGroupKey);\n  return [hostGroupId, hostGroupKey];\n};\nvar initializeWamHost_default = initializeWamHost;\nexport {\n  WamNode,\n  WebAudioModule_default as WebAudioModule,\n  addFunctionModule_default as addFunctionModule,\n  apiVersion_default as apiVersion,\n  RingBuffer_default as getRingBuffer,\n  WamArrayRingBuffer_default as getWamArrayRingBuffer,\n  WamEventRingBuffer_default as getWamEventRingBuffer,\n  WamParameter_default as getWamParameter,\n  WamParameterInfo_default as getWamParameterInfo,\n  WamParameterInterpolator_default as getWamParameterInterpolator,\n  WamProcessor_default as getWamProcessor,\n  WamEnv_default as initializeWamEnv,\n  WamGroup_default as initializeWamGroup,\n  initializeWamHost_default as initializeWamHost\n};\n//# sourceMappingURL=index.js.map\n","var __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\n\n// src/CompositeAudioNode.js\nvar CompositeAudioNode = class extends GainNode {\n  constructor() {\n    super(...arguments);\n    __publicField(this, \"_output\");\n    __publicField(this, \"_wamNode\");\n  }\n  get groupId() {\n    return this._wamNode.groupId;\n  }\n  get moduleId() {\n    return this._wamNode.moduleId;\n  }\n  get instanceId() {\n    return this._wamNode.instanceId;\n  }\n  get module() {\n    return this._wamNode.module;\n  }\n  addEventListener(...args) {\n    return this._wamNode.addEventListener(...args);\n  }\n  removeEventListener(...args) {\n    return this._wamNode.removeEventListener(...args);\n  }\n  dispatchEvent(...args) {\n    return this._wamNode.dispatchEvent(...args);\n  }\n  getParameterInfo(...args) {\n    return this._wamNode.getParameterInfo(...args);\n  }\n  getParameterValues(...args) {\n    return this._wamNode.getParameterValues(...args);\n  }\n  setParameterValues(...args) {\n    return this._wamNode.setParameterValues(...args);\n  }\n  getState() {\n    return this._wamNode.getState();\n  }\n  setState(...args) {\n    return this._wamNode.setState(...args);\n  }\n  getCompensationDelay() {\n    return this._wamNode.getCompensationDelay();\n  }\n  scheduleEvents(...args) {\n    return this._wamNode.scheduleEvents(...args);\n  }\n  clearEvents() {\n    return this._wamNode.clearEvents();\n  }\n  connectEvents(...args) {\n    return this._wamNode.connectEvents(...args);\n  }\n  disconnectEvents(...args) {\n    return this._wamNode.disconnectEvents(...args);\n  }\n  destroy() {\n    return this._wamNode.destroy();\n  }\n  set channelCount(count) {\n    if (this._output)\n      this._output.channelCount = count;\n    else\n      super.channelCount = count;\n  }\n  get channelCount() {\n    if (this._output)\n      return this._output.channelCount;\n    return super.channelCount;\n  }\n  set channelCountMode(mode) {\n    if (this._output)\n      this._output.channelCountMode = mode;\n    else\n      super.channelCountMode = mode;\n  }\n  get channelCountMode() {\n    if (this._output)\n      return this._output.channelCountMode;\n    return super.channelCountMode;\n  }\n  set channelInterpretation(interpretation) {\n    if (this._output)\n      this._output.channelInterpretation = interpretation;\n    else\n      super.channelInterpretation = interpretation;\n  }\n  get channelInterpretation() {\n    if (this._output)\n      return this._output.channelInterpretation;\n    return super.channelInterpretation;\n  }\n  get numberOfInputs() {\n    return super.numberOfInputs;\n  }\n  get numberOfOutputs() {\n    if (this._output)\n      return this._output.numberOfOutputs;\n    return super.numberOfOutputs;\n  }\n  get gain() {\n    return void 0;\n  }\n  connect(...args) {\n    if (this._output && this._output !== this)\n      return this._output.connect(...args);\n    return super.connect(...args);\n  }\n  disconnect(...args) {\n    if (this._output && this._output !== this)\n      return this._output.disconnect(...args);\n    return super.disconnect(...args);\n  }\n};\n\n// src/sdk/src/addFunctionModule.js\nvar addFunctionModule = (audioWorklet, processorFunction, ...injection) => {\n  const text = `(${processorFunction.toString()})(${injection.map((s) => JSON.stringify(s)).join(\", \")});`;\n  const url = URL.createObjectURL(new Blob([text], { type: \"text/javascript\" }));\n  return audioWorklet.addModule(url);\n};\nvar addFunctionModule_default = addFunctionModule;\n\n// src/ParamMgrProcessor.js\nvar processor = (moduleId, paramsConfig) => {\n  const audioWorkletGlobalScope = globalThis;\n  const {\n    AudioWorkletProcessor,\n    registerProcessor,\n    webAudioModules\n  } = audioWorkletGlobalScope;\n  const supportSharedArrayBuffer = !!globalThis.SharedArrayBuffer;\n  const SharedArrayBuffer = globalThis.SharedArrayBuffer || globalThis.ArrayBuffer;\n  const normExp = (x, e) => e === 0 ? x : x ** 1.5 ** -e;\n  const normalizeE = (x, min, max, e = 0) => min === 0 && max === 1 ? normExp(x, e) : normExp((x - min) / (max - min) || 0, e);\n  const normalize = (x, min, max) => min === 0 && max === 1 ? x : (x - min) / (max - min) || 0;\n  const denormalize = (x, min, max) => min === 0 && max === 1 ? x : x * (max - min) + min;\n  const mapValue = (x, eMin, eMax, sMin, sMax, tMin, tMax) => denormalize(normalize(normalize(Math.min(sMax, Math.max(sMin, x)), eMin, eMax), normalize(sMin, eMin, eMax), normalize(sMax, eMin, eMax)), tMin, tMax);\n  class ParamMgrProcessor extends AudioWorkletProcessor {\n    static get parameterDescriptors() {\n      return Object.entries(paramsConfig).map(([name, { defaultValue, minValue, maxValue }]) => ({\n        name,\n        defaultValue,\n        minValue,\n        maxValue\n      }));\n    }\n    constructor(options) {\n      super();\n      this.destroyed = false;\n      this.supportSharedArrayBuffer = supportSharedArrayBuffer;\n      const {\n        paramsMapping,\n        internalParamsMinValues,\n        internalParams,\n        groupId,\n        instanceId\n      } = options.processorOptions;\n      this.groupId = groupId;\n      this.moduleId = moduleId;\n      this.instanceId = instanceId;\n      this.internalParamsMinValues = internalParamsMinValues;\n      this.paramsConfig = paramsConfig;\n      this.paramsMapping = paramsMapping;\n      this.paramsValues = {};\n      Object.entries(paramsConfig).forEach(([name, { defaultValue }]) => {\n        this.paramsValues[name] = defaultValue;\n      });\n      this.internalParams = internalParams;\n      this.internalParamsCount = this.internalParams.length;\n      this.buffer = new SharedArrayBuffer((this.internalParamsCount + 1) * Float32Array.BYTES_PER_ELEMENT);\n      this.$lock = new Int32Array(this.buffer, 0, 1);\n      this.$internalParamsBuffer = new Float32Array(this.buffer, 4, this.internalParamsCount);\n      this.eventQueue = [];\n      this.handleEvent = null;\n      audioWorkletGlobalScope.webAudioModules.addWam(this);\n      this.messagePortRequestId = -1;\n      const resolves = {};\n      const rejects = {};\n      this.call = (call, ...args) => new Promise((resolve, reject) => {\n        const id = this.messagePortRequestId--;\n        resolves[id] = resolve;\n        rejects[id] = reject;\n        this.port.postMessage({ id, call, args });\n      });\n      this.handleMessage = ({ data }) => {\n        var _a, _b;\n        const { id, call, args, value, error } = data;\n        if (call) {\n          const r = { id };\n          try {\n            r.value = this[call](...args);\n          } catch (e) {\n            r.error = e;\n          }\n          this.port.postMessage(r);\n        } else {\n          if (error)\n            (_a = rejects[id]) == null ? void 0 : _a.call(rejects, error);\n          else if (resolves[id])\n            (_b = resolves[id]) == null ? void 0 : _b.call(resolves, value);\n          delete resolves[id];\n          delete rejects[id];\n        }\n      };\n      this.port.start();\n      this.port.addEventListener(\"message\", this.handleMessage);\n    }\n    setParamsMapping(mapping) {\n      this.paramsMapping = mapping;\n    }\n    getBuffer() {\n      return { lock: this.$lock, paramsBuffer: this.$internalParamsBuffer };\n    }\n    getCompensationDelay() {\n      return 128;\n    }\n    getParameterInfo(...parameterIdQuery) {\n      if (parameterIdQuery.length === 0)\n        parameterIdQuery = Object.keys(this.paramsConfig);\n      const parameterInfo = {};\n      parameterIdQuery.forEach((parameterId) => {\n        parameterInfo[parameterId] = this.paramsConfig[parameterId];\n      });\n      return parameterInfo;\n    }\n    getParameterValues(normalized, ...parameterIdQuery) {\n      if (parameterIdQuery.length === 0)\n        parameterIdQuery = Object.keys(this.paramsConfig);\n      const parameterValues = {};\n      parameterIdQuery.forEach((parameterId) => {\n        if (!(parameterId in this.paramsValues))\n          return;\n        const { minValue, maxValue, exponent } = this.paramsConfig[parameterId];\n        const value = this.paramsValues[parameterId];\n        parameterValues[parameterId] = {\n          id: parameterId,\n          value: normalized ? normalizeE(value, minValue, maxValue, exponent) : value,\n          normalized\n        };\n      });\n      return parameterValues;\n    }\n    scheduleEvents(...events) {\n      this.eventQueue.push(...events);\n      const { currentTime } = audioWorkletGlobalScope;\n      this.eventQueue.sort((a, b) => (a.time || currentTime) - (b.time || currentTime));\n    }\n    emitEvents(...events) {\n      webAudioModules.emitEvents(this, ...events);\n    }\n    clearEvents() {\n      this.eventQueue = [];\n    }\n    lock() {\n      if (globalThis.Atomics)\n        Atomics.store(this.$lock, 0, 1);\n    }\n    unlock() {\n      if (globalThis.Atomics)\n        Atomics.store(this.$lock, 0, 0);\n    }\n    process(inputs, outputs, parameters) {\n      if (this.destroyed)\n        return false;\n      const outputOffset = 1;\n      this.lock();\n      Object.entries(this.paramsConfig).forEach(([name, { minValue, maxValue }]) => {\n        const raw = parameters[name];\n        if (name in this.paramsValues)\n          this.paramsValues[name] = raw[raw.length - 1];\n        if (!this.paramsMapping[name])\n          return;\n        Object.entries(this.paramsMapping[name]).forEach(([targetName, targetMapping]) => {\n          const j = this.internalParams.indexOf(targetName);\n          if (j === -1)\n            return;\n          const intrinsicValue = this.internalParamsMinValues[j];\n          const { sourceRange, targetRange } = targetMapping;\n          const [sMin, sMax] = sourceRange;\n          const [tMin, tMax] = targetRange;\n          let out;\n          if (minValue !== tMin || maxValue !== tMax || minValue !== sMin || maxValue !== sMax) {\n            out = raw.map((v) => {\n              const mappedValue = mapValue(v, minValue, maxValue, sMin, sMax, tMin, tMax);\n              return mappedValue - intrinsicValue;\n            });\n          } else if (intrinsicValue) {\n            out = raw.map((v) => v - intrinsicValue);\n          } else {\n            out = raw;\n          }\n          if (out.length === 1)\n            outputs[j + outputOffset][0].fill(out[0]);\n          else\n            outputs[j + outputOffset][0].set(out);\n          this.$internalParamsBuffer[j] = out[0];\n        });\n      });\n      this.unlock();\n      if (!this.supportSharedArrayBuffer) {\n        this.call(\"setBuffer\", { lock: this.$lock, paramsBuffer: this.$internalParamsBuffer });\n      }\n      const { currentTime } = audioWorkletGlobalScope;\n      let $event;\n      for ($event = 0; $event < this.eventQueue.length; $event++) {\n        const event = this.eventQueue[$event];\n        if (event.time && event.time > currentTime)\n          break;\n        if (typeof this.handleEvent === \"function\")\n          this.handleEvent(event);\n        this.call(\"dispatchWamEvent\", event);\n      }\n      if ($event)\n        this.eventQueue.splice(0, $event);\n      return true;\n    }\n    connectEvents(wamInstanceId, output) {\n      webAudioModules.connectEvents(this.groupId, this.instanceId, wamInstanceId, output);\n    }\n    disconnectEvents(wamInstanceId, output) {\n      if (typeof wamInstanceId === \"undefined\") {\n        webAudioModules.disconnectEvents(this.groupId, this.instanceId);\n        return;\n      }\n      webAudioModules.disconnectEvents(this.groupId, this.instanceId, wamInstanceId, output);\n    }\n    destroy() {\n      audioWorkletGlobalScope.webAudioModules.removeWam(this);\n      this.destroyed = true;\n      this.port.close();\n    }\n  }\n  try {\n    registerProcessor(moduleId, ParamMgrProcessor);\n  } catch (error) {\n    console.warn(error);\n  }\n};\nvar ParamMgrProcessor_default = processor;\n\n// src/sdk/src/WamParameterInfo.js\nvar getWamParameterInfo = (moduleId) => {\n  const audioWorkletGlobalScope = globalThis;\n  const normExp = (x, e) => e === 0 ? x : x ** 1.5 ** -e;\n  const denormExp = (x, e) => e === 0 ? x : x ** 1.5 ** e;\n  const normalize = (x, min, max, e = 0) => min === 0 && max === 1 ? normExp(x, e) : normExp((x - min) / (max - min) || 0, e);\n  const denormalize = (x, min, max, e = 0) => min === 0 && max === 1 ? denormExp(x, e) : denormExp(x, e) * (max - min) + min;\n  const inRange = (x, min, max) => x >= min && x <= max;\n  class WamParameterInfo2 {\n    constructor(id, config = {}) {\n      let {\n        type,\n        label,\n        defaultValue,\n        minValue,\n        maxValue,\n        discreteStep,\n        exponent,\n        choices,\n        units\n      } = config;\n      if (type === void 0)\n        type = \"float\";\n      if (label === void 0)\n        label = \"\";\n      if (defaultValue === void 0)\n        defaultValue = 0;\n      if (choices === void 0)\n        choices = [];\n      if (type === \"boolean\" || type === \"choice\") {\n        discreteStep = 1;\n        minValue = 0;\n        if (choices.length)\n          maxValue = choices.length - 1;\n        else\n          maxValue = 1;\n      } else {\n        if (minValue === void 0)\n          minValue = 0;\n        if (maxValue === void 0)\n          maxValue = 1;\n        if (discreteStep === void 0)\n          discreteStep = 0;\n        if (exponent === void 0)\n          exponent = 0;\n        if (units === void 0)\n          units = \"\";\n      }\n      const errBase = `Param config error | ${id}: `;\n      if (minValue >= maxValue)\n        throw Error(errBase.concat(\"minValue must be less than maxValue\"));\n      if (!inRange(defaultValue, minValue, maxValue))\n        throw Error(errBase.concat(\"defaultValue out of range\"));\n      if (discreteStep % 1 || discreteStep < 0) {\n        throw Error(errBase.concat(\"discreteStep must be a non-negative integer\"));\n      } else if (discreteStep > 0 && (minValue % 1 || maxValue % 1 || defaultValue % 1)) {\n        throw Error(errBase.concat(\"non-zero discreteStep requires integer minValue, maxValue, and defaultValue\"));\n      }\n      if (type === \"choice\" && !choices.length) {\n        throw Error(errBase.concat(\"choice type parameter requires list of strings in choices\"));\n      }\n      this.id = id;\n      this.label = label;\n      this.type = type;\n      this.defaultValue = defaultValue;\n      this.minValue = minValue;\n      this.maxValue = maxValue;\n      this.discreteStep = discreteStep;\n      this.exponent = exponent;\n      this.choices = choices;\n      this.units = units;\n    }\n    normalize(value) {\n      return normalize(value, this.minValue, this.maxValue, this.exponent);\n    }\n    denormalize(valueNorm) {\n      return denormalize(valueNorm, this.minValue, this.maxValue, this.exponent);\n    }\n    valueString(value) {\n      if (this.choices)\n        return this.choices[value];\n      if (this.units !== \"\")\n        return `${value} ${this.units}`;\n      return `${value}`;\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    const ModuleScope = audioWorkletGlobalScope.webAudioModules.getModuleScope(moduleId);\n    if (!ModuleScope.WamParameterInfo)\n      ModuleScope.WamParameterInfo = WamParameterInfo2;\n  }\n  return WamParameterInfo2;\n};\nvar WamParameterInfo_default = getWamParameterInfo;\n\n// src/ParamConfigurator.js\nvar WamParameterInfo = WamParameterInfo_default();\nvar ParamMappingConfigurator = class {\n  constructor(options = {}) {\n    __publicField(this, \"_paramsConfig\");\n    __publicField(this, \"_internalParamsConfig\");\n    __publicField(this, \"_paramsMapping\", {});\n    const { paramsConfig, paramsMapping, internalParamsConfig } = options;\n    this._paramsConfig = paramsConfig;\n    this._paramsMapping = paramsMapping;\n    this._internalParamsConfig = internalParamsConfig;\n  }\n  get paramsConfig() {\n    const { internalParamsConfig } = this;\n    return Object.entries(this._paramsConfig || internalParamsConfig).reduce((configs, [id, config]) => {\n      var _a, _b, _c, _d;\n      const internalParam = internalParamsConfig[id];\n      configs[id] = new WamParameterInfo(id, __spreadProps(__spreadValues({}, config), {\n        label: (_a = config.label) != null ? _a : id,\n        defaultValue: (_b = config.defaultValue) != null ? _b : internalParam == null ? void 0 : internalParam.defaultValue,\n        minValue: (_c = config.minValue) != null ? _c : internalParam == null ? void 0 : internalParam.minValue,\n        maxValue: (_d = config.maxValue) != null ? _d : internalParam == null ? void 0 : internalParam.maxValue\n      }));\n      return configs;\n    }, {});\n  }\n  get internalParamsConfig() {\n    return Object.entries(this._internalParamsConfig || {}).reduce((configs, [name, config]) => {\n      if (config instanceof AudioParam)\n        configs[name] = config;\n      else {\n        const defaultConfig = {\n          minValue: 0,\n          maxValue: 1,\n          defaultValue: 0,\n          automationRate: 30\n        };\n        configs[name] = __spreadValues(__spreadValues({}, defaultConfig), config);\n      }\n      return configs;\n    }, {});\n  }\n  get paramsMapping() {\n    const declared = this._paramsMapping || {};\n    const externalParams = this.paramsConfig;\n    const internalParams = this.internalParamsConfig;\n    return Object.entries(externalParams).reduce((mapping, [name, { minValue, maxValue }]) => {\n      const sourceRange = [minValue, maxValue];\n      const defaultMapping = { sourceRange, targetRange: [...sourceRange] };\n      if (declared[name]) {\n        const declaredTargets = Object.entries(declared[name]).reduce((targets, [targetName, targetMapping]) => {\n          if (internalParams[targetName]) {\n            targets[targetName] = __spreadValues(__spreadValues({}, defaultMapping), targetMapping);\n          }\n          return targets;\n        }, {});\n        mapping[name] = declaredTargets;\n      } else if (internalParams[name]) {\n        mapping[name] = { [name]: __spreadValues({}, defaultMapping) };\n      }\n      return mapping;\n    }, {});\n  }\n};\n\n// src/MgrAudioParam.js\nvar MgrAudioParam = class extends AudioParam {\n  constructor() {\n    super(...arguments);\n    __publicField(this, \"_info\");\n  }\n  get exponent() {\n    return this.info.exponent;\n  }\n  get info() {\n    return this._info;\n  }\n  set info(info) {\n    this._info = info;\n  }\n  set normalizedValue(valueIn) {\n    this.value = this.info.denormalize(valueIn);\n  }\n  get normalizedValue() {\n    return this.info.normalize(this.value);\n  }\n  setValueAtTime(value, startTime) {\n    return super.setValueAtTime(value, startTime);\n  }\n  setNormalizedValueAtTime(valueIn, startTime) {\n    const value = this.info.denormalize(valueIn);\n    return this.setValueAtTime(value, startTime);\n  }\n  linearRampToValueAtTime(value, endTime) {\n    return super.linearRampToValueAtTime(value, endTime);\n  }\n  linearRampToNormalizedValueAtTime(valueIn, endTime) {\n    const value = this.info.denormalize(valueIn);\n    return this.linearRampToValueAtTime(value, endTime);\n  }\n  exponentialRampToValueAtTime(value, endTime) {\n    return super.exponentialRampToValueAtTime(value, endTime);\n  }\n  exponentialRampToNormalizedValueAtTime(valueIn, endTime) {\n    const value = this.info.denormalize(valueIn);\n    return this.exponentialRampToValueAtTime(value, endTime);\n  }\n  setTargetAtTime(target, startTime, timeConstant) {\n    return super.setTargetAtTime(target, startTime, timeConstant);\n  }\n  setNormalizedTargetAtTime(targetIn, startTime, timeConstant) {\n    const target = this.info.denormalize(targetIn);\n    return this.setTargetAtTime(target, startTime, timeConstant);\n  }\n  setValueCurveAtTime(values, startTime, duration) {\n    return super.setValueCurveAtTime(values, startTime, duration);\n  }\n  setNormalizedValueCurveAtTime(valuesIn, startTime, duration) {\n    const values = Array.from(valuesIn).map((v) => this.info.denormalize(v));\n    return this.setValueCurveAtTime(values, startTime, duration);\n  }\n  cancelScheduledParamValues(cancelTime) {\n    return super.cancelScheduledValues(cancelTime);\n  }\n  cancelAndHoldParamAtTime(cancelTime) {\n    return super.cancelAndHoldAtTime(cancelTime);\n  }\n};\n\n// src/ParamMgrNode.js\nvar AudioWorkletNode = globalThis.AudioWorkletNode;\nvar ParamMgrNode = class extends AudioWorkletNode {\n  constructor(module, options) {\n    super(module.audioContext, module.moduleId, {\n      numberOfInputs: 0,\n      numberOfOutputs: 1 + options.processorOptions.internalParams.length,\n      parameterData: options.parameterData,\n      processorOptions: options.processorOptions\n    });\n    __publicField(this, \"requestDispatchIParamChange\", (name) => {\n      const config = this.internalParamsConfig[name];\n      if (!(\"onChange\" in config))\n        return;\n      const { automationRate, onChange } = config;\n      if (typeof automationRate !== \"number\" || !automationRate)\n        return;\n      const interval = 1e3 / automationRate;\n      const i = this.internalParams.indexOf(name);\n      if (i === -1)\n        return;\n      if (i >= this.internalParams.length)\n        return;\n      if (typeof this.paramsUpdateCheckFnRef[i] === \"number\") {\n        window.clearTimeout(this.paramsUpdateCheckFnRef[i]);\n      }\n      this.paramsUpdateCheckFn[i] = () => {\n        const prev = this.$prevParamsBuffer[i];\n        const cur = this.$paramsBuffer[i];\n        if (cur !== prev) {\n          onChange(cur, prev);\n          this.$prevParamsBuffer[i] = cur;\n        }\n        this.paramsUpdateCheckFnRef[i] = window.setTimeout(this.paramsUpdateCheckFn[i], interval);\n      };\n      this.paramsUpdateCheckFn[i]();\n    });\n    const { processorOptions, internalParamsConfig } = options;\n    this.initialized = false;\n    this.module = module;\n    this.paramsConfig = processorOptions.paramsConfig;\n    this.internalParams = processorOptions.internalParams;\n    this.internalParamsConfig = internalParamsConfig;\n    this.$prevParamsBuffer = new Float32Array(this.internalParams.length);\n    this.paramsUpdateCheckFn = [];\n    this.paramsUpdateCheckFnRef = [];\n    this.messageRequestId = 0;\n    Object.entries(this.getParams()).forEach(([name, param]) => {\n      Object.setPrototypeOf(param, MgrAudioParam.prototype);\n      param._info = this.paramsConfig[name];\n    });\n    const resolves = {};\n    const rejects = {};\n    this.call = (call, ...args) => {\n      const id = this.messageRequestId;\n      this.messageRequestId += 1;\n      return new Promise((resolve, reject) => {\n        resolves[id] = resolve;\n        rejects[id] = reject;\n        this.port.postMessage({ id, call, args });\n      });\n    };\n    this.handleMessage = ({ data }) => {\n      var _a, _b;\n      const { id, call, args, value, error } = data;\n      if (call) {\n        const r = { id };\n        try {\n          r.value = this[call](...args);\n        } catch (e) {\n          r.error = e;\n        }\n        this.port.postMessage(r);\n      } else {\n        if (error)\n          (_a = rejects[id]) == null ? void 0 : _a.call(rejects, error);\n        else if (resolves[id])\n          (_b = resolves[id]) == null ? void 0 : _b.call(resolves, value);\n        delete resolves[id];\n        delete rejects[id];\n      }\n    };\n    this.port.start();\n    this.port.addEventListener(\"message\", this.handleMessage);\n  }\n  get parameters() {\n    return super.parameters;\n  }\n  get groupId() {\n    return this.module.groupId;\n  }\n  get moduleId() {\n    return this.module.moduleId;\n  }\n  get instanceId() {\n    return this.module.instanceId;\n  }\n  async initialize() {\n    const response = await this.call(\"getBuffer\");\n    const { lock, paramsBuffer } = response;\n    this.$lock = lock;\n    this.$paramsBuffer = paramsBuffer;\n    const offset = 1;\n    Object.entries(this.internalParamsConfig).forEach(([name, config], i) => {\n      if (this.context.state === \"suspended\")\n        this.$paramsBuffer[i] = config.defaultValue;\n      if (config instanceof AudioParam) {\n        try {\n          config.automationRate = \"a-rate\";\n        } catch (e) {\n        } finally {\n          config.value = Math.max(0, config.minValue);\n          this.connect(config, offset + i);\n        }\n      } else if (config instanceof AudioNode) {\n        this.connect(config, offset + i);\n      } else {\n        this.requestDispatchIParamChange(name);\n      }\n    });\n    this.connect(this.module.audioContext.destination, 0, 0);\n    this.initialized = true;\n    return this;\n  }\n  setBuffer({ lock, paramsBuffer }) {\n    this.$lock = lock;\n    this.$paramsBuffer = paramsBuffer;\n  }\n  setParamsMapping(paramsMapping) {\n    return this.call(\"setParamsMapping\", paramsMapping);\n  }\n  getCompensationDelay() {\n    return this.call(\"getCompensationDelay\");\n  }\n  getParameterInfo(...parameterIdQuery) {\n    return this.call(\"getParameterInfo\", ...parameterIdQuery);\n  }\n  getParameterValues(normalized, ...parameterIdQuery) {\n    return this.call(\"getParameterValues\", normalized, ...parameterIdQuery);\n  }\n  scheduleAutomation(event) {\n    const time = event.time || this.context.currentTime;\n    const { id, normalized, value } = event.data;\n    const audioParam = this.getParam(id);\n    if (!audioParam)\n      return;\n    if (audioParam.info.type === \"float\") {\n      if (normalized)\n        audioParam.linearRampToNormalizedValueAtTime(value, time);\n      else\n        audioParam.linearRampToValueAtTime(value, time);\n    } else {\n      if (normalized)\n        audioParam.setNormalizedValueAtTime(value, time);\n      else\n        audioParam.setValueAtTime(value, time);\n    }\n  }\n  scheduleEvents(...events) {\n    events.forEach((event) => {\n      if (event.type === \"wam-automation\") {\n        this.scheduleAutomation(event);\n      }\n    });\n    this.call(\"scheduleEvents\", ...events);\n  }\n  emitEvents(...events) {\n    this.call(\"emitEvents\", ...events);\n  }\n  clearEvents() {\n    this.call(\"clearEvents\");\n  }\n  dispatchWamEvent(event) {\n    if (event.type === \"wam-automation\") {\n      this.scheduleAutomation(event);\n    } else {\n      this.dispatchEvent(new CustomEvent(event.type, { detail: event }));\n    }\n  }\n  async setParameterValues(parameterValues) {\n    Object.keys(parameterValues).forEach((parameterId) => {\n      const parameterUpdate = parameterValues[parameterId];\n      const parameter = this.parameters.get(parameterId);\n      if (!parameter)\n        return;\n      if (!parameterUpdate.normalized)\n        parameter.value = parameterUpdate.value;\n      else\n        parameter.normalizedValue = parameterUpdate.value;\n    });\n  }\n  async getState() {\n    return this.getParamsValues();\n  }\n  async setState(state) {\n    this.setParamsValues(state);\n  }\n  convertTimeToFrame(time) {\n    return Math.round(time * this.context.sampleRate);\n  }\n  convertFrameToTime(frame) {\n    return frame / this.context.sampleRate;\n  }\n  getIParamIndex(name) {\n    const i = this.internalParams.indexOf(name);\n    return i === -1 ? null : i;\n  }\n  connectIParam(name, dest, index) {\n    const offset = 1;\n    const i = this.getIParamIndex(name);\n    if (i !== null) {\n      if (dest instanceof AudioNode) {\n        if (typeof index === \"number\")\n          this.connect(dest, offset + i, index);\n        else\n          this.connect(dest, offset + i);\n      } else {\n        this.connect(dest, offset + i);\n      }\n    }\n  }\n  disconnectIParam(name, dest, index) {\n    const offset = 1;\n    const i = this.getIParamIndex(name);\n    if (i !== null) {\n      if (dest instanceof AudioNode) {\n        if (typeof index === \"number\")\n          this.disconnect(dest, offset + i, index);\n        else\n          this.disconnect(dest, offset + i);\n      } else {\n        this.disconnect(dest, offset + i);\n      }\n    }\n  }\n  getIParamValue(name) {\n    const i = this.getIParamIndex(name);\n    return i !== null ? this.$paramsBuffer[i] : null;\n  }\n  getIParamsValues() {\n    const values = {};\n    this.internalParams.forEach((name, i) => {\n      values[name] = this.$paramsBuffer[i];\n    });\n    return values;\n  }\n  getParam(name) {\n    return this.parameters.get(name) || null;\n  }\n  getParams() {\n    return Object.fromEntries(this.parameters);\n  }\n  getParamValue(name) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.value;\n  }\n  setParamValue(name, value) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return;\n    param.value = value;\n  }\n  getParamsValues() {\n    const values = {};\n    this.parameters.forEach((v, k) => {\n      values[k] = v.value;\n    });\n    return values;\n  }\n  setParamsValues(values) {\n    if (!values)\n      return;\n    Object.entries(values).forEach(([k, v]) => {\n      this.setParamValue(k, v);\n    });\n  }\n  getNormalizedParamValue(name) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.normalizedValue;\n  }\n  setNormalizedParamValue(name, value) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return;\n    param.normalizedValue = value;\n  }\n  getNormalizedParamsValues() {\n    const values = {};\n    this.parameters.forEach((v, k) => {\n      values[k] = this.getNormalizedParamValue(k);\n    });\n    return values;\n  }\n  setNormalizedParamsValues(values) {\n    if (!values)\n      return;\n    Object.entries(values).forEach(([k, v]) => {\n      this.setNormalizedParamValue(k, v);\n    });\n  }\n  setParamValueAtTime(name, value, startTime) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.setValueAtTime(value, startTime);\n  }\n  setNormalizedParamValueAtTime(name, value, startTime) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.setNormalizedValueAtTime(value, startTime);\n  }\n  linearRampToParamValueAtTime(name, value, endTime) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.linearRampToValueAtTime(value, endTime);\n  }\n  linearRampToNormalizedParamValueAtTime(name, value, endTime) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.linearRampToNormalizedValueAtTime(value, endTime);\n  }\n  exponentialRampToParamValueAtTime(name, value, endTime) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.exponentialRampToValueAtTime(value, endTime);\n  }\n  exponentialRampToNormalizedParamValueAtTime(name, value, endTime) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.exponentialRampToNormalizedValueAtTime(value, endTime);\n  }\n  setParamTargetAtTime(name, target, startTime, timeConstant) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.setTargetAtTime(target, startTime, timeConstant);\n  }\n  setNormalizedParamTargetAtTime(name, target, startTime, timeConstant) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.setNormalizedTargetAtTime(target, startTime, timeConstant);\n  }\n  setParamValueCurveAtTime(name, values, startTime, duration) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.setValueCurveAtTime(values, startTime, duration);\n  }\n  setNormalizedParamValueCurveAtTime(name, values, startTime, duration) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.setNormalizedValueCurveAtTime(values, startTime, duration);\n  }\n  cancelScheduledParamValues(name, cancelTime) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.cancelScheduledValues(cancelTime);\n  }\n  cancelAndHoldParamAtTime(name, cancelTime) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.cancelAndHoldAtTime(cancelTime);\n  }\n  connectEvents(toId, output) {\n    this.call(\"connectEvents\", toId, output);\n  }\n  disconnectEvents(toId, output) {\n    this.call(\"disconnectEvents\", toId, output);\n  }\n  async destroy() {\n    this.disconnect();\n    this.paramsUpdateCheckFnRef.forEach((ref) => {\n      if (typeof ref === \"number\")\n        window.clearTimeout(ref);\n    });\n    await this.call(\"destroy\");\n    this.port.close();\n  }\n};\n\n// src/ParamMgrFactory.js\nvar ParamMgrFactory = class {\n  static async create(module, optionsIn = {}) {\n    const { audioContext, groupId, moduleId, instanceId } = module;\n    const { paramsConfig, paramsMapping, internalParamsConfig } = new ParamMappingConfigurator(optionsIn);\n    const initialParamsValue = Object.entries(paramsConfig).reduce((currentParams, [name, { defaultValue }]) => {\n      currentParams[name] = defaultValue;\n      return currentParams;\n    }, {});\n    const serializableParamsConfig = Object.entries(paramsConfig).reduce((currentParams, [name, { id, label, type, defaultValue, minValue, maxValue, discreteStep, exponent, choices, units }]) => {\n      currentParams[name] = { id, label, type, defaultValue, minValue, maxValue, discreteStep, exponent, choices, units };\n      return currentParams;\n    }, {});\n    await addFunctionModule_default(audioContext.audioWorklet, ParamMgrProcessor_default, moduleId, serializableParamsConfig);\n    const options = {\n      internalParamsConfig,\n      parameterData: initialParamsValue,\n      processorOptions: {\n        paramsConfig,\n        paramsMapping,\n        internalParamsMinValues: Object.values(internalParamsConfig).map((config) => Math.max(0, (config == null ? void 0 : config.minValue) || 0)),\n        internalParams: Object.keys(internalParamsConfig),\n        groupId,\n        instanceId,\n        moduleId\n      }\n    };\n    const node = new ParamMgrNode(module, options);\n    await node.initialize();\n    return node;\n  }\n};\nexport {\n  CompositeAudioNode,\n  ParamMgrFactory\n};\n//# sourceMappingURL=index.js.map\n","/* eslint-disable no-console */\n/* eslint-disable no-mixed-operators */\n/* eslint-disable no-plusplus */\n/* eslint-disable no-underscore-dangle */\nimport { CompositeAudioNode } from '@webaudiomodules/sdk-parammgr';\n\n// name is not so important here, the file Node.js is imported\n// Normally the class does no need to be exported as\n// an async mehod createNode is expored at the end of this\n// file.\nexport default class QuadrafuzzNode extends CompositeAudioNode {\n\t/**\n\t * @type {ParamMgrNode}\n\t */\n\t_wamNode = undefined;\n\n\t/**\n\t * @param {ParamMgrNode} wamNode\n\t */\n\t// Mandatory.\n\tsetup(wamNode) {\n\t\tthis._wamNode = wamNode;\n\t\tthis.connectNodes();\n\t}\n\n\tconstructor(context, options) {\n\t\tsuper(context, options);\n\t\tthis.createNodes();\n\t}\n\n\t/*  #########  Personnal code for the web audio graph  #########   */\n\tcreateNodes() {\n\t\t// mandatory, will create defaul input and output\n\n\t\tthis.outputNode = this.context.createGain();\n\t\tthis.dryGainNode = this.context.createGain();\n\t\tthis.wetGainNode = this.context.createGain();\n\n\t\tthis.lowpassLeft = this.context.createBiquadFilter();\n\t\tthis.lowpassLeft.type = 'lowpass';\n\t\tthis.lowpassLeft.frequency.value = 147;\n\t\tthis.lowpassLeft.Q.value = 0.7071;\n\n\t\tthis.bandpass1Left = this.context.createBiquadFilter();\n\t\tthis.bandpass1Left.type = 'bandpass';\n\t\tthis.bandpass1Left.frequency.value = 587;\n\t\tthis.bandpass1Left.Q.value = 0.7071;\n\n\t\tthis.bandpass2Left = this.context.createBiquadFilter();\n\t\tthis.bandpass2Left.type = 'bandpass';\n\t\tthis.bandpass2Left.frequency.value = 2490;\n\t\tthis.bandpass2Left.Q.value = 0.7071;\n\n\t\tthis.highpassLeft = this.context.createBiquadFilter();\n\t\tthis.highpassLeft.type = 'highpass';\n\t\tthis.highpassLeft.frequency.value = 4980;\n\t\tthis.highpassLeft.Q.value = 0.7071;\n\n\t\tthis.overdrives = [];\n\t\tfor (let i = 0; i < 4; i++) {\n\t\t\tthis.overdrives[i] = this.context.createWaveShaper();\n\t\t\tthis.overdrives[i].curve = this.getDistortionCurve(this.normalize(0.5, 0, 150));\n\t\t}\n\t}\n\n\tconnectNodes() {\n\t\tthis.connect(this.wetGainNode);\n\t\tthis.connect(this.dryGainNode);\n\t\tthis._output = this.outputNode;\n\t\tthis.dryGainNode.connect(this._output);\n\n\t\tconst filters = [\n\t\t\tthis.lowpassLeft,\n\t\t\tthis.bandpass1Left,\n\t\t\tthis.bandpass2Left,\n\t\t\tthis.highpassLeft,\n\t\t];\n\t\tfor (let i = 0; i < filters.length; i++) {\n\t\t\t//this.wetGainNode.connect(this._output)\n\t\t\tthis.wetGainNode.connect(filters[i]);\n\t\t\t//this.wetGainNode.connect(this.overdrives[i]);\n\t\t\t//filters[i].connect(this._output);\n\t\t\tfilters[i].connect(this.overdrives[i]);\n\t\t\tthis.overdrives[i].connect(this._output);\n\t\t\t//filters[i].connect(this._output);\n\t\t}\n\t}\n\n\t/**\n     * Tools to build sounds\n     */\n\tgetDistortionCurve(k) {\n\t\tconsole.log(`GET DISTORSION CURVE k = ${k}`);\n\t\tconst { sampleRate } = this.context;\n\t\tconst curve = new Float32Array(sampleRate);\n\t\tconst deg = Math.PI / 180;\n\n\t\tfor (let i = 0; i < sampleRate; i++) {\n\t\t\tconst x = i * 2 / sampleRate - 1;\n\t\t\tcurve[i] = (3 + k) * x * 20 * deg / (Math.PI + k * Math.abs(x));\n\t\t}\n\t\treturn curve;\n\t}\n\n\tisInRange(arg, min, max) {\n\t\tif (!this.isNumber(arg) || !this.isNumber(min) || !this.isNumber(max)) return false;\n\n\t\treturn arg >= min && arg <= max;\n\t}\n\n\n\t// Takes a number from 0 to 1 and normalizes it to fit within range floor to ceiling\n\tnormalize(num, floor, ceil) {\n\t\tif (!this.isNumber(num) || !this.isNumber(floor) || !this.isNumber(ceil)) return num;\n\n\t\treturn ((ceil - floor) * num) / 1 + floor;\n\t}\n\n\n\t// Setter part, it is here that you define the link between the params and the nodes values.\n\tset lowGain(_lowGain) {\n\t\tconsole.log(`set lowGain : ${_lowGain}`);\n\t\tif (!this.isInRange(_lowGain, 0, 1)) return;\n\t\t//this.params.lowgain = _lowGain;\n\t\tthis.overdrives[0].curve = this.getDistortionCurve(this.normalize(_lowGain, 0, 150));\n\t}\n\n\tset midLowGain(_midLowGain) {\n\t\tconsole.log('midLowGain');\n\n\t\tif (!this.isInRange(_midLowGain, 0, 1)) return;\n\t\t// this.params.midlowgain = _midLowGain;\n\t\tthis.overdrives[1].curve = this.getDistortionCurve(this.normalize(_midLowGain, 0, 150));\n\t}\n\n\tset midHighGain(_midHighGain) {\n\t\tconsole.log('midHighGain');\n\n\t\tif (!this.isInRange(_midHighGain, 0, 1)) return;\n\t\t// this.params.midhighgain = _midHighGain;\n\t\tthis.overdrives[2].curve = this.getDistortionCurve(this.normalize(_midHighGain, 0, 150));\n\t}\n\n\tset highGain(_highGain) {\n\t\tconsole.log('highGain');\n\n\t\tif (!this.isInRange(_highGain, 0, 1)) return;\n\t\t//this.params.highgain = _highGain;\n\t\tthis.overdrives[3].curve = this.getDistortionCurve(this.normalize(_highGain, 0, 150));\n\t}\n\n\n\tisEnabled = true;\n\n\tset status(_sig) {\n\t\tif (this.isEnabled === _sig) return;\n\n\t\tthis.isEnabled = _sig;\n\t\tif (_sig) {\n\t\t\tconsole.log('BYPASS MODE OFF FX RUNNING');\n\t\t\tthis.wetGainNode.gain.linearRampToValueAtTime(1, this.context.currentTime + 0.5);\n\t\t\tthis.dryGainNode.gain.linearRampToValueAtTime(0, this.context.currentTime + 0.5);\n\t\t} else {\n\t\t\tconsole.log('BYPASS MODE ON');\n\t\t\tthis.wetGainNode.gain.linearRampToValueAtTime(0, this.context.currentTime + 0.5);\n\t\t\tthis.dryGainNode.gain.linearRampToValueAtTime(1, this.context.currentTime + 0.5);\n\t\t}\n\t}\n\n\t// delay tools\n\t// Tools to build sounds\n\t// eslint-disable-next-line class-methods-use-this\n\tisNumber(arg) {\n\t\treturn toString.call(arg) === '[object Number]' && arg === +arg;\n\t}\n\n\tgetDryLevel(mix) {\n\t\tif (!this.isNumber(mix) || mix > 1 || mix < 0) return 0;\n\t\tif (mix <= 0.5) return 1;\n\t\treturn 1 - (mix - 0.5) * 2;\n\t}\n\n\tgetWetLevel(mix) {\n\t\tif (!this.isNumber(mix) || mix > 1 || mix < 0) return 0;\n\t\tif (mix >= 0.5) return 1;\n\t\treturn 1 - (0.5 - mix) * 2;\n\t}\n\n\tgetParamValue(name) {\n\t\treturn this._wamNode.getParamValue(name);\n\t}\n\n\tsetParamValue(name, value) {\n\t\treturn this._wamNode.setParamValue(name, value);\n\t}\n\n\tgetParamsValues() {\n\t\treturn this._wamNode.getParamsValues();\n\t}\n\n\tsetParamsValues(values) {\n\t\treturn this._wamNode.setParamsValues(values);\n\t}\n}\n","/* *\n *\n *  WebAudio-Controls is based on\n *    webaudio-knob by Eiji Kitamura http://google.com/+agektmr\n *    webaudio-slider by RYoya Kawai https://plus.google.com/108242669191458983485/posts\n *    webaudio-switch by Keisuke Ai http://d.hatena.ne.jp/aike/\n *  Integrated and enhanced by g200kg http://www.g200kg.com/\n *\n *\tCopyright 2013 Eiji Kitamura / Ryoya KAWAI / Keisuke Ai / g200kg(Tatsuya Shinyagaito)\n *\n *\t Licensed under the Apache License, Version 2.0 (the \"License\");\n *\t you may not use this file except in compliance with the License.\n *\t You may obtain a copy of the License at\n *\n *\t http://www.apache.org/licenses/LICENSE-2.0\n *\n *\t Unless required by applicable law or agreed to in writing, software\n *\t distributed under the License is distributed on an \"AS IS\" BASIS,\n *\t WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\t See the License for the specific language governing permissions and\n *\t limitations under the License.\n *\n * */\n if (window.customElements) {\n\tlet styles = document.createElement(\"style\");\n\tstyles.innerHTML =\n\t\t`#webaudioctrl-context-menu {\n  display: none;\n  position: absolute;\n  z-index: 10;\n  padding: 0;\n  width: 100px;\n  color:#eee;\n  background-color: #268;\n  border: solid 1px #888;\n  box-shadow: 1px 1px 2px #888;\n  font-family: sans-serif;\n  font-size: 11px;\n  line-height:1.7em;\n  text-align:center;\n  cursor:pointer;\n  color:#fff;\n  list-style: none;\n}\n#webaudioctrl-context-menu.active {\n  display: block;\n}\n.webaudioctrl-context-menu__item {\n  display: block;\n  margin: 0;\n  padding: 0;\n  color: #000;\n  background-color:#eee;\n  text-decoration: none;\n}\n.webaudioctrl-context-menu__title{\n  font-weight:bold;\n}\n.webaudioctrl-context-menu__item:last-child {\n  margin-bottom: 0;\n}\n.webaudioctrl-context-menu__item:hover {\n  background-color: #b8b8b8;\n}\n`;\n\tdocument.head.appendChild(styles);\n\tlet midimenu = document.createElement(\"ul\");\n\tmidimenu.id = \"webaudioctrl-context-menu\";\n\tmidimenu.innerHTML =\n\t\t`<li class=\"webaudioctrl-context-menu__title\">MIDI Learn</li>\n<li class=\"webaudioctrl-context-menu__item\" id=\"webaudioctrl-context-menu-learn\" onclick=\"webAudioControlsMidiManager.contextMenuLearn()\">Learn</li>\n<li class=\"webaudioctrl-context-menu__item\" onclick=\"webAudioControlsMidiManager.contextMenuClear()\">Clear</li>\n<li class=\"webaudioctrl-context-menu__item\" onclick=\"webAudioControlsMidiManager.contextMenuClose()\">Close</li>\n`;\n\tlet opt = {\n\t\tuseMidi: 0,\n\t\tmidilearn: 0,\n\t\tmididump: 0,\n\t\toutline: 0,\n\t\tknobSrc: null,\n\t\tknobSprites: 0,\n\t\tknobWidth: 0,\n\t\tknobHeight: 0,\n\t\tknobDiameter: 64,\n\t\tknobColors: \"#fff;#000;#000\",\n\t\tsliderSrc: null,\n\t\tsliderKnobsrc: null,\n\t\tsliderWidth: 0,\n\t\tsliderHeight: 0,\n\t\tsliderKnobwidth: 0,\n\t\tsliderKnobheight: 0,\n\t\tsliderDitchlength: 0,\n\t\tsliderColors: \"#bbb;#444;#fff\",\n\t\tswitchWidth: 0,\n\t\tswitchHeight: 0,\n\t\tswitchDiameter: 24,\n\t\tswitchColors: \"#e00;#000;#fcc\",\n\t\tparamWidth: 32,\n\t\tparamHeight: 16,\n\t\tparamColors: \"#fff;#000\",\n\t};\n\tif (window.WebAudioControlsOptions)\n\t\tObject.assign(opt, window.WebAudioControlsOptions);\n\tclass WebAudioControlsWidget extends HTMLElement {\n\t\tconstructor() {\n\t\t\tsuper();\n\t\t\tthis.addEventListener(\"keydown\", this.keydown);\n\t\t\tthis.addEventListener(\"mousedown\", this.pointerdown, { passive: false });\n\t\t\tthis.addEventListener(\"touchstart\", this.pointerdown, { passive: false });\n\t\t\tthis.addEventListener(\"wheel\", this.wheel, { passive: true });\n\t\t\tthis.addEventListener(\"mouseover\", this.pointerover);\n\t\t\tthis.addEventListener(\"mouseout\", this.pointerout);\n\t\t\tthis.addEventListener(\"contextmenu\", this.contextMenu);\n\t\t\tthis.hover = this.drag = 0;\n\t\t\tdocument.body.appendChild(midimenu);\n\t\t\tthis.basestyle = `\n.webaudioctrl-tooltip{\n  display:inline-block;\n  position:absolute;\n  margin:0 -1000px;\n  z-index: 999;\n  background:#eee;\n  color:#000;\n  border:1px solid #666;\n  border-radius:4px;\n  padding:5px 10px;\n  text-align:center;\n  left:0; top:0;\n  font-size:11px;\n  opacity:0;\n  visibility:hidden;\n}\n.webaudioctrl-tooltip:before{\n  content: \"\";\n\tposition: absolute;\n\ttop: 100%;\n\tleft: 50%;\n \tmargin-left: -8px;\n\tborder: 8px solid transparent;\n\tborder-top: 8px solid #666;\n}\n.webaudioctrl-tooltip:after{\n  content: \"\";\n\tposition: absolute;\n\ttop: 100%;\n\tleft: 50%;\n \tmargin-left: -6px;\n\tborder: 6px solid transparent;\n\tborder-top: 6px solid #eee;\n}\n`;\n\t\t}\n\t\tsendEvent(ev) {\n\t\t\tlet event;\n\t\t\tevent = document.createEvent(\"HTMLEvents\");\n\t\t\tevent.initEvent(ev, false, true);\n\t\t\tthis.dispatchEvent(event);\n\t\t}\n\t\tgetAttr(n, def) {\n\t\t\tlet v = this.getAttribute(n);\n\t\t\tif (v == \"\" || v == null) return def;\n\t\t\tswitch (typeof (def)) {\n\t\t\t\tcase \"number\":\n\t\t\t\t\tif (v == \"true\") return 1;\n\t\t\t\t\tv = +v;\n\t\t\t\t\tif (isNaN(v)) return 0;\n\t\t\t\t\treturn v;\n\t\t\t}\n\t\t\treturn v;\n\t\t}\n\t\tshowtip(d) {\n\t\t\tfunction numformat(s, x) {\n\t\t\t\tlet i = s.indexOf(\"%\");\n\t\t\t\tlet c = [0, 0], type = 0, m = 0, r = \"\", j = i + 1;\n\t\t\t\tfor (; j < s.length; ++j) {\n\t\t\t\t\tif (\"dfxXs\".indexOf(s[j]) >= 0) {\n\t\t\t\t\t\ttype = s[j];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif (s[j] == \".\")\n\t\t\t\t\t\tm = 1;\n\t\t\t\t\telse\n\t\t\t\t\t\tc[m] = c[m] * 10 + parseInt(s[j]);\n\t\t\t\t}\n\t\t\t\tswitch (type) {\n\t\t\t\t\tcase \"x\": r = (x | 0).toString(16); break;\n\t\t\t\t\tcase \"X\": r = (x | 0).toString(16).toUpperCase(); break;\n\t\t\t\t\tcase \"d\": r = (x | 0).toString(); break;\n\t\t\t\t\tcase \"f\": r = x.toFixed(c[1]); break;\n\t\t\t\t\tcase \"s\": r = x.toString(); break;\n\t\t\t\t}\n\t\t\t\tif (c[0] > 0)\n\t\t\t\t\tr = (\"               \" + r).slice(-c[0]);\n\t\t\t\tr = s.replace(/%.*[xXdfs]/, r);\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tlet s = this.tooltip;\n\t\t\tif (this.drag || this.hover) {\n\t\t\t\tif (this.valuetip) {\n\t\t\t\t\tif (s == null)\n\t\t\t\t\t\ts = `%.${this.digits}f`;\n\t\t\t\t\telse if (s.indexOf(\"%\") < 0)\n\t\t\t\t\t\ts += ` : %.${this.digits}f`;\n\t\t\t\t}\n\t\t\t\tif (s) {\n\t\t\t\t\tthis.ttframe.innerHTML = numformat(s, this.convValue);\n\t\t\t\t\tthis.ttframe.style.display = \"inline-block\";\n\t\t\t\t\tthis.ttframe.style.width = \"auto\";\n\t\t\t\t\tthis.ttframe.style.height = \"auto\";\n\t\t\t\t\tthis.ttframe.style.transition = \"opacity 0.5s \" + d + \"s,visibility 0.5s \" + d + \"s\";\n\t\t\t\t\tthis.ttframe.style.opacity = 0.9;\n\t\t\t\t\tthis.ttframe.style.visibility = \"visible\";\n\t\t\t\t\tlet rc = this.getBoundingClientRect(), rc2 = this.ttframe.getBoundingClientRect(), rc3 = document.documentElement.getBoundingClientRect();\n\t\t\t\t\tthis.ttframe.style.left = ((rc.width - rc2.width) * 0.5 + 1000) + \"px\";\n\t\t\t\t\tthis.ttframe.style.top = (-rc2.height - 8) + \"px\";\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.ttframe.style.transition = \"opacity 0.1s \" + d + \"s,visibility 0.1s \" + d + \"s\";\n\t\t\tthis.ttframe.style.opacity = 0;\n\t\t\tthis.ttframe.style.visibility = \"hidden\";\n\t\t}\n\t\tpointerover(e) {\n\t\t\tthis.hover = 1;\n\t\t\tthis.showtip(0.6);\n\t\t}\n\t\tpointerout(e) {\n\t\t\tthis.hover = 0;\n\t\t\tthis.showtip(0);\n\t\t}\n\t\tcontextMenu(e) {\n\t\t\tif (window.webAudioControlsMidiManager && this.midilearn) {\n\t\t\t\twebAudioControlsMidiManager.contextMenuOpen(e, this);\n\t\t\t}\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t}\n\t\tsetMidiController(channel, cc) {\n\t\t\tif (this.listeningToThisMidiController(channel, cc)) return;\n\t\t\tthis.midiController = { 'channel': channel, 'cc': cc };\n\t\t\tconsole.log(\"Added mapping for channel=\" + channel + \" cc=\" + cc + \" tooltip=\" + this.tooltip);\n\t\t}\n\t\tlisteningToThisMidiController(channel, cc) {\n\t\t\tconst c = this.midiController;\n\t\t\tif ((c.channel === channel || c.channel < 0) && c.cc === cc)\n\t\t\t\treturn true;\n\t\t\treturn false;\n\t\t}\n\t\tprocessMidiEvent(event) {\n\t\t\tconst channel = event.data[0] & 0xf;\n\t\t\tconst controlNumber = event.data[1];\n\t\t\tif (this.midiMode == 'learn') {\n\t\t\t\tthis.setMidiController(channel, controlNumber);\n\t\t\t\twebAudioControlsMidiManager.contextMenuClose();\n\t\t\t\tthis.midiMode = 'normal';\n\t\t\t}\n\t\t\tif (this.listeningToThisMidiController(channel, controlNumber)) {\n\t\t\t\tif (this.tagName == \"WEBAUDIO-SWITCH\") {\n\t\t\t\t\tswitch (this.type) {\n\t\t\t\t\t\tcase \"toggle\":\n\t\t\t\t\t\t\tif (event.data[2] >= 64)\n\t\t\t\t\t\t\t\tthis.setValue(1 - this.value, true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"kick\":\n\t\t\t\t\t\t\tthis.setValue(event.data[2] >= 64 ? 1 : 0);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"radio\":\n\t\t\t\t\t\t\tlet els = document.querySelectorAll(\"webaudio-switch[type='radio'][group='\" + this.group + \"']\");\n\t\t\t\t\t\t\tfor (let i = 0; i < els.length; ++i) {\n\t\t\t\t\t\t\t\tif (els[i] == this)\n\t\t\t\t\t\t\t\t\tels[i].setValue(1);\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tels[i].setValue(0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tconst val = this.min + (this.max - this.min) * event.data[2] / 127;\n\t\t\t\t\tthis.setValue(val, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\ttry {\n\t\tcustomElements.define(\"webaudio-knob\", class WebAudioKnob extends WebAudioControlsWidget {\n\t\t\tconstructor() {\n\t\t\t\tsuper();\n\t\t\t}\n\t\t\tget src() { return this._src; }\n\t\t\tset src(v) { this._src = v; this.setupImage(); }\n\t\t\tget value() { return this._value; }\n\t\t\tset value(v) { this._value = +v; this.redraw(); }\n\t\t\tget min() { return this._min; }\n\t\t\tset min(v) { this._min = +v; this.redraw(); }\n\t\t\tget max() { return this._max; }\n\t\t\tset max(v) { this._max = +v; this.redraw(); }\n\t\t\tget step() { return this._step; }\n\t\t\tset step(v) { this._step = +v; this.redraw(); }\n\t\t\tget sprites() { return this._sprites; }\n\t\t\tset sprites(v) { this._sprites = +v; this.setupImage(); }\n\t\t\tget width() { return this._width; }\n\t\t\tset width(v) { this._width = +v; this.setupImage(); }\n\t\t\tget height() { return this._height; }\n\t\t\tset height(v) { this._height = +v; this.setupImage(); }\n\t\t\tget diameter() { return this._diameter; }\n\t\t\tset diameter(v) { this._diameter = +v; this.setupImage(); }\n\t\t\tget colors() { return this._colors; }\n\t\t\tset colors(v) { this._colors = v; this.setupImage(); }\n\n\t\t\tconnectedCallback() {\n\t\t\t\tlet root;\n\t\t\t\t//      if(this.attachShadow)\n\t\t\t\t//        root=this.attachShadow({mode: 'open'});\n\t\t\t\t//      else\n\t\t\t\troot = this;\n\t\t\t\troot.innerHTML =\n\t\t\t\t\t`<style>\n${this.basestyle}\nwebaudio-knob{\n  display:inline-block;\n  position:relative;\n  margin:0;\n  padding:0;\n  cursor:pointer;\n  font-family: sans-serif;\n  font-size: 11px;\n}\n.webaudio-knob-body{\n  display:inline-block;\n  position:relative;\n  z-index:1;\n  margin:0;\n  padding:0;\n}\n</style>\n<div class='webaudio-knob-body' tabindex='1' touch-action='none'></div><div class='webaudioctrl-tooltip'></div>\n`;\n\t\t\t\tthis.elem = root.childNodes[2];\n\t\t\t\tthis.ttframe = root.childNodes[3];\n\t\t\t\tthis.enable = this.getAttr(\"enable\", 1);\n\t\t\t\tthis._src = this.getAttr(\"src\", opt.knobSrc);\n\t\t\t\tthis._value = this.getAttr(\"value\", 0);\n\t\t\t\tthis.defvalue = this.getAttr(\"defvalue\", 0);\n\t\t\t\tthis._min = this.getAttr(\"min\", 0);\n\t\t\t\tthis._max = this.getAttr(\"max\", 100);\n\t\t\t\tthis._step = this.getAttr(\"step\", 1);\n\t\t\t\tthis._sprites = this.getAttr(\"sprites\", opt.knobSprites);\n\t\t\t\tthis._width = this.getAttr(\"width\", opt.knobWidth);\n\t\t\t\tthis._height = this.getAttr(\"height\", opt.knobHeight);\n\t\t\t\tthis._diameter = this.getAttr(\"diameter\", opt.knobDiameter);\n\t\t\t\tthis._colors = this.getAttr(\"colors\", opt.knobColors);\n\t\t\t\tthis.outline = this.getAttr(\"outline\", opt.outline);\n\t\t\t\tthis.sensitivity = this.getAttr(\"sensitivity\", 1);\n\t\t\t\tthis.valuetip = this.getAttr(\"valuetip\", 1);\n\t\t\t\tthis.tooltip = this.getAttr(\"tooltip\", null);\n\t\t\t\tthis.conv = this.getAttr(\"conv\", null);\n\t\t\t\tif (this.conv)\n\t\t\t\t\tthis.convValue = eval(this.conv)(this._value);\n\t\t\t\telse\n\t\t\t\t\tthis.convValue = this._value;\n\t\t\t\tthis.midilearn = this.getAttr(\"midilearn\", opt.midilearn);\n\t\t\t\tthis.midicc = this.getAttr(\"midicc\", null);\n\n\t\t\t\tthis.midiController = {};\n\t\t\t\tthis.midiMode = \"normal\";\n\t\t\t\tif (this.midicc) {\n\t\t\t\t\tlet ch = parseInt(this.midicc.substring(0, this.midicc.lastIndexOf(\".\"))) - 1;\n\t\t\t\t\tlet cc = parseInt(this.midicc.substring(this.midicc.lastIndexOf(\".\") + 1));\n\t\t\t\t\tthis.setMidiController(ch, cc);\n\t\t\t\t}\n\t\t\t\tthis.setupImage();\n\t\t\t\tthis.digits = 0;\n\t\t\t\tthis.coltab = [\"#e00\", \"#000\", \"#000\"];\n\t\t\t\tif (window.webAudioControlsMidiManager)\n\t\t\t\t\t//        window.webAudioControlsMidiManager.updateWidgets();\n\t\t\t\t\twindow.webAudioControlsMidiManager.addWidget(this);\n\t\t\t}\n\t\t\tdisconnectedCallback() { }\n\t\t\tsetupImage() {\n\t\t\t\tthis.kw = this.width || this.diameter;\n\t\t\t\tthis.kh = this.height || this.diameter;\n\t\t\t\tif (!this.src) {\n\t\t\t\t\tif (this.colors)\n\t\t\t\t\t\tthis.coltab = this.colors.split(\";\");\n\t\t\t\t\tif (!this.coltab)\n\t\t\t\t\t\tthis.coltab = [\"#e00\", \"#000\", \"#000\"];\n\t\t\t\t\tlet svg =\n\t\t\t\t\t\t`<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"64\" height=\"6464\" preserveAspectRatio=\"none\">\n<radialGradient id=\"gr\" cx=\"30%\" cy=\"30%\"><stop offset=\"0%\" stop-color=\"${this.coltab[2]}\"/><stop offset=\"100%\" stop-color=\"${this.coltab[1]}\"/></radialGradient>\n<defs><circle id=\"B\" cx=\"32\" cy=\"32\" r=\"30\" fill=\"url(#gr)\"/></defs>\n<defs><line id=\"K\" x1=\"32\" y1=\"28\" x2=\"32\" y2=\"7\" stroke-linecap=\"round\" stroke-width=\"6\" stroke=\"${this.coltab[0]}\"/></defs>`;\n\t\t\t\t\tfor (let i = 0; i < 101; ++i) {\n\t\t\t\t\t\tsvg += `<use xlink:href=\"#B\" y=\"${64 * i}\"/>`;\n\t\t\t\t\t\tsvg += `<use xlink:href=\"#K\" y=\"${64 * i}\" transform=\"rotate(${(-135 + 270 * i / 101).toFixed(2)},32,${64 * i + 32})\"/>`;\n\t\t\t\t\t}\n\t\t\t\t\tsvg += \"</svg>\";\n\t\t\t\t\tthis.elem.style.backgroundImage = \"url(data:image/svg+xml;base64,\" + btoa(svg) + \")\";\n\t\t\t\t\t//        this.elem.style.backgroundSize = \"100% 10100%\";\n\t\t\t\t\tthis.elem.style.backgroundSize = `${this.kw}px ${this.kh * 101}px`;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.elem.style.backgroundImage = \"url(\" + (this.src) + \")\";\n\t\t\t\t\tif (!this.sprites)\n\t\t\t\t\t\tthis.elem.style.backgroundSize = \"100% 100%\";\n\t\t\t\t\telse {\n\t\t\t\t\t\t//          this.elem.style.backgroundSize = `100% ${(this.sprites+1)*100}%`;\n\t\t\t\t\t\tthis.elem.style.backgroundSize = `${this.kw}px ${this.kh * (this.sprites + 1)}px`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.elem.style.outline = this.outline ? \"\" : \"none\";\n\t\t\t\tthis.elem.style.width = this.kw + \"px\";\n\t\t\t\tthis.elem.style.height = this.kh + \"px\";\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t\tredraw() {\n\t\t\t\tif (!this.isConnected) return;\n\t\t\t\tthis.digits = 0;\n\t\t\t\tif (this.step && this.step < 1) {\n\t\t\t\t\tfor (let n = this.step; n < 1; n *= 10)\n\t\t\t\t\t\t++this.digits;\n\t\t\t\t}\n\t\t\t\tif (this.value < this.min) {\n\t\t\t\t\tthis.value = this.min;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this.value > this.max) {\n\t\t\t\t\tthis.value = this.max;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet range = this.max - this.min;\n\t\t\t\tlet style = this.elem.style;\n\t\t\t\tlet sp = this.src ? this.sprites : 100;\n\t\t\t\tif (sp >= 1) {\n\t\t\t\t\tlet offset = ((sp * (this.value - this.min) / range) | 0);\n\t\t\t\t\tstyle.backgroundPosition = \"0px \" + (-offset * this.kh) + \"px\";\n\t\t\t\t\tstyle.transform = 'rotate(0deg)';\n\t\t\t\t} else {\n\t\t\t\t\tlet deg = 270 * ((this.value - this.min) / range - 0.5);\n\t\t\t\t\tstyle.backgroundPosition = \"0px 0px\";\n\t\t\t\t\tstyle.transform = 'rotate(' + deg + 'deg)';\n\t\t\t\t}\n\t\t\t}\n\t\t\t_setValue(v) {\n\t\t\t\tif (this.step)\n\t\t\t\t\tv = (Math.round((v - this.min) / this.step)) * this.step + this.min;\n\t\t\t\tthis._value = Math.min(this.max, Math.max(this.min, v));\n\t\t\t\tif (this._value != this.oldvalue) {\n\t\t\t\t\tthis.oldvalue = this._value;\n\t\t\t\t\tif (this.conv)\n\t\t\t\t\t\tthis.convValue = eval(this.conv)(this._value);\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.convValue = this._value;\n\t\t\t\t\tthis.redraw();\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tsetValue(v, f) {\n\t\t\t\tif (this._setValue(v) && f)\n\t\t\t\t\tthis.sendEvent(\"input\"), this.sendEvent(\"change\");\n\t\t\t}\n\t\t\twheel(e) {\n\t\t\t\tlet delta = (this.max - this.min) * 0.01;\n\t\t\t\tdelta = e.deltaY > 0 ? -delta : delta;\n\t\t\t\tif (!e.shiftKey)\n\t\t\t\t\tdelta *= 5;\n\t\t\t\tif (Math.abs(delta) < this.step)\n\t\t\t\t\tdelta = (delta > 0) ? +this.step : -this.step;\n\t\t\t\tthis.setValue(+this.value + delta, true);\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t\tpointerdown(ev) {\n\t\t\t\tif (!this.enable)\n\t\t\t\t\treturn;\n\t\t\t\tlet e = ev;\n\t\t\t\tif (ev.touches) {\n\t\t\t\t\te = ev.changedTouches[0];\n\t\t\t\t\tthis.identifier = e.identifier;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (e.buttons != 1 && e.button != 0)\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.elem.focus();\n\t\t\t\tthis.drag = 1;\n\t\t\t\tthis.showtip(0);\n\t\t\t\tlet pointermove = (ev) => {\n\t\t\t\t\tlet e = ev;\n\t\t\t\t\tif (ev.touches) {\n\t\t\t\t\t\tfor (let i = 0; i < ev.touches.length; ++i) {\n\t\t\t\t\t\t\tif (ev.touches[i].identifier == this.identifier) {\n\t\t\t\t\t\t\t\te = ev.touches[i];\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (this.lastShift !== e.shiftKey) {\n\t\t\t\t\t\tthis.lastShift = e.shiftKey;\n\t\t\t\t\t\tthis.startPosX = e.pageX;\n\t\t\t\t\t\tthis.startPosY = e.pageY;\n\t\t\t\t\t\tthis.startVal = this.value;\n\t\t\t\t\t}\n\t\t\t\t\tlet offset = (this.startPosY - e.pageY - this.startPosX + e.pageX) * this.sensitivity;\n\t\t\t\t\tthis._setValue(this.min + ((((this.startVal + (this.max - this.min) * offset / ((e.shiftKey ? 4 : 1) * 128)) - this.min) / this.step) | 0) * this.step);\n\t\t\t\t\tthis.sendEvent(\"input\");\n\t\t\t\t\tif (e.preventDefault)\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\tif (e.stopPropagation)\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tlet pointerup = (ev) => {\n\t\t\t\t\tlet e = ev;\n\t\t\t\t\tif (ev.touches) {\n\t\t\t\t\t\tfor (let i = 0; ;) {\n\t\t\t\t\t\t\tif (ev.changedTouches[i].identifier == this.identifier) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (++i >= ev.changedTouches.length)\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.drag = 0;\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\tthis.startPosX = this.startPosY = null;\n\t\t\t\t\twindow.removeEventListener('mousemove', pointermove);\n\t\t\t\t\twindow.removeEventListener('touchmove', pointermove, { passive: false });\n\t\t\t\t\twindow.removeEventListener('mouseup', pointerup);\n\t\t\t\t\twindow.removeEventListener('touchend', pointerup);\n\t\t\t\t\twindow.removeEventListener('touchcancel', pointerup);\n\t\t\t\t\tdocument.body.removeEventListener('touchstart', preventScroll, { passive: false });\n\t\t\t\t\tthis.sendEvent(\"change\");\n\t\t\t\t}\n\t\t\t\tlet preventScroll = (e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t\tif (e.ctrlKey || e.metaKey)\n\t\t\t\t\tthis.setValue(this.defvalue, true);\n\t\t\t\telse {\n\t\t\t\t\tthis.startPosX = e.pageX;\n\t\t\t\t\tthis.startPosY = e.pageY;\n\t\t\t\t\tthis.startVal = this.value;\n\t\t\t\t\twindow.addEventListener('mousemove', pointermove);\n\t\t\t\t\twindow.addEventListener('touchmove', pointermove, { passive: false });\n\t\t\t\t}\n\t\t\t\twindow.addEventListener('mouseup', pointerup);\n\t\t\t\twindow.addEventListener('touchend', pointerup);\n\t\t\t\twindow.addEventListener('touchcancel', pointerup);\n\t\t\t\tdocument.body.addEventListener('touchstart', preventScroll, { passive: false });\n\t\t\t\tev.preventDefault();\n\t\t\t\tev.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t} catch (error) {\n\t\t//console.log(\"webaudio-knob already defined\");\n\t}\n\n\ttry {\n\t\tcustomElements.define(\"webaudio-slider\", class WebAudioSlider extends WebAudioControlsWidget {\n\t\t\tconstructor() {\n\t\t\t\tsuper();\n\t\t\t}\n\t\t\tget src() { return this._src; }\n\t\t\tset src(v) { this._src = v; this.setupImage(); }\n\t\t\tget knobsrc() { return this._knobsrc; }\n\t\t\tset knobsrc(v) { this._knobsrc = v; this.setupImage(); }\n\t\t\tget value() { return this._value; }\n\t\t\tset value(v) { this._value = +v; this.redraw(); }\n\t\t\tget min() { return this._min; }\n\t\t\tset min(v) { this._min = +v; this.redraw(); }\n\t\t\tget max() { return this._max; }\n\t\t\tset max(v) { this._max = +v; this.redraw(); }\n\t\t\tget step() { return this._step; }\n\t\t\tset step(v) { this._step = +v; this.redraw(); }\n\t\t\tget sprites() { return this._sprites; }\n\t\t\tset sprites(v) { this._sprites = +v; this.setupImage(); }\n\t\t\tget direction() { return this._direction; }\n\t\t\tset direction(v) { this._direction = +v; this.setupImage(); }\n\t\t\tget width() { return this._width; }\n\t\t\tset width(v) { this._width = +v; this.setupImage(); }\n\t\t\tget height() { return this._height; }\n\t\t\tset height(v) { this._height = +v; this.setupImage(); }\n\t\t\tget knobwidth() { return this._knobwidth; }\n\t\t\tset knobwidth(v) { this._knobwidth = +v; this.setupImage(); }\n\t\t\tget knobheight() { return this._knobheight; }\n\t\t\tset knobheight(v) { this._knobheight = +v; this.setupImage(); }\n\t\t\tget ditchlength() { return this._ditchlength; }\n\t\t\tset ditchlength(v) { this._ditchlength = +v; this.setupImage(); }\n\t\t\tget colors() { return this._colors; }\n\t\t\tset colors(v) { this._colors = v; this.setupImage(); }\n\n\t\t\tconnectedCallback() {\n\t\t\t\tlet root;\n\t\t\t\t//      if(this.attachShadow)\n\t\t\t\t//        root=this.attachShadow({mode: 'open'});\n\t\t\t\t//      else\n\t\t\t\troot = this;\n\t\t\t\troot.innerHTML =\n\t\t\t\t\t`<style>\n${this.basestyle}\nwebaudio-slider{\n  display:inline-block;\n  position:relative;\n  margin:0;\n  padding:0;\n  font-family: sans-serif;\n  font-size: 11px;\n  cursor:pointer;\n}\n.webaudio-slider-body{\n  display:inline-block;\n  position:relative;\n  margin:0;\n  padding:0;\n}\n.webaudio-slider-knob{\n  display:inline-block;\n  position:absolute;\n  margin:0;\n  padding:0;\n}\n</style>\n<div class='webaudio-slider-body' tabindex='1' touch-action='none'><div class='webaudio-slider-knob' touch-action='none'></div></div><div class='webaudioctrl-tooltip'></div>\n`;\n\t\t\t\tthis.elem = root.childNodes[2];\n\t\t\t\tthis.knob = this.elem.childNodes[0];\n\t\t\t\tthis.ttframe = root.childNodes[3];\n\t\t\t\tthis.enable = this.getAttr(\"enable\", 1);\n\t\t\t\tthis._src = this.getAttr(\"src\", opt.sliderSrc);\n\t\t\t\tthis._knobsrc = this.getAttr(\"knobsrc\", opt.sliderKnobsrc);\n\t\t\t\tthis._value = this.getAttr(\"value\", 0);\n\t\t\t\tthis.defvalue = this.getAttr(\"defvalue\", 0);\n\t\t\t\tthis._min = this.getAttr(\"min\", 0);\n\t\t\t\tthis._max = this.getAttr(\"max\", 100);\n\t\t\t\tthis._step = this.getAttr(\"step\", 1);\n\t\t\t\tthis._sprites = this.getAttr(\"sprites\", 0);\n\t\t\t\tthis._direction = this.getAttr(\"direction\", null);\n\t\t\t\tthis._width = this.getAttr(\"width\", opt.sliderWidth);\n\t\t\t\tthis._height = this.getAttr(\"height\", opt.sliderHeight);\n\t\t\t\tif (this._direction == \"horz\") {\n\t\t\t\t\tif (this._width == 0) this._width = 128;\n\t\t\t\t\tif (this._height == 0) this._height = 24;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (this._width == 0) this._width = 24;\n\t\t\t\t\tif (this._height == 0) this._height = 128;\n\t\t\t\t}\n\t\t\t\tthis._knobwidth = this.getAttr(\"knobwidth\", opt.sliderKnobwidth);\n\t\t\t\tthis._knobheight = this.getAttr(\"knbheight\", opt.sliderKnobheight);\n\t\t\t\tthis._ditchlength = this.getAttr(\"ditchlength\", opt.sliderDitchlength);\n\t\t\t\tthis._colors = this.getAttr(\"colors\", opt.sliderColors);\n\t\t\t\tthis.outline = this.getAttr(\"outline\", opt.outline);\n\t\t\t\tthis.sensitivity = this.getAttr(\"sensitivity\", 1);\n\t\t\t\tthis.valuetip = this.getAttr(\"valuetip\", 1);\n\t\t\t\tthis.tooltip = this.getAttr(\"tooltip\", null);\n\t\t\t\tthis.conv = this.getAttr(\"conv\", null);\n\t\t\t\tif (this.conv)\n\t\t\t\t\tthis.convValue = eval(this.conv)(this._value);\n\t\t\t\telse\n\t\t\t\t\tthis.convValue = this._value;\n\t\t\t\tthis.midilearn = this.getAttr(\"midilearn\", opt.midilearn);\n\t\t\t\tthis.midicc = this.getAttr(\"midicc\", null);\n\t\t\t\tthis.midiController = {};\n\t\t\t\tthis.midiMode = \"normal\";\n\t\t\t\tif (this.midicc) {\n\t\t\t\t\tlet ch = parseInt(this.midicc.substring(0, this.midicc.lastIndexOf(\".\"))) - 1;\n\t\t\t\t\tlet cc = parseInt(this.midicc.substring(this.midicc.lastIndexOf(\".\") + 1));\n\t\t\t\t\tthis.setMidiController(ch, cc);\n\t\t\t\t}\n\t\t\t\tthis.setupImage();\n\t\t\t\tthis.digits = 0;\n\t\t\t\tif (window.webAudioControlsMidiManager)\n\t\t\t\t\t//        window.webAudioControlsMidiManager.updateWidgets();\n\t\t\t\t\twindow.webAudioControlsMidiManager.addWidget(this);\n\t\t\t\tthis.elem.onclick = (e) => { e.stopPropagation() };\n\t\t\t}\n\t\t\tdisconnectedCallback() { }\n\t\t\tsetupImage() {\n\t\t\t\tthis.coltab = this.colors.split(\";\");\n\t\t\t\tthis.dr = this.direction;\n\t\t\t\tthis.dlen = this.ditchlength;\n\t\t\t\tif (!this.width) {\n\t\t\t\t\tif (this.dr == \"horz\")\n\t\t\t\t\t\tthis.width = 128;\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.width = 24;\n\t\t\t\t}\n\t\t\t\tif (!this.height) {\n\t\t\t\t\tif (this.dr == \"horz\")\n\t\t\t\t\t\tthis.height = 24;\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.height = 128;\n\t\t\t\t}\n\t\t\t\tif (!this.dr)\n\t\t\t\t\tthis.dr = (this.width <= this.height) ? \"vert\" : \"horz\";\n\t\t\t\tif (this.dr == \"vert\") {\n\t\t\t\t\tif (!this.dlen)\n\t\t\t\t\t\tthis.dlen = this.height - this.width;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (!this.dlen)\n\t\t\t\t\t\tthis.dlen = this.width - this.height;\n\t\t\t\t}\n\t\t\t\tthis.knob.style.backgroundSize = \"100% 100%\";\n\t\t\t\tthis.elem.style.backgroundSize = \"100% 100%\";\n\t\t\t\tthis.elem.style.width = this.width + \"px\";\n\t\t\t\tthis.elem.style.height = this.height + \"px\";\n\t\t\t\tthis.kwidth = this.knobwidth || (this.dr == \"horz\" ? this.height : this.width);\n\t\t\t\tthis.kheight = this.knobheight || (this.dr == \"horz\" ? this.height : this.width);\n\t\t\t\tthis.knob.style.width = this.kwidth + \"px\";\n\t\t\t\tthis.knob.style.height = this.kheight + \"px\";\n\t\t\t\tif (!this.src) {\n\t\t\t\t\tlet r = Math.min(this.width, this.height) * 0.5;\n\t\t\t\t\tlet svgbody =\n\t\t\t\t\t\t`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${this.width}\" height=\"${this.height}\" preserveAspectRatio=\"none\">\n<rect x=\"1\" y=\"1\" rx=\"${r}\" ry=\"${r}\" width=\"${this.width - 2}\" height=\"${this.height - 2}\" fill=\"${this.coltab[1]}\"/></svg>`;\n\t\t\t\t\tthis.elem.style.backgroundImage = \"url(data:image/svg+xml;base64,\" + btoa(svgbody) + \")\";\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.elem.style.backgroundImage = \"url(\" + (this.src) + \")\";\n\t\t\t\t}\n\t\t\t\tif (!this.knobsrc) {\n\t\t\t\t\tlet svgthumb =\n\t\t\t\t\t\t`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${this.kwidth}\" height=\"${this.kheight}\" preserveAspectRatio=\"none\">\n<radialGradient id=\"gr\" cx=\"30%\" cy=\"30%\"><stop offset=\"0%\" stop-color=\"${this.coltab[2]}\"/><stop offset=\"100%\" stop-color=\"${this.coltab[0]}\"/></radialGradient>\n<rect x=\"2\" y=\"2\" width=\"${this.kwidth - 4}\" height=\"${this.kheight - 4}\" rx=\"${this.kwidth * 0.5}\" ry=\"${this.kheight * 0.5}\" fill=\"url(#gr)\"/></svg>`;\n\t\t\t\t\tthis.knob.style.backgroundImage = \"url(data:image/svg+xml;base64,\" + btoa(svgthumb) + \")\";\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.knob.style.backgroundImage = \"url(\" + (this.knobsrc) + \")\";\n\t\t\t\t}\n\t\t\t\tthis.elem.style.outline = this.outline ? \"\" : \"none\";\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t\tredraw() {\n\t\t\t\tif (!this.isConnected) return;\n\t\t\t\tthis.digits = 0;\n\t\t\t\tif (this.step && this.step < 1) {\n\t\t\t\t\tfor (let n = this.step; n < 1; n *= 10)\n\t\t\t\t\t\t++this.digits;\n\t\t\t\t}\n\t\t\t\tif (this.value < this.min) {\n\t\t\t\t\tthis.value = this.min;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this.value > this.max) {\n\t\t\t\t\tthis.value = this.max;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet range = this.max - this.min;\n\t\t\t\tlet style = this.knob.style;\n\t\t\t\tif (this.dr == \"vert\") {\n\t\t\t\t\tstyle.left = (this.width - this.kwidth) * 0.5 + \"px\";\n\t\t\t\t\tstyle.top = (1 - (this.value - this.min) / range) * this.dlen + \"px\";\n\t\t\t\t\tthis.sensex = 0; this.sensey = 1;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tstyle.top = (this.height - this.kheight) * 0.5 + \"px\";\n\t\t\t\t\tstyle.left = (this.value - this.min) / range * this.dlen + \"px\";\n\t\t\t\t\tthis.sensex = 1; this.sensey = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\t_setValue(v) {\n\t\t\t\tv = (Math.round((v - this.min) / this.step)) * this.step + this.min;\n\t\t\t\tthis._value = Math.min(this.max, Math.max(this.min, v));\n\t\t\t\tif (this._value != this.oldvalue) {\n\t\t\t\t\tthis.oldvalue = this._value;\n\t\t\t\t\tif (this.conv)\n\t\t\t\t\t\tthis.convValue = eval(this.conv)(this._value);\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.convValue = this._value;\n\t\t\t\t\tthis.redraw();\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tsetValue(v, f) {\n\t\t\t\tif (this._setValue(v) && f)\n\t\t\t\t\tthis.sendEvent(\"input\"), this.sendEvent(\"change\");\n\t\t\t}\n\t\t\twheel(e) {\n\t\t\t\tlet delta = (this.max - this.min) * 0.01;\n\t\t\t\tdelta = e.deltaY > 0 ? -delta : delta;\n\t\t\t\tif (!e.shiftKey)\n\t\t\t\t\tdelta *= 5;\n\t\t\t\tif (Math.abs(delta) < this.step)\n\t\t\t\t\tdelta = (delta > 0) ? +this.step : -this.step;\n\t\t\t\tthis.setValue(+this.value + delta, true);\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t\tpointerdown(ev) {\n\t\t\t\tif (!this.enable)\n\t\t\t\t\treturn;\n\t\t\t\tlet e = ev;\n\t\t\t\tif (ev.touches) {\n\t\t\t\t\te = ev.changedTouches[0];\n\t\t\t\t\tthis.identifier = e.identifier;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (e.buttons != 1 && e.button != 0)\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.elem.focus();\n\t\t\t\tthis.drag = 1;\n\t\t\t\tthis.showtip(0);\n\t\t\t\tlet pointermove = (ev) => {\n\t\t\t\t\tlet e = ev;\n\t\t\t\t\tif (ev.touches) {\n\t\t\t\t\t\tfor (let i = 0; i < ev.touches.length; ++i) {\n\t\t\t\t\t\t\tif (ev.touches[i].identifier == this.identifier) {\n\t\t\t\t\t\t\t\te = ev.touches[i];\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (this.lastShift !== e.shiftKey) {\n\t\t\t\t\t\tthis.lastShift = e.shiftKey;\n\t\t\t\t\t\tthis.startPosX = e.pageX;\n\t\t\t\t\t\tthis.startPosY = e.pageY;\n\t\t\t\t\t\tthis.startVal = this.value;\n\t\t\t\t\t}\n\t\t\t\t\tlet offset = ((this.startPosY - e.pageY) * this.sensey - (this.startPosX - e.pageX) * this.sensex) * this.sensitivity;\n\t\t\t\t\tthis._setValue(this.min + ((((this.startVal + (this.max - this.min) * offset / ((e.shiftKey ? 4 : 1) * this.dlen)) - this.min) / this.step) | 0) * this.step);\n\t\t\t\t\tthis.sendEvent(\"input\");\n\t\t\t\t\tif (e.preventDefault)\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\tif (e.stopPropagation)\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tlet pointerup = (ev) => {\n\t\t\t\t\tlet e = ev;\n\t\t\t\t\tif (ev.touches) {\n\t\t\t\t\t\tfor (let i = 0; ;) {\n\t\t\t\t\t\t\tif (ev.changedTouches[i].identifier == this.identifier) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (++i >= ev.changedTouches.length)\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.drag = 0;\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\tthis.startPosX = this.startPosY = null;\n\t\t\t\t\twindow.removeEventListener('mousemove', pointermove);\n\t\t\t\t\twindow.removeEventListener('touchmove', pointermove, { passive: false });\n\t\t\t\t\twindow.removeEventListener('mouseup', pointerup);\n\t\t\t\t\twindow.removeEventListener('touchend', pointerup);\n\t\t\t\t\twindow.removeEventListener('touchcancel', pointerup);\n\t\t\t\t\tdocument.body.removeEventListener('touchstart', preventScroll, { passive: false });\n\t\t\t\t\tthis.sendEvent(\"change\");\n\t\t\t\t}\n\t\t\t\tlet preventScroll = (e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t\tif (e.touches)\n\t\t\t\t\te = e.touches[0];\n\t\t\t\tif (e.ctrlKey || e.metaKey)\n\t\t\t\t\tthis.setValue(this.defvalue, true);\n\t\t\t\telse {\n\t\t\t\t\tthis.startPosX = e.pageX;\n\t\t\t\t\tthis.startPosY = e.pageY;\n\t\t\t\t\tthis.startVal = this.value;\n\t\t\t\t\twindow.addEventListener('mousemove', pointermove);\n\t\t\t\t\twindow.addEventListener('touchmove', pointermove, { passive: false });\n\t\t\t\t}\n\t\t\t\twindow.addEventListener('mouseup', pointerup);\n\t\t\t\twindow.addEventListener('touchend', pointerup);\n\t\t\t\twindow.addEventListener('touchcancel', pointerup);\n\t\t\t\tdocument.body.addEventListener('touchstart', preventScroll, { passive: false });\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t} catch (error) {\n\t\t//console.log(\"webaudio-slider already defined\");\n\t}\n\n\ttry {\n\t\tcustomElements.define(\"webaudio-switch\", class WebAudioSwitch extends WebAudioControlsWidget {\n\t\t\tconstructor() {\n\t\t\t\tsuper();\n\t\t\t}\n\t\t\tget src() { return this._src; }\n\t\t\tset src(v) { this._src = v; this.setupImage(); }\n\t\t\tget value() { return this._value; }\n\t\t\tset value(v) { this._value = +v; this.redraw(); }\n\t\t\tget width() { return this._width; }\n\t\t\tset width(v) { this._width = +v; this.setupImage(); }\n\t\t\tget height() { return this._height; }\n\t\t\tset height(v) { this._height = +v; this.setupImage(); }\n\t\t\tget diameter() { return this._diameter; }\n\t\t\tset diameter(v) { this._diameter = +v; this.setupImage(); }\n\t\t\tget colors() { return this._colors; }\n\t\t\tset colors(v) { this._colors = v; this.setupImage(); }\n\n\t\t\tconnectedCallback() {\n\t\t\t\tlet root;\n\t\t\t\t//      if(this.attachShadow)\n\t\t\t\t//        root=this.attachShadow({mode: 'open'});\n\t\t\t\t//      else\n\t\t\t\troot = this;\n\t\t\t\troot.innerHTML =\n\t\t\t\t\t`<style>\n${this.basestyle}\nwebaudio-switch{\n  display:inline-block;\n  margin:0;\n  padding:0;\n  font-family: sans-serif;\n  font-size: 11px;\n  cursor:pointer;\n}\n.webaudio-switch-body{\n  display:inline-block;\n  margin:0;\n  padding:0;\n}\n</style>\n<div class='webaudio-switch-body' tabindex='1' touch-action='none'><div class='webaudioctrl-tooltip'></div></div>\n`;\n\t\t\t\tthis.elem = root.childNodes[2];\n\t\t\t\tthis.ttframe = this.elem.childNodes[0];\n\n\t\t\t\tthis.enable = this.getAttr(\"enable\", 1);\n\t\t\t\tthis._src = this.getAttr(\"src\", null);\n\t\t\t\tthis._value = this.getAttr(\"value\", 0);\n\t\t\t\tthis.defvalue = this.getAttr(\"defvalue\", 0);\n\t\t\t\tthis.type = this.getAttr(\"type\", \"toggle\");\n\t\t\t\tthis.group = this.getAttr(\"group\", \"\");\n\t\t\t\tthis._width = this.getAttr(\"width\", 0);\n\t\t\t\tthis._height = this.getAttr(\"height\", 0);\n\t\t\t\tthis._diameter = this.getAttr(\"diameter\", 0);\n\t\t\t\tthis.invert = this.getAttr(\"invert\", 0);\n\t\t\t\tthis._colors = this.getAttr(\"colors\", opt.switchColors);\n\t\t\t\tthis.outline = this.getAttr(\"outline\", opt.outline);\n\t\t\t\tthis.valuetip = 0;\n\t\t\t\tthis.tooltip = this.getAttr(\"tooltip\", null);\n\t\t\t\tthis.midilearn = this.getAttr(\"midilearn\", opt.midilearn);\n\t\t\t\tthis.midicc = this.getAttr(\"midicc\", null);\n\t\t\t\tthis.midiController = {};\n\t\t\t\tthis.midiMode = \"normal\";\n\t\t\t\tif (this.midicc) {\n\t\t\t\t\tlet ch = parseInt(this.midicc.substring(0, this.midicc.lastIndexOf(\".\"))) - 1;\n\t\t\t\t\tlet cc = parseInt(this.midicc.substring(this.midicc.lastIndexOf(\".\") + 1));\n\t\t\t\t\tthis.setMidiController(ch, cc);\n\t\t\t\t}\n\t\t\t\tthis.setupImage();\n\t\t\t\tthis.digits = 0;\n\t\t\t\tif (window.webAudioControlsMidiManager)\n\t\t\t\t\t//        window.webAudioControlsMidiManager.updateWidgets();\n\t\t\t\t\twindow.webAudioControlsMidiManager.addWidget(this);\n\t\t\t\tthis.elem.onclick = (e) => { e.stopPropagation() };\n\t\t\t}\n\t\t\tdisconnectedCallback() { }\n\t\t\tsetupImage() {\n\t\t\t\tlet w = this.width || this.diameter || opt.switchWidth || opt.switchDiameter;\n\t\t\t\tlet h = this.height || this.diameter || opt.switchHeight || opt.switchDiameter;\n\t\t\t\tif (!this.src) {\n\t\t\t\t\tthis.coltab = this.colors.split(\";\");\n\t\t\t\t\tlet mm = Math.min(w, h);\n\t\t\t\t\tlet svg =\n\t\t\t\t\t\t`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${w}\" height=\"${h * 2}\" preserveAspectRatio=\"none\">\n<radialGradient id=\"gr\" cx=\"30%\" cy=\"30%\"><stop offset=\"0%\" stop-color=\"${this.coltab[2]}\"/><stop offset=\"100%\" stop-color=\"${this.coltab[0]}\"/></radialGradient>\n<rect x=\"${w * 0.05}\" y=\"${h * 0.05}\" width=\"${w * 0.9}\" height=\"${h * 0.9}\" rx=\"${mm * 0.1}\" ry=\"${mm * 0.1}\" fill=\"${this.coltab[1]}\"/>\n<rect x=\"${w * 0.05}\" y=\"${h * 1.05}\" width=\"${w * 0.9}\" height=\"${h * 0.9}\" rx=\"${mm * 0.1}\" ry=\"${mm * 0.1}\" fill=\"${this.coltab[1]}\"/>\n<circle cx=\"${w * 0.5}\" cy=\"${h * 0.5}\" r=\"${mm * 0.3}\" stroke=\"${this.coltab[0]}\" stroke-width=\"2\"/>\n<circle cx=\"${w * 0.5}\" cy=\"${h * 1.5}\" r=\"${mm * 0.3}\" stroke=\"${this.coltab[0]}\" stroke-width=\"2\" fill=\"url(#gr)\"/></svg>`;\n\t\t\t\t\tthis.elem.style.backgroundImage = \"url(data:image/svg+xml;base64,\" + btoa(svg) + \")\";\n\t\t\t\t\tthis.elem.style.backgroundSize = \"100% 200%\";\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.elem.style.backgroundImage = \"url(\" + (this.src) + \")\";\n\t\t\t\t\tif (!this.sprites)\n\t\t\t\t\t\tthis.elem.style.backgroundSize = \"100% 200%\";\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.elem.style.backgroundSize = `100% ${(this.sprites + 1) * 100}%`;\n\t\t\t\t}\n\t\t\t\tthis.elem.style.width = w + \"px\";\n\t\t\t\tthis.elem.style.height = h + \"px\";\n\t\t\t\tthis.elem.style.outline = this.outline ? \"\" : \"none\";\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t\tredraw() {\n\t\t\t\tif (!this.isConnected) return;\n\t\t\t\tlet style = this.elem.style;\n\t\t\t\tif (this.value ^ this.invert)\n\t\t\t\t\tstyle.backgroundPosition = \"0px -100%\";\n\t\t\t\telse\n\t\t\t\t\tstyle.backgroundPosition = \"0px 0px\";\n\t\t\t}\n\t\t\tsetValue(v, f) {\n\t\t\t\tconsole.log(v, f)\n\t\t\t\tthis.value = v;\n\t\t\t\tthis.checked = (!!v);\n\t\t\t\tif (this.value != this.oldvalue) {\n\t\t\t\t\tthis.redraw();\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\tif (f) {\n\t\t\t\t\t\tthis.sendEvent(\"input\");\n\t\t\t\t\t\tthis.sendEvent(\"change\");\n\t\t\t\t\t}\n\t\t\t\t\tthis.oldvalue = this.value;\n\t\t\t\t}\n\t\t\t}\n\t\t\tpointerdown(ev) {\n\t\t\t\tif (!this.enable)\n\t\t\t\t\treturn;\n\t\t\t\tlet e = ev;\n\t\t\t\tif (ev.touches) {\n\t\t\t\t\te = ev.changedTouches[0];\n\t\t\t\t\tthis.identifier = e.identifier;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (e.buttons != 1 && e.button != 0)\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.elem.focus();\n\t\t\t\tthis.drag = 1;\n\t\t\t\tthis.showtip(0);\n\t\t\t\tlet pointermove = (e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tlet pointerup = (e) => {\n\t\t\t\t\tthis.drag = 0;\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\twindow.removeEventListener('mousemove', pointermove);\n\t\t\t\t\twindow.removeEventListener('touchmove', pointermove, { passive: false });\n\t\t\t\t\twindow.removeEventListener('mouseup', pointerup);\n\t\t\t\t\twindow.removeEventListener('touchend', pointerup);\n\t\t\t\t\twindow.removeEventListener('touchcancel', pointerup);\n\t\t\t\t\tdocument.body.removeEventListener('touchstart', preventScroll, { passive: false });\n\t\t\t\t\tif (this.type == \"kick\") {\n\t\t\t\t\t\tthis.value = 0;\n\t\t\t\t\t\tthis.checked = false;\n\t\t\t\t\t\tthis.redraw();\n\t\t\t\t\t\tthis.sendEvent(\"change\");\n\t\t\t\t\t}\n\t\t\t\t\tthis.sendEvent(\"click\");\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t\tlet preventScroll = (e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t\tswitch (this.type) {\n\t\t\t\t\tcase \"kick\":\n\t\t\t\t\t\tthis.setValue(1);\n\t\t\t\t\t\tthis.sendEvent(\"change\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"toggle\":\n\t\t\t\t\t\tif (e.ctrlKey || e.metaKey)\n\t\t\t\t\t\t\tthis.value = defvalue;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthis.value = 1 - this.value;\n\t\t\t\t\t\tthis.checked = !!this.value;\n\t\t\t\t\t\tthis.sendEvent(\"change\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"radio\":\n\t\t\t\t\t\tlet els = document.querySelectorAll(\"webaudio-switch[type='radio'][group='\" + this.group + \"']\");\n\t\t\t\t\t\tfor (let i = 0; i < els.length; ++i) {\n\t\t\t\t\t\t\tif (els[i] == this)\n\t\t\t\t\t\t\t\tels[i].setValue(1);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tels[i].setValue(0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.sendEvent(\"change\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\twindow.addEventListener('mouseup', pointerup);\n\t\t\t\twindow.addEventListener('touchend', pointerup);\n\t\t\t\twindow.addEventListener('touchcancel', pointerup);\n\t\t\t\tdocument.body.addEventListener('touchstart', preventScroll, { passive: false });\n\t\t\t\tthis.redraw();\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t} catch (error) {\n\t\t//console.log(\"webaudio-switch already defined\");\n\t}\n\n\ttry {\n\t\tcustomElements.define(\"webaudio-param\", class WebAudioParam extends WebAudioControlsWidget {\n\t\t\tconstructor() {\n\t\t\t\tsuper();\n\t\t\t\tthis.addEventListener(\"keydown\", this.keydown);\n\t\t\t\tthis.addEventListener(\"mousedown\", this.pointerdown, { passive: false });\n\t\t\t\tthis.addEventListener(\"touchstart\", this.pointerdown, { passive: false });\n\t\t\t\tthis.addEventListener(\"wheel\", this.wheel);\n\t\t\t\tthis.addEventListener(\"mouseover\", this.pointerover);\n\t\t\t\tthis.addEventListener(\"mouseout\", this.pointerout);\n\t\t\t\tthis.addEventListener(\"contextmenu\", this.contextMenu);\n\t\t\t}\n\t\t\tget src() { return this._src; }\n\t\t\tset src(v) { this._src = v; this.setupImage(); }\n\t\t\tget value() { return this._value; }\n\t\t\tset value(v) { this._value = +v; this.redraw(); }\n\t\t\tget fontsize() { return this._fontsize; }\n\t\t\tset fontsize(v) { this._fontsize = +v; this.setupImage(); }\n\t\t\tget width() { return this._width; }\n\t\t\tset width(v) { this._width = +v; this.setupImage(); }\n\t\t\tget height() { return this._height; }\n\t\t\tset height(v) { this._height = +v; this.setupImage(); }\n\t\t\tget colors() { return this._colors; }\n\t\t\tset colors(v) { this._colors = v; this.setupImage(); }\n\n\t\t\tconnectedCallback() {\n\t\t\t\tlet root;\n\t\t\t\t//      if(this.attachShadow)\n\t\t\t\t//        root=this.attachShadow({mode: 'open'});\n\t\t\t\t//      else\n\t\t\t\troot = this;\n\t\t\t\troot.innerHTML =\n\t\t\t\t\t`<style>\n${this.basestyle}\nwebaudio-param{\n  display:inline-block;\n  user-select:none;\n  margin:0;\n  padding:0;\n  font-family: sans-serif;\n  font-size: 8px;\n  cursor:pointer;\n}\n.webaudio-param-body{\n  display:inline-block;\n  text-align:center;\n  vertical-align:middle;\n  position:relative;\n  border:1px solid #888;\n  background:none;\n  border-radius:4px;\n  margin:0;\n  padding:0;\n  font-family:sans-serif;\n  font-size:11px;\n}\n</style>\n<input class='webaudio-param-body' value='0' tabindex='1' touch-action='none'/><div class='webaudioctrl-tooltip'></div>\n`;\n\t\t\t\tthis.elem = root.childNodes[2];\n\t\t\t\tthis.ttframe = root.childNodes[3];\n\t\t\t\tthis.enable = this.getAttr(\"enable\", 1);\n\t\t\t\tthis._value = this.getAttr(\"value\", 0);\n\t\t\t\tthis.defvalue = this.getAttr(\"defvalue\", 0);\n\t\t\t\tthis._fontsize = this.getAttr(\"fontsize\", 9);\n\t\t\t\tthis._src = this.getAttr(\"src\", null);\n\t\t\t\tthis.link = this.getAttr(\"link\", \"\");\n\t\t\t\tthis._width = this.getAttr(\"width\", 32);\n\t\t\t\tthis._height = this.getAttr(\"height\", 16);\n\t\t\t\tthis._colors = this.getAttr(\"colors\", \"#fff;#000\");\n\t\t\t\tthis.outline = this.getAttr(\"outline\", opt.outline);\n\t\t\t\tthis.midiController = {};\n\t\t\t\tthis.midiMode = \"normal\";\n\t\t\t\tif (this.midicc) {\n\t\t\t\t\tlet ch = parseInt(this.midicc.substring(0, this.midicc.lastIndexOf(\".\"))) - 1;\n\t\t\t\t\tlet cc = parseInt(this.midicc.substring(this.midicc.lastIndexOf(\".\") + 1));\n\t\t\t\t\tthis.setMidiController(ch, cc);\n\t\t\t\t}\n\t\t\t\tthis.setupImage();\n\t\t\t\tif (window.webAudioControlsMidiManager)\n\t\t\t\t\t//        window.webAudioControlsMidiManager.updateWidgets();\n\t\t\t\t\twindow.webAudioControlsMidiManager.addWidget(this);\n\t\t\t\tthis.fromLink = ((e) => {\n\t\t\t\t\tthis.setValue(e.target.convValue.toFixed(e.target.digits));\n\t\t\t\t}).bind(this);\n\t\t\t\tthis.elem.onchange = () => {\n\t\t\t\t\tlet le = document.getElementById(this.link);\n\t\t\t\t\tif (le)\n\t\t\t\t\t\tle.setValue(+this.elem.value);\n\t\t\t\t}\n\t\t\t}\n\t\t\tdisconnectedCallback() { }\n\t\t\tsetupImage() {\n\t\t\t\tthis.coltab = this.colors.split(\";\");\n\t\t\t\tthis.elem.style.color = this.coltab[0];\n\t\t\t\tif (!this.src) {\n\t\t\t\t\tthis.elem.style.backgroundColor = this.coltab[1];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.elem.style.backgroundImage = \"url(\" + (this.src) + \")\";\n\t\t\t\t\tthis.elem.style.backgroundSize = \"100% 100%\";\n\t\t\t\t}\n\t\t\t\tthis.elem.style.width = this.width + \"px\";\n\t\t\t\tthis.elem.style.height = this.height + \"px\";\n\t\t\t\tthis.elem.style.fontSize = this.fontsize + \"px\";\n\t\t\t\tthis.elem.style.outline = this.outline ? \"\" : \"none\";\n\t\t\t\tlet l = document.getElementById(this.link);\n\t\t\t\tif (l) {\n\t\t\t\t\tthis.setValue(l.value.toFixed(l.digits));\n\t\t\t\t\tl.addEventListener(\"input\", (e) => { this.setValue(l.value.toFixed(l.digits)) });\n\t\t\t\t}\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t\tredraw() {\n\t\t\t\tif (!this.isConnected) return;\n\t\t\t\tthis.elem.value = this.value;\n\t\t\t}\n\t\t\tsetValue(v, f) {\n\t\t\t\tthis.value = v;\n\t\t\t\tif (this.value != this.oldvalue) {\n\t\t\t\t\tthis.redraw();\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\tif (f) {\n\t\t\t\t\t\tlet event = document.createEvent(\"HTMLEvents\");\n\t\t\t\t\t\tevent.initEvent(\"change\", false, true);\n\t\t\t\t\t\tthis.dispatchEvent(event);\n\t\t\t\t\t}\n\t\t\t\t\tthis.oldvalue = this.value;\n\t\t\t\t}\n\t\t\t}\n\t\t\tpointerdown(ev) {\n\t\t\t\tif (!this.enable)\n\t\t\t\t\treturn;\n\t\t\t\tlet e = ev;\n\t\t\t\tif (ev.touches)\n\t\t\t\t\te = ev.touches[0];\n\t\t\t\telse {\n\t\t\t\t\tif (e.buttons != 1 && e.button != 0)\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.elem.focus();\n\t\t\t\tthis.drag = 1;\n\t\t\t\tthis.showtip(0);\n\t\t\t\tlet pointermove = (e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tlet pointerup = (e) => {\n\t\t\t\t\tthis.drag = 0;\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\twindow.removeEventListener('mouseup', pointerup);\n\t\t\t\t\twindow.removeEventListener('touchend', pointerup);\n\t\t\t\t\twindow.removeEventListener('touchcancel', pointerup);\n\t\t\t\t\tdocument.body.removeEventListener('touchstart', preventScroll, { passive: false });\n\t\t\t\t}\n\t\t\t\tlet preventScroll = (e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t\twindow.addEventListener('mouseup', pointerup);\n\t\t\t\twindow.addEventListener('touchend', pointerup);\n\t\t\t\twindow.addEventListener('touchcancel', pointerup);\n\t\t\t\tdocument.body.addEventListener('touchstart', preventScroll, { passive: false });\n\t\t\t\tthis.redraw();\n\t\t\t\tif (e.preventDefault)\n\t\t\t\t\te.preventDefault();\n\t\t\t\tif (e.stopPropagation)\n\t\t\t\t\te.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t} catch (error) {\n\t\t//console.log(\"webaudio-param already defined\");\n\t}\n\n\ttry {\n\t\tcustomElements.define(\"webaudio-keyboard\", class WebAudioKeyboard extends WebAudioControlsWidget {\n\t\t\tconstructor() {\n\t\t\t\tsuper();\n\t\t\t}\n\t\t\tget width() { return this._width; }\n\t\t\tset width(v) { this._width = v; this.setupImage(); }\n\t\t\tget height() { return this._height; }\n\t\t\tset height(v) { this._height = v; this.setupImage(); }\n\t\t\tget min() { return this._min; }\n\t\t\tset min(v) { this._min = +v; this.redraw(); }\n\t\t\tget step() { return this._step; }\n\t\t\tset step(v) { this._step = +v; this.redraw(); }\n\t\t\tget keys() { return this._keys; }\n\t\t\tset keys(v) { this._keys = +v; this.setupImage(); }\n\t\t\tget colors() { return this._colors; }\n\t\t\tset colors(v) { this._colors = v; this.setupImage(); }\n\n\t\t\tconnectedCallback() {\n\t\t\t\tlet root;\n\t\t\t\t//      if(this.attachShadow)\n\t\t\t\t//        root=this.attachShadow({mode: 'open'});\n\t\t\t\t//      else\n\t\t\t\troot = this;\n\t\t\t\troot.innerHTML =\n\t\t\t\t\t`<style>\n${this.basestyle}\nwebaudio-keyboard{\n  display:inline-block;\n  position:relative;\n  margin:0;\n  padding:0;\n  font-family: sans-serif;\n  font-size: 11px;\n}\n.webaudio-keyboard-body{\n  display:inline-block;\n  margin:0;\n  padding:0;\n}\n</style>\n<canvas class='webaudio-keyboard-body' tabindex='1' touch-action='none'></canvas><div class='webauioctrl-tooltip'></div>\n`;\n\t\t\t\tthis.cv = root.childNodes[2];\n\t\t\t\tthis.ttframe = root.childNodes[3];\n\t\t\t\tthis.ctx = this.cv.getContext(\"2d\");\n\t\t\t\tthis._values = [];\n\t\t\t\tthis.enable = this.getAttr(\"enable\", 1);\n\t\t\t\tthis._width = this.getAttr(\"width\", 480);\n\t\t\t\tthis._height = this.getAttr(\"height\", 128);\n\t\t\t\tthis._min = this.getAttr(\"min\", 0);\n\t\t\t\tthis._keys = this.getAttr(\"keys\", 25);\n\t\t\t\tthis._colors = this.getAttr(\"colors\", \"#222;#eee;#ccc;#333;#000;#e88;#c44;#c33;#800\");\n\t\t\t\tthis.outline = this.getAttr(\"outline\", opt.outline);\n\t\t\t\tthis.midilearn = this.getAttr(\"midilearn\", 0);\n\t\t\t\tthis.midicc = this.getAttr(\"midicc\", null);\n\t\t\t\tthis.press = 0;\n\t\t\t\tthis.keycodes1 = [90, 83, 88, 68, 67, 86, 71, 66, 72, 78, 74, 77, 188, 76, 190, 187, 191, 226];\n\t\t\t\tthis.keycodes2 = [81, 50, 87, 51, 69, 82, 53, 84, 54, 89, 55, 85, 73, 57, 79, 48, 80, 192, 222, 219];\n\t\t\t\tthis.addEventListener(\"keyup\", this.keyup);\n\t\t\t\tthis.midiController = {};\n\t\t\t\tthis.midiMode = \"normal\";\n\t\t\t\tif (this.midicc) {\n\t\t\t\t\tlet ch = parseInt(this.midicc.substring(0, this.midicc.lastIndexOf(\".\"))) - 1;\n\t\t\t\t\tlet cc = parseInt(this.midicc.substring(this.midicc.lastIndexOf(\".\") + 1));\n\t\t\t\t\tthis.setMidiController(ch, cc);\n\t\t\t\t}\n\t\t\t\tthis.setupImage();\n\t\t\t\tthis.digits = 0;\n\t\t\t\tthis.addEventListener(\"mousemove\", this.pointermove);\n\t\t\t\tthis.addEventListener(\"touchmove\", this.pointermove, { passive: false });\n\t\t\t\tthis.addEventListener(\"mouseup\", this.pointerup);\n\t\t\t\tthis.addEventListener(\"touchend\", this.pointerup);\n\t\t\t\tthis.addEventListener(\"touchcancel\", this.pointerup);\n\t\t\t\tif (window.webAudioControlsMidiManager)\n\t\t\t\t\t//        window.webAudioControlsMidiManager.updateWidgets();\n\t\t\t\t\twindow.webAudioControlsMidiManager.addWidget(this);\n\t\t\t}\n\t\t\tdisconnectedCallback() { }\n\t\t\tsetupImage() {\n\t\t\t\tthis.cv.style.width = this.width + \"px\";\n\t\t\t\tthis.cv.style.height = this.height + \"px\";\n\t\t\t\tthis.bheight = this.height * 0.55;\n\t\t\t\tthis.kp = [0, 7 / 12, 1, 3 * 7 / 12, 2, 3, 6 * 7 / 12, 4, 8 * 7 / 12, 5, 10 * 7 / 12, 6];\n\t\t\t\tthis.kf = [0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0];\n\t\t\t\tthis.ko = [0, 0, (7 * 2) / 12 - 1, 0, (7 * 4) / 12 - 2, (7 * 5) / 12 - 3, 0, (7 * 7) / 12 - 4, 0, (7 * 9) / 12 - 5, 0, (7 * 11) / 12 - 6];\n\t\t\t\tthis.kn = [0, 2, 4, 5, 7, 9, 11];\n\t\t\t\tthis.coltab = this.colors.split(\";\");\n\t\t\t\tthis.cv.width = this.width;\n\t\t\t\tthis.cv.height = this.height;\n\t\t\t\tthis.cv.style.width = this.width + 'px';\n\t\t\t\tthis.cv.style.height = this.height + 'px';\n\t\t\t\tthis.cv.style.outline = this.outline ? \"\" : \"none\";\n\t\t\t\tthis.bheight = this.height * 0.55;\n\t\t\t\tthis.max = this.min + this.keys - 1;\n\t\t\t\tthis.dispvalues = [];\n\t\t\t\tthis.valuesold = [];\n\t\t\t\tif (this.kf[this.min % 12])\n\t\t\t\t\t--this.min;\n\t\t\t\tif (this.kf[this.max % 12])\n\t\t\t\t\t++this.max;\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t\tredraw() {\n\t\t\t\tif (!this.isConnected) return;\n\t\t\t\tfunction rrect(ctx, x, y, w, h, r, c1, c2) {\n\t\t\t\t\tif (c2) {\n\t\t\t\t\t\tlet g = ctx.createLinearGradient(x, y, x + w, y);\n\t\t\t\t\t\tg.addColorStop(0, c1);\n\t\t\t\t\t\tg.addColorStop(1, c2);\n\t\t\t\t\t\tctx.fillStyle = g;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tctx.fillStyle = c1;\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.moveTo(x, y);\n\t\t\t\t\tctx.lineTo(x + w, y);\n\t\t\t\t\tctx.lineTo(x + w, y + h - r);\n\t\t\t\t\tctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);\n\t\t\t\t\tctx.lineTo(x + r, y + h);\n\t\t\t\t\tctx.quadraticCurveTo(x, y + h, x, y + h - r);\n\t\t\t\t\tctx.lineTo(x, y);\n\t\t\t\t\tctx.fill();\n\t\t\t\t}\n\t\t\t\tthis.ctx.fillStyle = this.coltab[0];\n\t\t\t\tthis.ctx.fillRect(0, 0, this.width, this.height);\n\t\t\t\tlet x0 = 7 * ((this.min / 12) | 0) + this.kp[this.min % 12];\n\t\t\t\tlet x1 = 7 * ((this.max / 12) | 0) + this.kp[this.max % 12];\n\t\t\t\tlet n = x1 - x0;\n\t\t\t\tthis.wwidth = (this.width - 1) / (n + 1);\n\t\t\t\tthis.bwidth = this.wwidth * 7 / 12;\n\t\t\t\tlet h2 = this.bheight;\n\t\t\t\tlet r = Math.min(8, this.wwidth * 0.2);\n\t\t\t\tfor (let i = this.min, j = 0; i <= this.max; ++i) {\n\t\t\t\t\tif (this.kf[i % 12] == 0) {\n\t\t\t\t\t\tlet x = this.wwidth * (j++) + 1;\n\t\t\t\t\t\tif (this.dispvalues.indexOf(i) >= 0)\n\t\t\t\t\t\t\trrect(this.ctx, x, 1, this.wwidth - 1, this.height - 2, r, this.coltab[5], this.coltab[6]);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\trrect(this.ctx, x, 1, this.wwidth - 1, this.height - 2, r, this.coltab[1], this.coltab[2]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tr = Math.min(8, this.bwidth * 0.3);\n\t\t\t\tfor (let i = this.min; i < this.max; ++i) {\n\t\t\t\t\tif (this.kf[i % 12]) {\n\t\t\t\t\t\tlet x = this.wwidth * this.ko[this.min % 12] + this.bwidth * (i - this.min) + 1;\n\t\t\t\t\t\tif (this.dispvalues.indexOf(i) >= 0)\n\t\t\t\t\t\t\trrect(this.ctx, x, 1, this.bwidth, h2, r, this.coltab[7], this.coltab[8]);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\trrect(this.ctx, x, 1, this.bwidth, h2, r, this.coltab[3], this.coltab[4]);\n\t\t\t\t\t\tthis.ctx.strokeStyle = this.coltab[0];\n\t\t\t\t\t\tthis.ctx.stroke();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t_setValue(v) {\n\t\t\t\tif (this.step)\n\t\t\t\t\tv = (Math.round((v - this.min) / this.step)) * this.step + this.min;\n\t\t\t\tthis._value = Math.min(this.max, Math.max(this.min, v));\n\t\t\t\tif (this._value != this.oldvalue) {\n\t\t\t\t\tthis.oldvalue = this._value;\n\t\t\t\t\tthis.redraw();\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tsetValue(v, f) {\n\t\t\t\tif (this._setValue(v) && f)\n\t\t\t\t\tthis.sendEvent(\"input\"), this.sendEvent(\"change\");\n\t\t\t}\n\t\t\twheel(e) { }\n\t\t\tkeydown(e) {\n\t\t\t\tlet m = Math.floor((this.min + 11) / 12) * 12;\n\t\t\t\tlet k = this.keycodes1.indexOf(e.keyCode);\n\t\t\t\tif (k < 0) {\n\t\t\t\t\tk = this.keycodes2.indexOf(e.keyCode);\n\t\t\t\t\tif (k >= 0) k += 12;\n\t\t\t\t}\n\t\t\t\tif (k >= 0) {\n\t\t\t\t\tk += m;\n\t\t\t\t\tif (this.currentKey != k) {\n\t\t\t\t\t\tthis.currentKey = k;\n\t\t\t\t\t\tthis.sendEventFromKey(1, k);\n\t\t\t\t\t\tthis.setNote(1, k);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tkeyup(e) {\n\t\t\t\tlet m = Math.floor((this.min + 11) / 12) * 12;\n\t\t\t\tlet k = this.keycodes1.indexOf(e.keyCode);\n\t\t\t\tif (k < 0) {\n\t\t\t\t\tk = this.keycodes2.indexOf(e.keyCode);\n\t\t\t\t\tif (k >= 0) k += 12;\n\t\t\t\t}\n\t\t\t\tif (k >= 0) {\n\t\t\t\t\tk += m;\n\t\t\t\t\tthis.currentKey = -1;\n\t\t\t\t\tthis.sendEventFromKey(0, k);\n\t\t\t\t\tthis.setNote(0, k);\n\t\t\t\t}\n\t\t\t}\n\t\t\tpointerdown(e) {\n\t\t\t\tthis.cv.focus();\n\t\t\t\t//      document.body.addEventListener('touchstart',this.preventScroll,{passive:false});\n\t\t\t\tif (this.enable) {\n\t\t\t\t\t++this.press;\n\t\t\t\t\tthis.pointermove(e);\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\tpointermove(e) {\n\t\t\t\tif (!this.enable)\n\t\t\t\t\treturn;\n\t\t\t\tlet r = this.getBoundingClientRect();\n\t\t\t\tlet v = [], p;\n\t\t\t\tif (e.touches)\n\t\t\t\t\tp = e.targetTouches;\n\t\t\t\telse if (this.press)\n\t\t\t\t\tp = [e];\n\t\t\t\telse\n\t\t\t\t\tp = [];\n\t\t\t\tif (p.length > 0)\n\t\t\t\t\tthis.drag = 1;\n\t\t\t\tfor (let i = 0; i < p.length; ++i) {\n\t\t\t\t\tlet px = p[i].clientX - r.left;\n\t\t\t\t\tlet py = p[i].clientY - r.top;\n\t\t\t\t\tlet x, k, ko;\n\t\t\t\t\tif (py < this.bheight) {\n\t\t\t\t\t\tx = px - this.wwidth * this.ko[this.min % 12];\n\t\t\t\t\t\tk = this.min + ((x / this.bwidth) | 0);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tk = (px / this.wwidth) | 0;\n\t\t\t\t\t\tko = this.kp[this.min % 12];\n\t\t\t\t\t\tk += ko;\n\t\t\t\t\t\tk = this.min + ((k / 7) | 0) * 12 + this.kn[k % 7] - this.kn[ko % 7];\n\t\t\t\t\t}\n\t\t\t\t\tif (k >= this.min && k <= this.max)\n\t\t\t\t\t\tv.push(k);\n\t\t\t\t}\n\t\t\t\tv.sort();\n\t\t\t\tthis.values = v;\n\t\t\t\tthis.sendevent();\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t\tpointerup(e) {\n\t\t\t\tif (this.enable) {\n\t\t\t\t\t--this.press;\n\t\t\t\t\tthis.pointermove(e);\n\t\t\t\t\tthis.sendevent();\n\t\t\t\t\tthis.redraw();\n\t\t\t\t}\n\t\t\t\tthis.drag = 0;\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\tsendEventFromKey(s, k) {\n\t\t\t\tlet ev = document.createEvent('HTMLEvents');\n\t\t\t\tev.initEvent('change', true, true);\n\t\t\t\tev.note = [s, k];\n\t\t\t\tthis.dispatchEvent(ev);\n\t\t\t}\n\t\t\tsendevent() {\n\t\t\t\tlet notes = [];\n\t\t\t\tfor (let i = 0, j = this.valuesold.length; i < j; ++i) {\n\t\t\t\t\tif (this.values.indexOf(this.valuesold[i]) < 0)\n\t\t\t\t\t\tnotes.push([0, this.valuesold[i]]);\n\t\t\t\t}\n\t\t\t\tfor (let i = 0, j = this.values.length; i < j; ++i) {\n\t\t\t\t\tif (this.valuesold.indexOf(this.values[i]) < 0)\n\t\t\t\t\t\tnotes.push([1, this.values[i]]);\n\t\t\t\t}\n\t\t\t\tif (notes.length) {\n\t\t\t\t\tthis.valuesold = this.values;\n\t\t\t\t\tfor (let i = 0; i < notes.length; ++i) {\n\t\t\t\t\t\tthis.setdispvalues(notes[i][0], notes[i][1]);\n\t\t\t\t\t\tlet ev = document.createEvent('HTMLEvents');\n\t\t\t\t\t\tev.initEvent('change', true, true);\n\t\t\t\t\t\tev.note = notes[i];\n\t\t\t\t\t\tthis.dispatchEvent(ev);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tsetdispvalues(state, note) {\n\t\t\t\tlet n = this.dispvalues.indexOf(note);\n\t\t\t\tif (state) {\n\t\t\t\t\tif (n < 0) this.dispvalues.push(note);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (n >= 0) this.dispvalues.splice(n, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t\tsetNote(state, note) {\n\t\t\t\tthis.setdispvalues(state, note);\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t});\n\t} catch (error) {\n\t\t//console.log(\"webaudio-keyboard already defined\");\n\t}\n\n\t// FOR MIDI LEARN\n\tclass WebAudioControlsMidiManager {\n\t\tconstructor() {\n\t\t\tthis.midiAccess = null;\n\t\t\tthis.listOfWidgets = [];\n\t\t\tthis.listOfExternalMidiListeners = [];\n\t\t\tthis.updateWidgets();\n\t\t\tthis.initWebAudioControls();\n\t\t}\n\t\taddWidget(w) {\n\t\t\tthis.listOfWidgets.push(w);\n\t\t}\n\t\tupdateWidgets() {\n\t\t\t//      this.listOfWidgets = document.querySelectorAll(\"webaudio-knob,webaudio-slider,webaudio-switch\");\n\t\t}\n\t\tinitWebAudioControls() {\n\t\t\tif (navigator.requestMIDIAccess) {\n\t\t\t\tnavigator.requestMIDIAccess().then(\n\t\t\t\t\t(ma) => { this.midiAccess = ma, this.enableInputs() },\n\t\t\t\t\t(err) => { console.log(\"MIDI not initialized - error encountered:\" + err.code) }\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tenableInputs() {\n\t\t\tlet inputs = this.midiAccess.inputs.values();\n\t\t\t//console.log(\"Found \" + this.midiAccess.inputs.size + \" MIDI input(s)\");\n\t\t\tfor (let input = inputs.next(); input && !input.done; input = inputs.next()) {\n\t\t\t\t//console.log(\"Connected input: \" + input.value.name);\n\t\t\t\tinput.value.onmidimessage = this.handleMIDIMessage.bind(this);\n\t\t\t}\n\t\t}\n\t\tmidiConnectionStateChange(e) {\n\t\t\t// console.log(\"connection: \" + e.port.name + \" \" + e.port.connection + \" \" + e.port.state);\n\t\t\tenableInputs();\n\t\t}\n\n\t\tonMIDIStarted(midi) {\n\t\t\tthis.midiAccess = midi;\n\t\t\tmidi.onstatechange = this.midiConnectionStateChange;\n\t\t\tenableInputs(midi);\n\t\t}\n\t\t// Add hooks for external midi listeners support\n\t\taddMidiListener(callback) {\n\t\t\tthis.listOfExternalMidiListeners.push(callback);\n\t\t}\n\t\tgetCurrentConfigAsJSON() {\n\t\t\treturn currentConfig.stringify();\n\t\t}\n\t\thandleMIDIMessage(event) {\n\t\t\tthis.listOfExternalMidiListeners.forEach(function (externalListener) {\n\t\t\t\texternalListener(event);\n\t\t\t});\n\t\t\tif (((event.data[0] & 0xf0) == 0xf0) || ((event.data[0] & 0xf0) == 0xb0 && event.data[1] >= 120))\n\t\t\t\treturn;\n\t\t\tfor (let w of this.listOfWidgets) {\n\t\t\t\tif (w.processMidiEvent)\n\t\t\t\t\tw.processMidiEvent(event);\n\t\t\t}\n\t\t\tif (opt.mididump)\n\t\t\t\tconsole.log(event.data);\n\t\t}\n\t\tcontextMenuOpen(e, knob) {\n\t\t\tif (!this.midiAccess)\n\t\t\t\treturn;\n\t\t\tlet menu = document.getElementById(\"webaudioctrl-context-menu\");\n\t\t\tmenu.style.left = e.pageX + \"px\";\n\t\t\tmenu.style.top = e.pageY + \"px\";\n\t\t\tmenu.knob = knob;\n\t\t\tmenu.classList.add(\"active\");\n\t\t\tmenu.knob.focus();\n\t\t\t//      document.activeElement.onblur=this.contextMenuClose;\n\t\t\tmenu.knob.addEventListener(\"keydown\", this.contextMenuCloseByKey.bind(this));\n\t\t}\n\t\tcontextMenuCloseByKey(e) {\n\t\t\tif (e.keyCode == 27)\n\t\t\t\tthis.contextMenuClose();\n\t\t}\n\t\tcontextMenuClose() {\n\t\t\tlet menu = document.getElementById(\"webaudioctrl-context-menu\");\n\t\t\tmenu.knob.removeEventListener(\"keydown\", this.contextMenuCloseByKey);\n\t\t\tmenu.classList.remove(\"active\");\n\t\t\tlet menuItemLearn = document.getElementById(\"webaudioctrl-context-menu-learn\");\n\t\t\tmenuItemLearn.innerHTML = 'Learn';\n\t\t\tmenu.knob.midiMode = 'normal';\n\t\t}\n\t\tcontextMenuLearn() {\n\t\t\tlet menu = document.getElementById(\"webaudioctrl-context-menu\");\n\t\t\tlet menuItemLearn = document.getElementById(\"webaudioctrl-context-menu-learn\");\n\t\t\tmenuItemLearn.innerHTML = 'Listening...';\n\t\t\tmenu.knob.midiMode = 'learn';\n\t\t}\n\t\tcontextMenuClear(e) {\n\t\t\tlet menu = document.getElementById(\"webaudioctrl-context-menu\");\n\t\t\tmenu.knob.midiController = {};\n\t\t\tthis.contextMenuClose();\n\t\t}\n\t}\n\tif (window.UseWebAudioControlsMidi || opt.useMidi)\n\t\twindow.webAudioControlsMidiManager = new WebAudioControlsMidiManager();\n}\n","export default \"assets/background.png\"","export default \"assets/MiniMoog_Main.png\"","export default \"assets/switch_1.png\"","// This works when youuse a bundler such as rollup\n// If you do no wan to use a bundler, then  look at other examples\n// that build in pure JS the syles and html template directly\n// in the code...\nimport style from './Gui.css';\nimport template from './Gui.template.html';\n\n// https://github.com/g200kg/webaudio-controls/blob/master/webaudio-controls.js\nimport '../utils/webaudio-controls.js';\n\nimport backgroundImg from './assets/background.png';\nimport knobImg from './assets/MiniMoog_Main.png';\nimport switchImg from './assets/switch_1.png';\n\nconst getAssetUrl = (asset) => {\n\tconst base = new URL('.', import.meta.url);\n\treturn `${base}${asset}`;\n};\n\n// The GUI is a WebComponent. Not mandatory but useful.\n// MANDORY : the GUI should be a DOM node. WebComponents are\n// practical as they encapsulate everyhing in a shadow dom\nexport default class QuadrafuzzHTMLElement extends HTMLElement {\n\t// plugin = the same that is passed in the DSP part. It's the instance\n\t// of the class that extends WebAudioModule. It's an Observable plugin\n\tconstructor(plugin) {\n\t\tsuper();\n\n\t\tthis.root = this.attachShadow({ mode: 'open' });\n\t\tthis.root.innerHTML = `<style>${style}</style>${template}`;\n\n\t\t// MANDATORY for the GUI to observe the plugin state\n\t\tthis.plugin = plugin;\n\n\t\tthis.setResources();\n\t\tthis.setKnobs();\n\t\tthis.setSwitchListener();\n\n\t\twindow.requestAnimationFrame(this.handleAnimationFrame);\n\t}\n\n\tupdateStatus = (status) => {\n\t\tthis.shadowRoot.querySelector('#switch1').value = status;\n\t}\n\n\thandleAnimationFrame = () => {\n\t\tconst {\n\t\t\tlowGain,\n\t\t\tmidLowGain,\n\t\t\tmidHighGain,\n\t\t\thighGain,\n\t\t\tenabled,\n\t\t} = this.plugin.audioNode.getParamsValues();\n\t\tthis.shadowRoot.querySelector('#knob1').value = lowGain;\n\t\tthis.shadowRoot.querySelector('#knob2').value = midLowGain;\n\t\tthis.shadowRoot.querySelector('#knob3').value = midHighGain;\n\t\tthis.shadowRoot.querySelector('#knob4').value = highGain;\n\t\tthis.shadowRoot.querySelector('#switch1').value = enabled;\n\t\twindow.requestAnimationFrame(this.handleAnimationFrame);\n\t}\n\n\t/**\n\t * Change relative URLS to absolute URLs for CSS assets, webaudio controls spritesheets etc.\n\t */\n\tsetResources() {\n\t\t// Set up the background img & style\n\t\tconst background = this.root.querySelector(\"img\");\n\t\tbackground.src = getAssetUrl(backgroundImg);\n\t\t//background.src = bgImage;\n\t\tbackground.style = 'border-radius : 5px;'\n\t\t// Setting up the knobs imgs, those are loaded from the assets\n\t\tthis.root.querySelectorAll(\".knob\").forEach((knob) => {\n\t\t\tknob.querySelector(\"webaudio-knob\").setAttribute('src', getAssetUrl(knobImg));\n\t\t});\n\t\t// Setting up the switches imgs, those are loaded from the assets\n\t\tthis.root.querySelector(\"webaudio-switch\").setAttribute('src', getAssetUrl(switchImg));\n\t}\n\n\tsetKnobs() {\n\t\tthis.shadowRoot\n\t\t\t.querySelector('#knob1')\n\t\t\t.addEventListener('input', (e) => {\n\t\t\t\tthis.plugin.audioNode.setParamsValues({ lowGain: e.target.value});\n\t\t\t});\n\t\tthis.shadowRoot\n\t\t\t.querySelector('#knob2')\n\t\t\t.addEventListener('input', (e) => {\n\t\t\t\tthis.plugin.audioNode.setParamsValues({ midLowGain: e.target.value});\n\t\t\t});\n\t\t\tthis.shadowRoot\n\t\t\t.querySelector('#knob3')\n\t\t\t.addEventListener('input', (e) => {\n\t\t\t\tthis.plugin.audioNode.setParamsValues({ midHighGain: e.target.value });\n\t\t\t});\n\t\t\tthis.shadowRoot\n\t\t\t.querySelector('#knob4')\n\t\t\t.addEventListener('input', (e) => {\n\t\t\t\tthis.plugin.audioNode.setParamsValues({ highGain: e.target.value });\n\t\t\t});\n\t}\n\n\tsetSwitchListener() {\n\t\tconsole.log(\"Quadrafuzz : set switch listener\");\n\t\tconst { plugin } = this;\n\t\t// by default, plugin is disabled\n\t\tplugin.audioNode.setParamsValues({ enabled: 1 });\n\n\t\tthis.shadowRoot\n\t\t\t.querySelector('#switch1')\n\t\t\t.addEventListener('change', function onChange() {\n\t\t\t\tplugin.audioNode.setParamsValues({ enabled: +!!this.checked });\n\t\t\t});\n\t}\n\n\t// name of the custom HTML element associated\n\t// with the plugin. Will appear in the DOM if\n\t// the plugin is visible\n\tstatic is() {\n\t\treturn 'wasabi-quadrafuzz';\n\t}\n}\n\nif (!customElements.get(QuadrafuzzHTMLElement.is())) {\n\tcustomElements.define(QuadrafuzzHTMLElement.is(), QuadrafuzzHTMLElement);\n}\n","// This file is the factory for the GUI part..bundleRenderer.renderToStream\n// The imporant thing here is the createElement async method\n// This file must be an es module in order to be loaded with the SDK (with dynamic imports)\nimport QuadrafuzzHTMLElement from './Gui.js';\n\nexport { QuadrafuzzHTMLElement };\n\n/**\n * A mandatory method if you want a gui for your plugin\n * @param {import('@webaudiomodules/api').WebAudioModule} plugin - the plugin instance\n * @returns {Node} - the plugin root node that is inserted in the DOM of the host\n */\nexport async function createElement(plugin, ...args) {\n\t// here we return the WebComponent GUI but it could be\n// any DOM node\n\treturn new QuadrafuzzHTMLElement(plugin, ...args);\n}\n","/* eslint-disable no-underscore-dangle */\n// Double role for WebAudioModule :\n// 1 - Factory for providing the DSP/WebAudio node and GUI\n// 2 - This makes the instance of the current class an Observable\n//     (state in WebAudioModule, initialized with the default values of\n//      the params variable below...)\nimport { WebAudioModule } from '@webaudiomodules/sdk';\nimport { ParamMgrFactory } from '@webaudiomodules/sdk-parammgr';\nimport QuadrafuzzNode from './Node.js';\nimport { createElement } from './Gui/index.js';\n\n/**\n * @param {URL} relativeURL\n * @returns {string}\n */\nconst getBasetUrl = (relativeURL) => {\n\tconst baseURL = relativeURL.href.substring(0, relativeURL.href.lastIndexOf('/'));\n\treturn baseURL;\n};\n\nexport default class QuadrafuzzPlugin extends WebAudioModule {\n\t_baseURL = getBasetUrl(new URL('.', import.meta.url));\n\n\t_descriptorUrl = `${this._baseURL}/descriptor.json`;\n\n\tasync _loadDescriptor() {\n\t\tconst url = this._descriptorUrl;\n\t\tif (!url) throw new TypeError('Descriptor not found');\n\t\tconst response = await fetch(url);\n\t\tconst descriptor = await response.json();\n\t\tObject.assign(this.descriptor, descriptor);\n\t}\n\n\tasync initialize(state) {\n\t\tawait this._loadDescriptor();\n\t\treturn super.initialize(state);\n\t}\n\n\tasync createAudioNode(initialState) {\n\t\tconst quadrafuzzNode = new QuadrafuzzNode(this.audioContext);\n\t\tconst internalParamsConfig = {\n\t\t\t// quadrafuzzNode.overdrives[0] is a waveshaper. When we call setLowGain(value) it will change\n\t\t\t// the curve of the waveshaper... so... we don't really want to automatize at a fast rate...\n\t\t\t// I guess this is the case of a developer who is gonna do custom automation\n\t\t\tlowGain: {\n\t\t\t\tdefaultValue: 0.6,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tonChange: (value) => { quadrafuzzNode.lowGain = value; },\n\t\t\t},\n\t\t\t// and we do have other \"params\"\n\t\t\tmidLowGain: {\n\t\t\t\tdefaultValue: 0.8,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tonChange: (value) => { quadrafuzzNode.midLowGain = value; },\n\t\t\t},\n\t\t\tmidHighGain: {\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tonChange: (value) => { quadrafuzzNode.midHighGain = value; },\n\t\t\t},\n\t\t\thighGain: {\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tonChange: (value) => { quadrafuzzNode.highGain = value; },\n\t\t\t},\n\t\t\tenabled: {\n\t\t\t\tdefaultValue: 1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tonChange: (value) => { quadrafuzzNode.status = !!value; },\n\t\t\t},\n\t\t};\n\t\t// hmmm no mapping...\n\t\t// const paramsMapping = {};\n\n\t\tconst optionsIn = { internalParamsConfig };\n\t\tconst paramMgrNode = await ParamMgrFactory.create(this, optionsIn);\n\t\tquadrafuzzNode.setup(paramMgrNode);\n\t\tif (initialState) quadrafuzzNode.setState(initialState);\n\t\t//----\n\t\treturn quadrafuzzNode;\n\t}\n\n\tcreateGui() {\n\t\treturn createElement(this);\n\t}\n}\n"],"names":["groupId","audioContext","initialState","initialize","constructor","_groupId","_audioContext","_initialized","_audioNode","_timestamp","performance","now","_guiModuleUrl","_descriptorUrl","_descriptor","name","vendor","description","version","apiVersion","thumbnail","keywords","isInstrument","website","hasAudioInput","hasAudioOutput","hasAutomationInput","hasAutomationOutput","hasMidiInput","hasMidiOutput","hasMpeInput","hasMpeOutput","hasOscInput","hasOscOutput","hasSysexInput","hasSysexOutput","moduleId","descriptor","initialized","console","warn","node","value","TypeError","state","audioNode","createAudioNode","url","response","fetch","json","Object","assign","createElement","_loadGui","destroyGui","WebAudioModule_default","WebAudioModule","GainNode","__publicField","_wamNode","instanceId","module","addEventListener","args","removeEventListener","dispatchEvent","getParameterInfo","getParameterValues","setParameterValues","getState","setState","getCompensationDelay","scheduleEvents","clearEvents","connectEvents","disconnectEvents","destroy","count","_output","channelCount","mode","channelCountMode","interpretation","channelInterpretation","numberOfInputs","numberOfOutputs","connect","disconnect","QuadrafuzzNode","CompositeAudioNode","setup","wamNode","connectNodes","context","options","undefined","createNodes","outputNode","createGain","dryGainNode","wetGainNode","lowpassLeft","createBiquadFilter","type","frequency","Q","bandpass1Left","bandpass2Left","highpassLeft","overdrives","i","createWaveShaper","curve","getDistortionCurve","normalize","filters","length","k","log","sampleRate","Float32Array","deg","Math","PI","x","abs","isInRange","arg","min","max","isNumber","num","floor","ceil","lowGain","_lowGain","midLowGain","_midLowGain","midHighGain","_midHighGain","highGain","_highGain","status","_sig","isEnabled","gain","linearRampToValueAtTime","currentTime","toString","call","getDryLevel","mix","getWetLevel","getParamValue","setParamValue","getParamsValues","setParamsValues","values","window","customElements","styles","document","innerHTML","head","appendChild","midimenu","id","opt","useMidi","midilearn","mididump","outline","knobSrc","knobSprites","knobWidth","knobHeight","knobDiameter","knobColors","sliderSrc","sliderKnobsrc","sliderWidth","sliderHeight","sliderKnobwidth","sliderKnobheight","sliderDitchlength","sliderColors","switchWidth","switchHeight","switchDiameter","switchColors","paramWidth","paramHeight","paramColors","WebAudioControlsOptions","WebAudioControlsWidget","HTMLElement","keydown","pointerdown","passive","wheel","pointerover","pointerout","contextMenu","hover","drag","body","basestyle","sendEvent","ev","event","createEvent","initEvent","getAttr","n","def","v","getAttribute","isNaN","showtip","d","numformat","s","indexOf","c","m","r","j","parseInt","toUpperCase","toFixed","slice","replace","tooltip","valuetip","digits","ttframe","convValue","style","display","width","height","transition","opacity","visibility","rc","getBoundingClientRect","rc2","documentElement","left","top","e","webAudioControlsMidiManager","contextMenuOpen","preventDefault","stopPropagation","setMidiController","channel","cc","listeningToThisMidiController","midiController","processMidiEvent","data","controlNumber","midiMode","contextMenuClose","tagName","setValue","els","querySelectorAll","group","val","define","WebAudioKnob","src","_src","setupImage","_value","redraw","_min","_max","step","_step","sprites","_sprites","_width","_height","diameter","_diameter","colors","_colors","connectedCallback","root","elem","childNodes","enable","defvalue","sensitivity","conv","eval","midicc","ch","substring","lastIndexOf","coltab","addWidget","disconnectedCallback","kw","kh","split","svg","backgroundImage","btoa","backgroundSize","isConnected","range","sp","offset","backgroundPosition","transform","_setValue","round","oldvalue","f","delta","deltaY","shiftKey","touches","changedTouches","identifier","buttons","button","focus","pointermove","lastShift","startPosX","pageX","startPosY","pageY","startVal","pointerup","preventScroll","ctrlKey","metaKey","error","WebAudioSlider","knobsrc","_knobsrc","direction","_direction","knobwidth","_knobwidth","knobheight","_knobheight","ditchlength","_ditchlength","knob","onclick","dr","dlen","kwidth","kheight","svgbody","svgthumb","sensex","sensey","WebAudioSwitch","invert","w","h","mm","checked","WebAudioParam","fontsize","_fontsize","link","fromLink","target","bind","onchange","le","getElementById","color","backgroundColor","fontSize","l","WebAudioKeyboard","keys","_keys","cv","ctx","getContext","_values","press","keycodes1","keycodes2","keyup","bheight","kp","kf","ko","kn","dispvalues","valuesold","rrect","y","c1","c2","g","createLinearGradient","addColorStop","fillStyle","beginPath","moveTo","lineTo","quadraticCurveTo","fill","fillRect","x0","x1","wwidth","bwidth","h2","strokeStyle","stroke","keyCode","currentKey","sendEventFromKey","setNote","p","targetTouches","px","clientX","py","clientY","push","sort","sendevent","note","notes","setdispvalues","splice","WebAudioControlsMidiManager","midiAccess","listOfWidgets","listOfExternalMidiListeners","updateWidgets","initWebAudioControls","navigator","requestMIDIAccess","then","ma","enableInputs","err","code","inputs","input","next","done","onmidimessage","handleMIDIMessage","midiConnectionStateChange","onMIDIStarted","midi","onstatechange","addMidiListener","callback","getCurrentConfigAsJSON","currentConfig","stringify","forEach","externalListener","menu","classList","add","contextMenuCloseByKey","remove","menuItemLearn","contextMenuLearn","contextMenuClear","UseWebAudioControlsMidi","getAssetUrl","asset","base","URL","import","meta","QuadrafuzzHTMLElement","plugin","shadowRoot","querySelector","enabled","requestAnimationFrame","handleAnimationFrame","attachShadow","template","setResources","setKnobs","setSwitchListener","background","backgroundImg","setAttribute","knobImg","switchImg","onChange","is","get","getBasetUrl","relativeURL","baseURL","href","QuadrafuzzPlugin","_baseURL","_loadDescriptor","quadrafuzzNode","internalParamsConfig","defaultValue","minValue","maxValue","optionsIn","paramMgrNode","ParamMgrFactory","create","createGui"],"mappings":"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"}