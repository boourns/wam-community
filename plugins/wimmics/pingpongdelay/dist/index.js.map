{"version":3,"file":"index.js","sources":["../../sdk/dist/index.js","../../sdk-parammgr/dist/index.js","../src/Node.js","../src/Gui/utils/webaudio-controls.js","../src/Gui/assets/nux_black_white_stripe.png","../src/Gui/assets/switch_1.png","../src/Gui/Gui.js","../src/Gui/index.js","../src/index.js"],"sourcesContent":["// src/WebAudioModule.js\nvar WebAudioModule = class {\n  static get isWebAudioModuleConstructor() {\n    return true;\n  }\n  static createInstance(groupId, audioContext, initialState) {\n    return new this(groupId, audioContext).initialize(initialState);\n  }\n  constructor(groupId, audioContext) {\n    this._groupId = groupId;\n    this._audioContext = audioContext;\n    this._initialized = false;\n    this._audioNode = void 0;\n    this._timestamp = performance.now();\n    this._guiModuleUrl = void 0;\n    this._descriptorUrl = \"./descriptor.json\";\n    this._descriptor = {\n      name: `WebAudioModule_${this.constructor.name}`,\n      vendor: \"WebAudioModuleVendor\",\n      description: \"\",\n      version: \"0.0.0\",\n      apiVersion: \"2.0.0\",\n      thumbnail: \"\",\n      keywords: [],\n      isInstrument: false,\n      website: \"\",\n      hasAudioInput: true,\n      hasAudioOutput: true,\n      hasAutomationInput: true,\n      hasAutomationOutput: true,\n      hasMidiInput: true,\n      hasMidiOutput: true,\n      hasMpeInput: true,\n      hasMpeOutput: true,\n      hasOscInput: true,\n      hasOscOutput: true,\n      hasSysexInput: true,\n      hasSysexOutput: true\n    };\n  }\n  get isWebAudioModule() {\n    return true;\n  }\n  get groupId() {\n    return this._groupId;\n  }\n  get moduleId() {\n    return this.vendor + this.name;\n  }\n  get instanceId() {\n    return this.moduleId + this._timestamp;\n  }\n  get descriptor() {\n    return this._descriptor;\n  }\n  get name() {\n    return this.descriptor.name;\n  }\n  get vendor() {\n    return this.descriptor.vendor;\n  }\n  get audioContext() {\n    return this._audioContext;\n  }\n  get audioNode() {\n    if (!this.initialized)\n      console.warn(\"WAM should be initialized before getting the audioNode\");\n    return this._audioNode;\n  }\n  set audioNode(node) {\n    this._audioNode = node;\n  }\n  get initialized() {\n    return this._initialized;\n  }\n  set initialized(value) {\n    this._initialized = value;\n  }\n  async createAudioNode(initialState) {\n    throw new TypeError(\"createAudioNode() not provided\");\n  }\n  async initialize(state) {\n    if (!this._audioNode)\n      this.audioNode = await this.createAudioNode();\n    this.initialized = true;\n    return this;\n  }\n  async _loadGui() {\n    const url = this._guiModuleUrl;\n    if (!url)\n      throw new TypeError(\"Gui module not found\");\n    return import(\n      /* webpackIgnore: true */\n      url\n    );\n  }\n  async _loadDescriptor() {\n    const url = this._descriptorUrl;\n    if (!url)\n      throw new TypeError(\"Descriptor not found\");\n    const response = await fetch(url);\n    const descriptor = await response.json();\n    Object.assign(this._descriptor, descriptor);\n    return this._descriptor;\n  }\n  async createGui() {\n    if (!this.initialized)\n      console.warn(\"Plugin should be initialized before getting the gui\");\n    if (!this._guiModuleUrl)\n      return void 0;\n    const { createElement } = await this._loadGui();\n    return createElement(this);\n  }\n  destroyGui() {\n  }\n};\nvar WebAudioModule_default = WebAudioModule;\n\n// src/RingBuffer.js\nvar getRingBuffer = (moduleId) => {\n  const audioWorkletGlobalScope = globalThis;\n  class RingBuffer2 {\n    static getStorageForCapacity(capacity, Type) {\n      if (!Type.BYTES_PER_ELEMENT) {\n        throw new Error(\"Pass in a ArrayBuffer subclass\");\n      }\n      const bytes = 8 + (capacity + 1) * Type.BYTES_PER_ELEMENT;\n      return new SharedArrayBuffer(bytes);\n    }\n    constructor(sab, Type) {\n      if (!Type.BYTES_PER_ELEMENT) {\n        throw new Error(\"Pass a concrete typed array class as second argument\");\n      }\n      this._Type = Type;\n      this._capacity = (sab.byteLength - 8) / Type.BYTES_PER_ELEMENT;\n      this.buf = sab;\n      this.write_ptr = new Uint32Array(this.buf, 0, 1);\n      this.read_ptr = new Uint32Array(this.buf, 4, 1);\n      this.storage = new Type(this.buf, 8, this._capacity);\n    }\n    get type() {\n      return this._Type.name;\n    }\n    push(elements) {\n      const rd = Atomics.load(this.read_ptr, 0);\n      const wr = Atomics.load(this.write_ptr, 0);\n      if ((wr + 1) % this._storageCapacity() === rd) {\n        return 0;\n      }\n      const toWrite = Math.min(this._availableWrite(rd, wr), elements.length);\n      const firstPart = Math.min(this._storageCapacity() - wr, toWrite);\n      const secondPart = toWrite - firstPart;\n      this._copy(elements, 0, this.storage, wr, firstPart);\n      this._copy(elements, firstPart, this.storage, 0, secondPart);\n      Atomics.store(this.write_ptr, 0, (wr + toWrite) % this._storageCapacity());\n      return toWrite;\n    }\n    pop(elements) {\n      const rd = Atomics.load(this.read_ptr, 0);\n      const wr = Atomics.load(this.write_ptr, 0);\n      if (wr === rd) {\n        return 0;\n      }\n      const isArray = !Number.isInteger(elements);\n      const toRead = Math.min(this._availableRead(rd, wr), isArray ? elements.length : elements);\n      if (isArray) {\n        const firstPart = Math.min(this._storageCapacity() - rd, toRead);\n        const secondPart = toRead - firstPart;\n        this._copy(this.storage, rd, elements, 0, firstPart);\n        this._copy(this.storage, 0, elements, firstPart, secondPart);\n      }\n      Atomics.store(this.read_ptr, 0, (rd + toRead) % this._storageCapacity());\n      return toRead;\n    }\n    get empty() {\n      const rd = Atomics.load(this.read_ptr, 0);\n      const wr = Atomics.load(this.write_ptr, 0);\n      return wr === rd;\n    }\n    get full() {\n      const rd = Atomics.load(this.read_ptr, 0);\n      const wr = Atomics.load(this.write_ptr, 0);\n      return (wr + 1) % this._capacity !== rd;\n    }\n    get capacity() {\n      return this._capacity - 1;\n    }\n    get availableRead() {\n      const rd = Atomics.load(this.read_ptr, 0);\n      const wr = Atomics.load(this.write_ptr, 0);\n      return this._availableRead(rd, wr);\n    }\n    get availableWrite() {\n      const rd = Atomics.load(this.read_ptr, 0);\n      const wr = Atomics.load(this.write_ptr, 0);\n      return this._availableWrite(rd, wr);\n    }\n    _availableRead(rd, wr) {\n      if (wr > rd) {\n        return wr - rd;\n      }\n      return wr + this._storageCapacity() - rd;\n    }\n    _availableWrite(rd, wr) {\n      let rv = rd - wr - 1;\n      if (wr >= rd) {\n        rv += this._storageCapacity();\n      }\n      return rv;\n    }\n    _storageCapacity() {\n      return this._capacity;\n    }\n    _copy(input, offsetInput, output, offsetOutput, size) {\n      for (let i = 0; i < size; i++) {\n        output[offsetOutput + i] = input[offsetInput + i];\n      }\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    const ModuleScope = audioWorkletGlobalScope.webAudioModules.getModuleScope(moduleId);\n    if (!ModuleScope.RingBuffer)\n      ModuleScope.RingBuffer = RingBuffer2;\n  }\n  return RingBuffer2;\n};\nvar RingBuffer_default = getRingBuffer;\n\n// src/WamArrayRingBuffer.js\nvar getWamArrayRingBuffer = (moduleId) => {\n  const audioWorkletGlobalScope = globalThis;\n  class WamArrayRingBuffer {\n    static DefaultArrayCapacity = 2;\n    static getStorageForEventCapacity(RingBuffer2, arrayLength, arrayType, maxArrayCapacity = void 0) {\n      if (maxArrayCapacity === void 0)\n        maxArrayCapacity = WamArrayRingBuffer.DefaultArrayCapacity;\n      else\n        maxArrayCapacity = Math.max(maxArrayCapacity, WamArrayRingBuffer.DefaultArrayCapacity);\n      if (!arrayType.BYTES_PER_ELEMENT) {\n        throw new Error(\"Pass in a ArrayBuffer subclass\");\n      }\n      const capacity = arrayLength * maxArrayCapacity;\n      return RingBuffer2.getStorageForCapacity(capacity, arrayType);\n    }\n    constructor(RingBuffer2, sab, arrayLength, arrayType, maxArrayCapacity = void 0) {\n      if (!arrayType.BYTES_PER_ELEMENT) {\n        throw new Error(\"Pass in a ArrayBuffer subclass\");\n      }\n      this._arrayLength = arrayLength;\n      this._arrayType = arrayType;\n      this._arrayElementSizeBytes = arrayType.BYTES_PER_ELEMENT;\n      this._arraySizeBytes = this._arrayLength * this._arrayElementSizeBytes;\n      this._sab = sab;\n      if (maxArrayCapacity === void 0)\n        maxArrayCapacity = WamArrayRingBuffer.DefaultArrayCapacity;\n      else\n        maxArrayCapacity = Math.max(maxArrayCapacity, WamArrayRingBuffer.DefaultArrayCapacity);\n      this._arrayArray = new arrayType(this._arrayLength);\n      this._rb = new RingBuffer2(this._sab, arrayType);\n    }\n    write(array) {\n      if (array.length !== this._arrayLength)\n        return false;\n      const elementsAvailable = this._rb.availableWrite;\n      if (elementsAvailable < this._arrayLength)\n        return false;\n      let success = true;\n      const elementsWritten = this._rb.push(array);\n      if (elementsWritten != this._arrayLength)\n        success = false;\n      return success;\n    }\n    read(array, newest) {\n      if (array.length !== this._arrayLength)\n        return false;\n      const elementsAvailable = this._rb.availableRead;\n      if (elementsAvailable < this._arrayLength)\n        return false;\n      if (newest && elementsAvailable > this._arrayLength)\n        this._rb.pop(elementsAvailable - this._arrayLength);\n      let success = false;\n      const elementsRead = this._rb.pop(array);\n      if (elementsRead === this._arrayLength)\n        success = true;\n      return success;\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    const ModuleScope = audioWorkletGlobalScope.webAudioModules.getModuleScope(moduleId);\n    if (!ModuleScope.WamArrayRingBuffer)\n      ModuleScope.WamArrayRingBuffer = WamArrayRingBuffer;\n  }\n  return WamArrayRingBuffer;\n};\nvar WamArrayRingBuffer_default = getWamArrayRingBuffer;\n\n// src/WamEnv.js\nvar initializeWamEnv = (apiVersion) => {\n  const audioWorkletGlobalScope = globalThis;\n  if (audioWorkletGlobalScope.AudioWorkletProcessor && audioWorkletGlobalScope.webAudioModules)\n    return;\n  const moduleScopes = /* @__PURE__ */ new Map();\n  const groups = /* @__PURE__ */ new Map();\n  class WamEnv {\n    constructor() {\n    }\n    get apiVersion() {\n      return apiVersion;\n    }\n    getModuleScope(moduleId) {\n      if (!moduleScopes.has(moduleId))\n        moduleScopes.set(moduleId, {});\n      return moduleScopes.get(moduleId);\n    }\n    getGroup(groupId, groupKey) {\n      const group = groups.get(groupId);\n      if (group.validate(groupKey))\n        return group;\n      else\n        throw \"Invalid key\";\n    }\n    addGroup(group) {\n      if (!groups.has(group.groupId))\n        groups.set(group.groupId, group);\n    }\n    removeGroup(group) {\n      groups.delete(group.groupId);\n    }\n    addWam(wam) {\n      const group = groups.get(wam.groupId);\n      group.addWam(wam);\n    }\n    removeWam(wam) {\n      const group = groups.get(wam.groupId);\n      group.removeWam(wam);\n    }\n    connectEvents(groupId, fromId, toId, output = 0) {\n      const group = groups.get(groupId);\n      group.connectEvents(fromId, toId, output);\n    }\n    disconnectEvents(groupId, fromId, toId, output) {\n      const group = groups.get(groupId);\n      group.disconnectEvents(fromId, toId, output);\n    }\n    emitEvents(from, ...events) {\n      const group = groups.get(from.groupId);\n      group.emitEvents(from, ...events);\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    if (!audioWorkletGlobalScope.webAudioModules)\n      audioWorkletGlobalScope.webAudioModules = new WamEnv();\n  }\n};\nvar WamEnv_default = initializeWamEnv;\n\n// src/WamGroup.js\nvar initializeWamGroup = (groupId, groupKey) => {\n  const audioWorkletGlobalScope = globalThis;\n  class WamGroup {\n    constructor(groupId2, groupKey2) {\n      this._groupId = groupId2;\n      this._validate = (key) => {\n        return key == groupKey2;\n      };\n      this._processors = /* @__PURE__ */ new Map();\n      this._eventGraph = /* @__PURE__ */ new Map();\n    }\n    get groupId() {\n      return this._groupId;\n    }\n    get processors() {\n      return this._processors;\n    }\n    get eventGraph() {\n      return this._eventGraph;\n    }\n    validate(groupKey2) {\n      return this._validate(groupKey2);\n    }\n    addWam(wam) {\n      this._processors.set(wam.instanceId, wam);\n    }\n    removeWam(wam) {\n      if (this._eventGraph.has(wam))\n        this._eventGraph.delete(wam);\n      this._eventGraph.forEach((outputMap) => {\n        outputMap.forEach((set) => {\n          if (set && set.has(wam))\n            set.delete(wam);\n        });\n      });\n      this._processors.delete(wam.instanceId);\n    }\n    connectEvents(fromId, toId, output) {\n      const from = this._processors.get(fromId);\n      const to = this._processors.get(toId);\n      let outputMap;\n      if (this._eventGraph.has(from)) {\n        outputMap = this._eventGraph.get(from);\n      } else {\n        outputMap = [];\n        this._eventGraph.set(from, outputMap);\n      }\n      if (outputMap[output]) {\n        outputMap[output].add(to);\n      } else {\n        const set = /* @__PURE__ */ new Set();\n        set.add(to);\n        outputMap[output] = set;\n      }\n    }\n    disconnectEvents(fromId, toId, output) {\n      const from = this._processors.get(fromId);\n      if (!this._eventGraph.has(from))\n        return;\n      const outputMap = this._eventGraph.get(from);\n      if (typeof toId === \"undefined\") {\n        outputMap.forEach((set) => {\n          if (set)\n            set.clear();\n        });\n        return;\n      }\n      const to = this._processors.get(toId);\n      if (typeof output === \"undefined\") {\n        outputMap.forEach((set) => {\n          if (set)\n            set.delete(to);\n        });\n        return;\n      }\n      if (!outputMap[output])\n        return;\n      outputMap[output].delete(to);\n    }\n    emitEvents(from, ...events) {\n      if (!this._eventGraph.has(from))\n        return;\n      const downstream = this._eventGraph.get(from);\n      downstream.forEach((set) => {\n        if (set)\n          set.forEach((wam) => wam.scheduleEvents(...events));\n      });\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    audioWorkletGlobalScope.webAudioModules.addGroup(new WamGroup(groupId, groupKey));\n  }\n};\nvar WamGroup_default = initializeWamGroup;\n\n// src/WamEventRingBuffer.js\nvar getWamEventRingBuffer = (moduleId) => {\n  const audioWorkletGlobalScope = globalThis;\n  class WamEventRingBuffer2 {\n    static DefaultExtraBytesPerEvent = 64;\n    static WamEventBaseBytes = 4 + 1 + 8;\n    static WamAutomationEventBytes = WamEventRingBuffer2.WamEventBaseBytes + 2 + 8 + 1;\n    static WamTransportEventBytes = WamEventRingBuffer2.WamEventBaseBytes + 4 + 8 + 8 + 1 + 1 + 1;\n    static WamMidiEventBytes = WamEventRingBuffer2.WamEventBaseBytes + 1 + 1 + 1;\n    static WamBinaryEventBytes = WamEventRingBuffer2.WamEventBaseBytes + 4;\n    static getStorageForEventCapacity(RingBuffer2, eventCapacity, maxBytesPerEvent = void 0) {\n      if (maxBytesPerEvent === void 0)\n        maxBytesPerEvent = WamEventRingBuffer2.DefaultExtraBytesPerEvent;\n      else\n        maxBytesPerEvent = Math.max(maxBytesPerEvent, WamEventRingBuffer2.DefaultExtraBytesPerEvent);\n      const capacity = (Math.max(WamEventRingBuffer2.WamAutomationEventBytes, WamEventRingBuffer2.WamTransportEventBytes, WamEventRingBuffer2.WamMidiEventBytes, WamEventRingBuffer2.WamBinaryEventBytes) + maxBytesPerEvent) * eventCapacity;\n      return RingBuffer2.getStorageForCapacity(capacity, Uint8Array);\n    }\n    constructor(RingBuffer2, sab, parameterIds, maxBytesPerEvent = void 0) {\n      this._eventSizeBytes = {};\n      this._encodeEventType = {};\n      this._decodeEventType = {};\n      const wamEventTypes = [\"wam-automation\", \"wam-transport\", \"wam-midi\", \"wam-sysex\", \"wam-mpe\", \"wam-osc\", \"wam-info\"];\n      wamEventTypes.forEach((type, encodedType) => {\n        let byteSize = 0;\n        switch (type) {\n          case \"wam-automation\":\n            byteSize = WamEventRingBuffer2.WamAutomationEventBytes;\n            break;\n          case \"wam-transport\":\n            byteSize = WamEventRingBuffer2.WamTransportEventBytes;\n            break;\n          case \"wam-mpe\":\n          case \"wam-midi\":\n            byteSize = WamEventRingBuffer2.WamMidiEventBytes;\n            break;\n          case \"wam-osc\":\n          case \"wam-sysex\":\n          case \"wam-info\":\n            byteSize = WamEventRingBuffer2.WamBinaryEventBytes;\n            break;\n          default:\n            break;\n        }\n        this._eventSizeBytes[type] = byteSize;\n        this._encodeEventType[type] = encodedType;\n        this._decodeEventType[encodedType] = type;\n      });\n      this._parameterCode = 0;\n      this._parameterCodes = {};\n      this._encodeParameterId = {};\n      this._decodeParameterId = {};\n      this.setParameterIds(parameterIds);\n      this._sab = sab;\n      if (maxBytesPerEvent === void 0)\n        maxBytesPerEvent = WamEventRingBuffer2.DefaultExtraBytesPerEvent;\n      else\n        maxBytesPerEvent = Math.max(maxBytesPerEvent, WamEventRingBuffer2.DefaultExtraBytesPerEvent);\n      this._eventBytesAvailable = Math.max(WamEventRingBuffer2.WamAutomationEventBytes, WamEventRingBuffer2.WamTransportEventBytes, WamEventRingBuffer2.WamMidiEventBytes, WamEventRingBuffer2.WamBinaryEventBytes) + maxBytesPerEvent;\n      this._eventBytes = new ArrayBuffer(this._eventBytesAvailable);\n      this._eventBytesView = new DataView(this._eventBytes);\n      this._rb = new RingBuffer2(this._sab, Uint8Array);\n      this._eventSizeArray = new Uint8Array(this._eventBytes, 0, 4);\n      this._eventSizeView = new DataView(this._eventBytes, 0, 4);\n    }\n    _writeHeader(byteSize, type, time) {\n      let byteOffset = 0;\n      this._eventBytesView.setUint32(byteOffset, byteSize);\n      byteOffset += 4;\n      this._eventBytesView.setUint8(byteOffset, this._encodeEventType[type]);\n      byteOffset += 1;\n      this._eventBytesView.setFloat64(byteOffset, Number.isFinite(time) ? time : -1);\n      byteOffset += 8;\n      return byteOffset;\n    }\n    _encode(event) {\n      let byteOffset = 0;\n      const { type, time } = event;\n      switch (event.type) {\n        case \"wam-automation\":\n          {\n            if (!(event.data.id in this._encodeParameterId))\n              break;\n            const byteSize = this._eventSizeBytes[type];\n            byteOffset = this._writeHeader(byteSize, type, time);\n            const { data } = event;\n            const encodedParameterId = this._encodeParameterId[data.id];\n            const { value, normalized } = data;\n            this._eventBytesView.setUint16(byteOffset, encodedParameterId);\n            byteOffset += 2;\n            this._eventBytesView.setFloat64(byteOffset, value);\n            byteOffset += 8;\n            this._eventBytesView.setUint8(byteOffset, normalized ? 1 : 0);\n            byteOffset += 1;\n          }\n          break;\n        case \"wam-transport\":\n          {\n            const byteSize = this._eventSizeBytes[type];\n            byteOffset = this._writeHeader(byteSize, type, time);\n            const { data } = event;\n            const {\n              currentBar,\n              currentBarStarted,\n              tempo,\n              timeSigNumerator,\n              timeSigDenominator,\n              playing\n            } = data;\n            this._eventBytesView.setUint32(byteOffset, currentBar);\n            byteOffset += 4;\n            this._eventBytesView.setFloat64(byteOffset, currentBarStarted);\n            byteOffset += 8;\n            this._eventBytesView.setFloat64(byteOffset, tempo);\n            byteOffset += 8;\n            this._eventBytesView.setUint8(byteOffset, timeSigNumerator);\n            byteOffset += 1;\n            this._eventBytesView.setUint8(byteOffset, timeSigDenominator);\n            byteOffset += 1;\n            this._eventBytesView.setUint8(byteOffset, playing ? 1 : 0);\n            byteOffset += 1;\n          }\n          break;\n        case \"wam-mpe\":\n        case \"wam-midi\":\n          {\n            const byteSize = this._eventSizeBytes[type];\n            byteOffset = this._writeHeader(byteSize, type, time);\n            const { data } = event;\n            const { bytes } = data;\n            let b = 0;\n            while (b < 3) {\n              this._eventBytesView.setUint8(byteOffset, bytes[b]);\n              byteOffset += 1;\n              b++;\n            }\n          }\n          break;\n        case \"wam-osc\":\n        case \"wam-sysex\":\n        case \"wam-info\":\n          {\n            let bytes = null;\n            if (event.type === \"wam-info\") {\n              const { data } = event;\n              bytes = new TextEncoder().encode(data.instanceId);\n            } else {\n              const { data } = event;\n              bytes = data.bytes;\n            }\n            const numBytes = bytes.length;\n            const byteSize = this._eventSizeBytes[type];\n            byteOffset = this._writeHeader(byteSize + numBytes, type, time);\n            this._eventBytesView.setUint32(byteOffset, numBytes);\n            byteOffset += 4;\n            const bytesRequired = byteOffset + numBytes;\n            if (bytesRequired > this._eventBytesAvailable)\n              console.error(`Event requires ${bytesRequired} bytes but only ${this._eventBytesAvailable} have been allocated!`);\n            const buffer = new Uint8Array(this._eventBytes, byteOffset, numBytes);\n            buffer.set(bytes);\n            byteOffset += numBytes;\n          }\n          break;\n        default:\n          break;\n      }\n      return new Uint8Array(this._eventBytes, 0, byteOffset);\n    }\n    _decode() {\n      let byteOffset = 0;\n      const type = this._decodeEventType[this._eventBytesView.getUint8(byteOffset)];\n      byteOffset += 1;\n      let time = this._eventBytesView.getFloat64(byteOffset);\n      if (time === -1)\n        time = void 0;\n      byteOffset += 8;\n      switch (type) {\n        case \"wam-automation\": {\n          const encodedParameterId = this._eventBytesView.getUint16(byteOffset);\n          byteOffset += 2;\n          const value = this._eventBytesView.getFloat64(byteOffset);\n          byteOffset += 8;\n          const normalized = !!this._eventBytesView.getUint8(byteOffset);\n          byteOffset += 1;\n          if (!(encodedParameterId in this._decodeParameterId))\n            break;\n          const id = this._decodeParameterId[encodedParameterId];\n          const event = {\n            type,\n            time,\n            data: {\n              id,\n              value,\n              normalized\n            }\n          };\n          return event;\n        }\n        case \"wam-transport\": {\n          const currentBar = this._eventBytesView.getUint32(byteOffset);\n          byteOffset += 4;\n          const currentBarStarted = this._eventBytesView.getFloat64(byteOffset);\n          byteOffset += 8;\n          const tempo = this._eventBytesView.getFloat64(byteOffset);\n          byteOffset += 8;\n          const timeSigNumerator = this._eventBytesView.getUint8(byteOffset);\n          byteOffset += 1;\n          const timeSigDenominator = this._eventBytesView.getUint8(byteOffset);\n          byteOffset += 1;\n          const playing = this._eventBytesView.getUint8(byteOffset) == 1;\n          byteOffset += 1;\n          const event = {\n            type,\n            time,\n            data: {\n              currentBar,\n              currentBarStarted,\n              tempo,\n              timeSigNumerator,\n              timeSigDenominator,\n              playing\n            }\n          };\n          return event;\n        }\n        case \"wam-mpe\":\n        case \"wam-midi\": {\n          const bytes = [0, 0, 0];\n          let b = 0;\n          while (b < 3) {\n            bytes[b] = this._eventBytesView.getUint8(byteOffset);\n            byteOffset += 1;\n            b++;\n          }\n          const event = {\n            type,\n            time,\n            data: { bytes }\n          };\n          return event;\n        }\n        case \"wam-osc\":\n        case \"wam-sysex\":\n        case \"wam-info\": {\n          const numBytes = this._eventBytesView.getUint32(byteOffset);\n          byteOffset += 4;\n          const bytes = new Uint8Array(numBytes);\n          bytes.set(new Uint8Array(this._eventBytes, byteOffset, numBytes));\n          byteOffset += numBytes;\n          if (type === \"wam-info\") {\n            const instanceId = new TextDecoder().decode(bytes);\n            const data = { instanceId };\n            return { type, time, data };\n          } else {\n            const data = { bytes };\n            return { type, time, data };\n          }\n        }\n        default:\n          break;\n      }\n      return false;\n    }\n    write(...events) {\n      const numEvents = events.length;\n      let bytesAvailable = this._rb.availableWrite;\n      let numSkipped = 0;\n      let i = 0;\n      while (i < numEvents) {\n        const event = events[i];\n        const bytes = this._encode(event);\n        const eventSizeBytes = bytes.byteLength;\n        let bytesWritten = 0;\n        if (bytesAvailable >= eventSizeBytes) {\n          if (eventSizeBytes === 0)\n            numSkipped++;\n          else\n            bytesWritten = this._rb.push(bytes);\n        } else\n          break;\n        bytesAvailable -= bytesWritten;\n        i++;\n      }\n      return i - numSkipped;\n    }\n    read() {\n      if (this._rb.empty)\n        return [];\n      const events = [];\n      let bytesAvailable = this._rb.availableRead;\n      let bytesRead = 0;\n      while (bytesAvailable > 0) {\n        bytesRead = this._rb.pop(this._eventSizeArray);\n        bytesAvailable -= bytesRead;\n        const eventSizeBytes = this._eventSizeView.getUint32(0);\n        const eventBytes = new Uint8Array(this._eventBytes, 0, eventSizeBytes - 4);\n        bytesRead = this._rb.pop(eventBytes);\n        bytesAvailable -= bytesRead;\n        const decodedEvent = this._decode();\n        if (decodedEvent)\n          events.push(decodedEvent);\n      }\n      return events;\n    }\n    setParameterIds(parameterIds) {\n      this._encodeParameterId = {};\n      this._decodeParameterId = {};\n      parameterIds.forEach((parameterId) => {\n        let parameterCode = -1;\n        if (parameterId in this._parameterCodes)\n          parameterCode = this._parameterCodes[parameterId];\n        else {\n          parameterCode = this._generateParameterCode();\n          this._parameterCodes[parameterId] = parameterCode;\n        }\n        this._encodeParameterId[parameterId] = parameterCode;\n        this._decodeParameterId[parameterCode] = parameterId;\n      });\n    }\n    _generateParameterCode() {\n      if (this._parameterCode > 65535)\n        throw Error(\"Too many parameters have been registered!\");\n      return this._parameterCode++;\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    const ModuleScope = audioWorkletGlobalScope.webAudioModules.getModuleScope(moduleId);\n    if (!ModuleScope.WamEventRingBuffer)\n      ModuleScope.WamEventRingBuffer = WamEventRingBuffer2;\n  }\n  return WamEventRingBuffer2;\n};\nvar WamEventRingBuffer_default = getWamEventRingBuffer;\n\n// src/addFunctionModule.js\nvar addFunctionModule = (audioWorklet, processorFunction, ...injection) => {\n  const text = `(${processorFunction.toString()})(${injection.map((s) => JSON.stringify(s)).join(\", \")});`;\n  const url = URL.createObjectURL(new Blob([text], { type: \"text/javascript\" }));\n  return audioWorklet.addModule(url);\n};\nvar addFunctionModule_default = addFunctionModule;\n\n// src/WamParameter.js\nvar getWamParameter = (moduleId) => {\n  const audioWorkletGlobalScope = globalThis;\n  class WamParameter {\n    constructor(info) {\n      this.info = info;\n      this._value = info.defaultValue;\n    }\n    set value(value) {\n      this._value = value;\n    }\n    get value() {\n      return this._value;\n    }\n    set normalizedValue(valueNorm) {\n      this.value = this.info.denormalize(valueNorm);\n    }\n    get normalizedValue() {\n      return this.info.normalize(this.value);\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    const ModuleScope = audioWorkletGlobalScope.webAudioModules.getModuleScope(moduleId);\n    if (!ModuleScope.WamParameter)\n      ModuleScope.WamParameter = WamParameter;\n  }\n  return WamParameter;\n};\nvar WamParameter_default = getWamParameter;\n\n// src/WamParameterInfo.js\nvar getWamParameterInfo = (moduleId) => {\n  const audioWorkletGlobalScope = globalThis;\n  const normExp = (x, e) => e === 0 ? x : x ** 1.5 ** -e;\n  const denormExp = (x, e) => e === 0 ? x : x ** 1.5 ** e;\n  const normalize = (x, min, max, e = 0) => min === 0 && max === 1 ? normExp(x, e) : normExp((x - min) / (max - min) || 0, e);\n  const denormalize = (x, min, max, e = 0) => min === 0 && max === 1 ? denormExp(x, e) : denormExp(x, e) * (max - min) + min;\n  const inRange = (x, min, max) => x >= min && x <= max;\n  class WamParameterInfo {\n    constructor(id, config = {}) {\n      let {\n        type,\n        label,\n        defaultValue,\n        minValue,\n        maxValue,\n        discreteStep,\n        exponent,\n        choices,\n        units\n      } = config;\n      if (type === void 0)\n        type = \"float\";\n      if (label === void 0)\n        label = \"\";\n      if (defaultValue === void 0)\n        defaultValue = 0;\n      if (choices === void 0)\n        choices = [];\n      if (type === \"boolean\" || type === \"choice\") {\n        discreteStep = 1;\n        minValue = 0;\n        if (choices.length)\n          maxValue = choices.length - 1;\n        else\n          maxValue = 1;\n      } else {\n        if (minValue === void 0)\n          minValue = 0;\n        if (maxValue === void 0)\n          maxValue = 1;\n        if (discreteStep === void 0)\n          discreteStep = 0;\n        if (exponent === void 0)\n          exponent = 0;\n        if (units === void 0)\n          units = \"\";\n      }\n      const errBase = `Param config error | ${id}: `;\n      if (minValue >= maxValue)\n        throw Error(errBase.concat(\"minValue must be less than maxValue\"));\n      if (!inRange(defaultValue, minValue, maxValue))\n        throw Error(errBase.concat(\"defaultValue out of range\"));\n      if (discreteStep % 1 || discreteStep < 0) {\n        throw Error(errBase.concat(\"discreteStep must be a non-negative integer\"));\n      } else if (discreteStep > 0 && (minValue % 1 || maxValue % 1 || defaultValue % 1)) {\n        throw Error(errBase.concat(\"non-zero discreteStep requires integer minValue, maxValue, and defaultValue\"));\n      }\n      if (type === \"choice\" && !choices.length) {\n        throw Error(errBase.concat(\"choice type parameter requires list of strings in choices\"));\n      }\n      this.id = id;\n      this.label = label;\n      this.type = type;\n      this.defaultValue = defaultValue;\n      this.minValue = minValue;\n      this.maxValue = maxValue;\n      this.discreteStep = discreteStep;\n      this.exponent = exponent;\n      this.choices = choices;\n      this.units = units;\n    }\n    normalize(value) {\n      return normalize(value, this.minValue, this.maxValue, this.exponent);\n    }\n    denormalize(valueNorm) {\n      return denormalize(valueNorm, this.minValue, this.maxValue, this.exponent);\n    }\n    valueString(value) {\n      if (this.choices)\n        return this.choices[value];\n      if (this.units !== \"\")\n        return `${value} ${this.units}`;\n      return `${value}`;\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    const ModuleScope = audioWorkletGlobalScope.webAudioModules.getModuleScope(moduleId);\n    if (!ModuleScope.WamParameterInfo)\n      ModuleScope.WamParameterInfo = WamParameterInfo;\n  }\n  return WamParameterInfo;\n};\nvar WamParameterInfo_default = getWamParameterInfo;\n\n// src/WamParameterInterpolator.js\nvar getWamParameterInterpolator = (moduleId) => {\n  const audioWorkletGlobalScope = globalThis;\n  const samplesPerQuantum = 128;\n  const nullTableKey = \"0_0\";\n  class WamParameterInterpolator {\n    static _tables;\n    static _tableReferences;\n    constructor(info, samplesPerInterpolation, skew = 0) {\n      if (!WamParameterInterpolator._tables) {\n        WamParameterInterpolator._tables = { nullTableKey: new Float32Array(0) };\n        WamParameterInterpolator._tableReferences = { nullTableKey: [] };\n      }\n      this.info = info;\n      this.values = new Float32Array(samplesPerQuantum);\n      this._tableKey = nullTableKey;\n      this._table = WamParameterInterpolator._tables[this._tableKey];\n      this._skew = 2;\n      const { discreteStep } = info;\n      this._discrete = !!discreteStep;\n      this._N = this._discrete ? 0 : samplesPerInterpolation;\n      this._n = 0;\n      this._startValue = info.defaultValue;\n      this._endValue = info.defaultValue;\n      this._currentValue = info.defaultValue;\n      this._deltaValue = 0;\n      this._inverted = false;\n      this._changed = true;\n      this._filled = 0;\n      if (!this._discrete)\n        this.setSkew(skew);\n      else\n        this._skew = 0;\n      this.setStartValue(this._startValue);\n    }\n    _removeTableReference(oldKey) {\n      if (oldKey === nullTableKey)\n        return;\n      const { id } = this.info;\n      const references = WamParameterInterpolator._tableReferences[oldKey];\n      if (references) {\n        const index = references.indexOf(id);\n        if (index !== -1)\n          references.splice(index, 1);\n        if (references.length === 0) {\n          delete WamParameterInterpolator._tables[oldKey];\n          delete WamParameterInterpolator._tableReferences[oldKey];\n        }\n      }\n    }\n    setSkew(skew) {\n      if (this._skew === skew || this._discrete)\n        return;\n      if (skew < -1 || skew > 1)\n        throw Error(\"skew must be in range [-1.0, 1.0]\");\n      const newKey = [this._N, skew].join(\"_\");\n      const oldKey = this._tableKey;\n      const { id } = this.info;\n      if (newKey === oldKey)\n        return;\n      if (WamParameterInterpolator._tables[newKey]) {\n        const references = WamParameterInterpolator._tableReferences[newKey];\n        if (references)\n          references.push(id);\n        else\n          WamParameterInterpolator._tableReferences[newKey] = [id];\n      } else {\n        let e = Math.abs(skew);\n        e = Math.pow(3 - e, e * (e + 2));\n        const linear = e === 1;\n        const N = this._N;\n        const table = new Float32Array(N + 1);\n        if (linear)\n          for (let n = 0; n <= N; ++n)\n            table[n] = n / N;\n        else\n          for (let n = 0; n <= N; ++n)\n            table[n] = (n / N) ** e;\n        WamParameterInterpolator._tables[newKey] = table;\n        WamParameterInterpolator._tableReferences[newKey] = [id];\n      }\n      this._removeTableReference(oldKey);\n      this._skew = skew;\n      this._tableKey = newKey;\n      this._table = WamParameterInterpolator._tables[this._tableKey];\n    }\n    setStartValue(value, fill = true) {\n      this._n = this._N;\n      this._startValue = value;\n      this._endValue = value;\n      this._currentValue = value;\n      this._deltaValue = 0;\n      this._inverted = false;\n      if (fill) {\n        this.values.fill(value);\n        this._changed = true;\n        this._filled = this.values.length;\n      } else {\n        this._changed = false;\n        this._filled = 0;\n      }\n    }\n    setEndValue(value) {\n      if (value === this._endValue)\n        return;\n      this._n = 0;\n      this._startValue = this._currentValue;\n      this._endValue = value;\n      this._deltaValue = this._endValue - this._startValue;\n      this._inverted = this._deltaValue > 0 && this._skew >= 0 || this._deltaValue <= 0 && this._skew < 0;\n      this._changed = false;\n      this._filled = 0;\n    }\n    process(startSample, endSample) {\n      if (this.done)\n        return;\n      const length = endSample - startSample;\n      let fill = 0;\n      const change = this._N - this._n;\n      if (this._discrete || !change)\n        fill = length;\n      else {\n        if (change < length) {\n          fill = Math.min(length - change, samplesPerQuantum);\n          endSample -= fill;\n        }\n        if (endSample > startSample) {\n          if (this._inverted) {\n            for (let i = startSample; i < endSample; ++i) {\n              const tableValue = 1 - this._table[this._N - ++this._n];\n              this.values[i] = this._startValue + tableValue * this._deltaValue;\n            }\n          } else {\n            for (let i = startSample; i < endSample; ++i) {\n              const tableValue = this._table[++this._n];\n              this.values[i] = this._startValue + tableValue * this._deltaValue;\n            }\n          }\n        }\n        if (fill > 0) {\n          startSample = endSample;\n          endSample += fill;\n        }\n      }\n      if (fill > 0) {\n        this.values.fill(this._endValue, startSample, endSample);\n        this._filled += fill;\n      }\n      this._currentValue = this.values[endSample - 1];\n      if (this._n === this._N) {\n        if (!this._changed)\n          this._changed = true;\n        else if (this._filled >= this.values.length) {\n          this.setStartValue(this._endValue, false);\n          this._changed = true;\n          this._filled = this.values.length;\n        }\n      }\n    }\n    get done() {\n      return this._changed && this._filled === this.values.length;\n    }\n    is(value) {\n      return this._endValue === value && this.done;\n    }\n    destroy() {\n      this._removeTableReference(this._tableKey);\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    const ModuleScope = audioWorkletGlobalScope.webAudioModules.getModuleScope(moduleId);\n    if (!ModuleScope.WamParameterInterpolator)\n      ModuleScope.WamParameterInterpolator = WamParameterInterpolator;\n  }\n  return WamParameterInterpolator;\n};\nvar WamParameterInterpolator_default = getWamParameterInterpolator;\n\n// src/WamProcessor.js\nvar getWamProcessor = (moduleId) => {\n  const audioWorkletGlobalScope = globalThis;\n  const {\n    AudioWorkletProcessor,\n    webAudioModules\n  } = audioWorkletGlobalScope;\n  const ModuleScope = audioWorkletGlobalScope.webAudioModules.getModuleScope(moduleId);\n  const {\n    RingBuffer: RingBuffer2,\n    WamEventRingBuffer: WamEventRingBuffer2,\n    WamParameter,\n    WamParameterInterpolator\n  } = ModuleScope;\n  class WamProcessor extends AudioWorkletProcessor {\n    constructor(options) {\n      super();\n      const {\n        groupId,\n        moduleId: moduleId2,\n        instanceId,\n        useSab\n      } = options.processorOptions;\n      if (!moduleId2)\n        throw Error(\"must provide moduleId argument in processorOptions!\");\n      if (!instanceId)\n        throw Error(\"must provide instanceId argument in processorOptions!\");\n      this.groupId = groupId;\n      this.moduleId = moduleId2;\n      this.instanceId = instanceId;\n      this._samplesPerQuantum = 128;\n      this._compensationDelay = 0;\n      this._parameterInfo = {};\n      this._parameterState = {};\n      this._parameterInterpolators = {};\n      this._eventQueue = [];\n      this._pendingResponses = {};\n      this._useSab = !!useSab && !!globalThis.SharedArrayBuffer;\n      this._eventSabReady = false;\n      this._audioToMainEventSab = null;\n      this._mainToAudioEventSab = null;\n      this._eventWriter = null;\n      this._eventReader = null;\n      this._initialized = false;\n      this._destroyed = false;\n      webAudioModules.addWam(this);\n      this.port.onmessage = this._onMessage.bind(this);\n      if (this._useSab)\n        this._configureSab();\n    }\n    getCompensationDelay() {\n      return this._compensationDelay;\n    }\n    scheduleEvents(...events) {\n      let i = 0;\n      while (i < events.length) {\n        this._eventQueue.push({ id: 0, event: events[i] });\n        i++;\n      }\n    }\n    emitEvents(...events) {\n      webAudioModules.emitEvents(this, ...events);\n    }\n    clearEvents() {\n      this._eventQueue = [];\n    }\n    process(inputs, outputs, parameters) {\n      if (!this._initialized)\n        return true;\n      if (this._destroyed)\n        return false;\n      if (this._eventSabReady)\n        this.scheduleEvents(...this._eventReader.read());\n      const processingSlices = this._getProcessingSlices();\n      let i = 0;\n      while (i < processingSlices.length) {\n        const { range, events } = processingSlices[i];\n        const [startSample, endSample] = range;\n        let j = 0;\n        while (j < events.length) {\n          this._processEvent(events[j]);\n          j++;\n        }\n        this._interpolateParameterValues(startSample, endSample);\n        this._process(startSample, endSample, inputs, outputs, parameters);\n        i++;\n      }\n      return true;\n    }\n    destroy() {\n      this._destroyed = true;\n      this.port.close();\n      webAudioModules.removeWam(this);\n    }\n    _generateWamParameterInfo() {\n      return {};\n    }\n    _initialize() {\n      this._parameterState = {};\n      this._parameterInterpolators = {};\n      this._parameterInfo = this._generateWamParameterInfo();\n      Object.keys(this._parameterInfo).forEach((parameterId) => {\n        const info = this._parameterInfo[parameterId];\n        this._parameterState[parameterId] = new WamParameter(this._parameterInfo[parameterId]);\n        this._parameterInterpolators[parameterId] = new WamParameterInterpolator(info, 256);\n      });\n    }\n    _configureSab() {\n      const eventCapacity = 2 ** 10;\n      const parameterIds = Object.keys(this._parameterInfo);\n      if (this._eventSabReady) {\n        this._eventWriter.setParameterIds(parameterIds);\n        this._eventReader.setParameterIds(parameterIds);\n      }\n      this.port.postMessage({ eventSab: { eventCapacity, parameterIds } });\n    }\n    async _onMessage(message) {\n      if (message.data.request) {\n        const {\n          id,\n          request,\n          content\n        } = message.data;\n        const response = { id, response: request };\n        const requestComponents = request.split(\"/\");\n        const verb = requestComponents[0];\n        const noun = requestComponents[1];\n        response.content = \"error\";\n        if (verb === \"get\") {\n          if (noun === \"parameterInfo\") {\n            let { parameterIds } = content;\n            if (!parameterIds.length)\n              parameterIds = Object.keys(this._parameterInfo);\n            const parameterInfo = {};\n            let i = 0;\n            while (i < parameterIds.length) {\n              const parameterId = parameterIds[i];\n              parameterInfo[parameterId] = this._parameterInfo[parameterId];\n              i++;\n            }\n            response.content = parameterInfo;\n          } else if (noun === \"parameterValues\") {\n            let { normalized, parameterIds } = content;\n            response.content = this._getParameterValues(normalized, parameterIds);\n          } else if (noun === \"state\") {\n            response.content = this._getState();\n          } else if (noun === \"compensationDelay\") {\n            response.content = this.getCompensationDelay();\n          }\n        } else if (verb === \"set\") {\n          if (noun === \"parameterValues\") {\n            const { parameterValues } = content;\n            this._setParameterValues(parameterValues, true);\n            delete response.content;\n          } else if (noun === \"state\") {\n            const { state } = content;\n            this._setState(state);\n            delete response.content;\n          }\n        } else if (verb === \"add\") {\n          if (noun === \"event\") {\n            const { event } = content;\n            this._eventQueue.push({ id, event });\n            return;\n          }\n        } else if (verb === \"remove\") {\n          if (noun === \"events\") {\n            const ids = this._eventQueue.map((queued) => queued.id);\n            this.clearEvents();\n            response.content = ids;\n          }\n        } else if (verb === \"connect\") {\n          if (noun === \"events\") {\n            const { wamInstanceId, output } = content;\n            this._connectEvents(wamInstanceId, output);\n            delete response.content;\n          }\n        } else if (verb === \"disconnect\") {\n          if (noun === \"events\") {\n            const { wamInstanceId, output } = content;\n            this._disconnectEvents(wamInstanceId, output);\n            delete response.content;\n          }\n        } else if (verb === \"initialize\") {\n          if (noun === \"processor\") {\n            this._initialize();\n            this._initialized = true;\n            delete response.content;\n          } else if (noun === \"eventSab\") {\n            const { mainToAudioEventSab, audioToMainEventSab } = content;\n            this._audioToMainEventSab = audioToMainEventSab;\n            this._mainToAudioEventSab = mainToAudioEventSab;\n            const parameterIds = Object.keys(this._parameterInfo);\n            this._eventWriter = new WamEventRingBuffer2(RingBuffer2, this._audioToMainEventSab, parameterIds);\n            this._eventReader = new WamEventRingBuffer2(RingBuffer2, this._mainToAudioEventSab, parameterIds);\n            this._eventSabReady = true;\n            delete response.content;\n          }\n        }\n        this.port.postMessage(response);\n      } else if (message.data.destroy) {\n        this.destroy();\n      }\n    }\n    _onTransport(transportData) {\n      console.error(\"_onTransport not implemented!\");\n    }\n    _onMidi(midiData) {\n      console.error(\"_onMidi not implemented!\");\n    }\n    _onSysex(sysexData) {\n      console.error(\"_onMidi not implemented!\");\n    }\n    _onMpe(mpeData) {\n      console.error(\"_onMpe not implemented!\");\n    }\n    _onOsc(oscData) {\n      console.error(\"_onOsc not implemented!\");\n    }\n    _setState(state) {\n      if (state.parameterValues)\n        this._setParameterValues(state.parameterValues, false);\n    }\n    _getState() {\n      return { parameterValues: this._getParameterValues(false) };\n    }\n    _getParameterValues(normalized, parameterIds) {\n      const parameterValues = {};\n      if (!parameterIds || !parameterIds.length)\n        parameterIds = Object.keys(this._parameterState);\n      let i = 0;\n      while (i < parameterIds.length) {\n        const id = parameterIds[i];\n        const parameter = this._parameterState[id];\n        parameterValues[id] = {\n          id,\n          value: normalized ? parameter.normalizedValue : parameter.value,\n          normalized\n        };\n        i++;\n      }\n      return parameterValues;\n    }\n    _setParameterValues(parameterUpdates, interpolate) {\n      const parameterIds = Object.keys(parameterUpdates);\n      let i = 0;\n      while (i < parameterIds.length) {\n        this._setParameterValue(parameterUpdates[parameterIds[i]], interpolate);\n        i++;\n      }\n    }\n    _setParameterValue(parameterUpdate, interpolate) {\n      const { id, value, normalized } = parameterUpdate;\n      const parameter = this._parameterState[id];\n      if (!parameter)\n        return;\n      if (!normalized)\n        parameter.value = value;\n      else\n        parameter.normalizedValue = value;\n      const interpolator = this._parameterInterpolators[id];\n      if (interpolate)\n        interpolator.setEndValue(parameter.value);\n      else\n        interpolator.setStartValue(parameter.value);\n    }\n    _interpolateParameterValues(startIndex, endIndex) {\n      const parameterIds = Object.keys(this._parameterInterpolators);\n      let i = 0;\n      while (i < parameterIds.length) {\n        this._parameterInterpolators[parameterIds[i]].process(startIndex, endIndex);\n        i++;\n      }\n    }\n    _connectEvents(wamInstanceId, output) {\n      webAudioModules.connectEvents(this.groupId, this.instanceId, wamInstanceId, output);\n    }\n    _disconnectEvents(wamInstanceId, output) {\n      if (typeof wamInstanceId === \"undefined\") {\n        webAudioModules.disconnectEvents(this.groupId, this.instanceId);\n        return;\n      }\n      webAudioModules.disconnectEvents(this.groupId, this.instanceId, wamInstanceId, output);\n    }\n    _getProcessingSlices() {\n      const response = \"add/event\";\n      const { currentTime, sampleRate } = audioWorkletGlobalScope;\n      const eventsBySampleIndex = {};\n      let i = 0;\n      while (i < this._eventQueue.length) {\n        const { id, event } = this._eventQueue[i];\n        const offsetSec = event.time - currentTime;\n        const sampleIndex = offsetSec > 0 ? Math.round(offsetSec * sampleRate) : 0;\n        if (sampleIndex < this._samplesPerQuantum) {\n          if (eventsBySampleIndex[sampleIndex])\n            eventsBySampleIndex[sampleIndex].push(event);\n          else\n            eventsBySampleIndex[sampleIndex] = [event];\n          if (id)\n            this.port.postMessage({ id, response });\n          else if (this._eventSabReady)\n            this._eventWriter.write(event);\n          else\n            this.port.postMessage({ event });\n          this._eventQueue.shift();\n          i = -1;\n        } else\n          break;\n        i++;\n      }\n      const processingSlices = [];\n      const keys = Object.keys(eventsBySampleIndex);\n      if (keys[0] !== \"0\") {\n        keys.unshift(\"0\");\n        eventsBySampleIndex[\"0\"] = [];\n      }\n      const lastIndex = keys.length - 1;\n      i = 0;\n      while (i < keys.length) {\n        const key = keys[i];\n        const startSample = parseInt(key);\n        const endSample = i < lastIndex ? parseInt(keys[i + 1]) : this._samplesPerQuantum;\n        processingSlices.push({ range: [startSample, endSample], events: eventsBySampleIndex[key] });\n        i++;\n      }\n      return processingSlices;\n    }\n    _processEvent(event) {\n      switch (event.type) {\n        case \"wam-automation\":\n          this._setParameterValue(event.data, true);\n          break;\n        case \"wam-transport\":\n          this._onTransport(event.data);\n          break;\n        case \"wam-midi\":\n          this._onMidi(event.data);\n          break;\n        case \"wam-sysex\":\n          this._onSysex(event.data);\n          break;\n        case \"wam-mpe\":\n          this._onMpe(event.data);\n          break;\n        case \"wam-osc\":\n          this._onOsc(event.data);\n          break;\n        default:\n          break;\n      }\n    }\n    _process(startSample, endSample, inputs, outputs, parameters) {\n      console.error(\"_process not implemented!\");\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    if (!ModuleScope.WamProcessor)\n      ModuleScope.WamProcessor = WamProcessor;\n  }\n  return WamProcessor;\n};\nvar WamProcessor_default = getWamProcessor;\n\n// src/WamNode.js\nvar RingBuffer = RingBuffer_default();\nvar WamEventRingBuffer = WamEventRingBuffer_default();\nvar WamNode = class extends AudioWorkletNode {\n  static async addModules(audioContext, moduleId) {\n    const { audioWorklet } = audioContext;\n    await addFunctionModule_default(audioWorklet, RingBuffer_default, moduleId);\n    await addFunctionModule_default(audioWorklet, WamEventRingBuffer_default, moduleId);\n    await addFunctionModule_default(audioWorklet, WamArrayRingBuffer_default, moduleId);\n    await addFunctionModule_default(audioWorklet, WamParameter_default, moduleId);\n    await addFunctionModule_default(audioWorklet, WamParameterInfo_default, moduleId);\n    await addFunctionModule_default(audioWorklet, WamParameterInterpolator_default, moduleId);\n    await addFunctionModule_default(audioWorklet, WamProcessor_default, moduleId);\n  }\n  constructor(module, options) {\n    const { audioContext, groupId, moduleId, instanceId } = module;\n    options.processorOptions = {\n      groupId,\n      moduleId,\n      instanceId,\n      ...options.processorOptions\n    };\n    super(audioContext, moduleId, options);\n    this.module = module;\n    this._supportedEventTypes = /* @__PURE__ */ new Set([\"wam-automation\", \"wam-transport\", \"wam-midi\", \"wam-sysex\", \"wam-mpe\", \"wam-osc\"]);\n    this._messageId = 1;\n    this._pendingResponses = {};\n    this._pendingEvents = {};\n    this._useSab = false;\n    this._eventSabReady = false;\n    this._destroyed = false;\n    this.port.onmessage = this._onMessage.bind(this);\n  }\n  get groupId() {\n    return this.module.groupId;\n  }\n  get moduleId() {\n    return this.module.moduleId;\n  }\n  get instanceId() {\n    return this.module.instanceId;\n  }\n  async getParameterInfo(...parameterIds) {\n    const request = \"get/parameterInfo\";\n    const id = this._generateMessageId();\n    return new Promise((resolve) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({\n        id,\n        request,\n        content: { parameterIds }\n      });\n    });\n  }\n  async getParameterValues(normalized, ...parameterIds) {\n    const request = \"get/parameterValues\";\n    const id = this._generateMessageId();\n    return new Promise((resolve) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({\n        id,\n        request,\n        content: { normalized, parameterIds }\n      });\n    });\n  }\n  async setParameterValues(parameterValues) {\n    const request = \"set/parameterValues\";\n    const id = this._generateMessageId();\n    return new Promise((resolve) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({\n        id,\n        request,\n        content: { parameterValues }\n      });\n    });\n  }\n  async getState() {\n    const request = \"get/state\";\n    const id = this._generateMessageId();\n    return new Promise((resolve) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({ id, request });\n    });\n  }\n  async setState(state) {\n    const request = \"set/state\";\n    const id = this._generateMessageId();\n    return new Promise((resolve) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({\n        id,\n        request,\n        content: { state }\n      });\n    });\n  }\n  async getCompensationDelay() {\n    const request = \"get/compensationDelay\";\n    const id = this._generateMessageId();\n    return new Promise((resolve) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({ id, request });\n    });\n  }\n  addEventListener(type, callback, options) {\n    if (this._supportedEventTypes.has(type))\n      super.addEventListener(type, callback, options);\n  }\n  removeEventListener(type, callback, options) {\n    if (this._supportedEventTypes.has(type))\n      super.removeEventListener(type, callback, options);\n  }\n  scheduleEvents(...events) {\n    let i = 0;\n    const numEvents = events.length;\n    if (this._eventSabReady) {\n      i = this._eventWriter.write(...events);\n    }\n    while (i < numEvents) {\n      const event = events[i];\n      const request = \"add/event\";\n      const id = this._generateMessageId();\n      let processed = false;\n      new Promise((resolve, reject) => {\n        this._pendingResponses[id] = resolve;\n        this._pendingEvents[id] = () => {\n          if (!processed)\n            reject();\n        };\n        this.port.postMessage({\n          id,\n          request,\n          content: { event }\n        });\n      }).then((resolved) => {\n        processed = true;\n        delete this._pendingEvents[id];\n        this._onEvent(event);\n      }).catch((rejected) => {\n        delete this._pendingResponses[id];\n      });\n      i++;\n    }\n  }\n  async clearEvents() {\n    const request = \"remove/events\";\n    const id = this._generateMessageId();\n    const ids = Object.keys(this._pendingEvents);\n    if (ids.length) {\n      return new Promise((resolve) => {\n        this._pendingResponses[id] = resolve;\n        this.port.postMessage({ id, request });\n      }).then((clearedIds) => {\n        clearedIds.forEach((clearedId) => {\n          this._pendingEvents[clearedId]();\n          delete this._pendingEvents[clearedId];\n        });\n      });\n    }\n  }\n  connectEvents(toId, output) {\n    const request = \"connect/events\";\n    const id = this._generateMessageId();\n    new Promise((resolve, reject) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({\n        id,\n        request,\n        content: { wamInstanceId: toId, output }\n      });\n    });\n  }\n  disconnectEvents(toId, output) {\n    const request = \"disconnect/events\";\n    const id = this._generateMessageId();\n    new Promise((resolve, reject) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({\n        id,\n        request,\n        content: { wamInstanceId: toId, output }\n      });\n    });\n  }\n  destroy() {\n    if (this._audioToMainInterval)\n      clearInterval(this._audioToMainInterval);\n    this.port.postMessage({ destroy: true });\n    this.port.close();\n    this.disconnect();\n    this._destroyed = true;\n  }\n  _generateMessageId() {\n    return this._messageId++;\n  }\n  async _initialize() {\n    const request = \"initialize/processor\";\n    const id = this._generateMessageId();\n    return new Promise((resolve) => {\n      this._pendingResponses[id] = resolve;\n      this.port.postMessage({ id, request });\n    });\n  }\n  _onMessage(message) {\n    const { data } = message;\n    const { response, event, eventSab } = data;\n    if (response) {\n      const { id, content } = data;\n      const resolvePendingResponse = this._pendingResponses[id];\n      if (resolvePendingResponse) {\n        delete this._pendingResponses[id];\n        resolvePendingResponse(content);\n      }\n    } else if (eventSab) {\n      this._useSab = true;\n      const { eventCapacity, parameterIds } = eventSab;\n      if (this._eventSabReady) {\n        this._eventWriter.setParameterIds(parameterIds);\n        this._eventReader.setParameterIds(parameterIds);\n        return;\n      }\n      this._mainToAudioEventSab = WamEventRingBuffer.getStorageForEventCapacity(RingBuffer, eventCapacity);\n      this._audioToMainEventSab = WamEventRingBuffer.getStorageForEventCapacity(RingBuffer, eventCapacity);\n      this._eventWriter = new WamEventRingBuffer(RingBuffer, this._mainToAudioEventSab, parameterIds);\n      this._eventReader = new WamEventRingBuffer(RingBuffer, this._audioToMainEventSab, parameterIds);\n      const request = \"initialize/eventSab\";\n      const id = this._generateMessageId();\n      new Promise((resolve, reject) => {\n        this._pendingResponses[id] = resolve;\n        this.port.postMessage({\n          id,\n          request,\n          content: {\n            mainToAudioEventSab: this._mainToAudioEventSab,\n            audioToMainEventSab: this._audioToMainEventSab\n          }\n        });\n      }).then((resolved) => {\n        this._eventSabReady = true;\n        this._audioToMainInterval = setInterval(() => {\n          const events = this._eventReader.read();\n          events.forEach((e) => {\n            this._onEvent(e);\n          });\n        }, 100);\n      });\n    } else if (event)\n      this._onEvent(event);\n  }\n  _onEvent(event) {\n    const { type } = event;\n    this.dispatchEvent(new CustomEvent(type, {\n      bubbles: true,\n      detail: event\n    }));\n  }\n};\n\n// src/apiVersion.js\nvar apiVersion_default = \"2.0.0-alpha.4\";\n\n// src/initializeWamHost.js\nvar initializeWamHost = async (audioContext, hostGroupId = `wam-host-${performance.now().toString()}`, hostGroupKey = performance.now().toString()) => {\n  await addFunctionModule_default(audioContext.audioWorklet, WamEnv_default, apiVersion_default);\n  await addFunctionModule_default(audioContext.audioWorklet, WamGroup_default, hostGroupId, hostGroupKey);\n  return [hostGroupId, hostGroupKey];\n};\nvar initializeWamHost_default = initializeWamHost;\nexport {\n  WamNode,\n  WebAudioModule_default as WebAudioModule,\n  addFunctionModule_default as addFunctionModule,\n  apiVersion_default as apiVersion,\n  RingBuffer_default as getRingBuffer,\n  WamArrayRingBuffer_default as getWamArrayRingBuffer,\n  WamEventRingBuffer_default as getWamEventRingBuffer,\n  WamParameter_default as getWamParameter,\n  WamParameterInfo_default as getWamParameterInfo,\n  WamParameterInterpolator_default as getWamParameterInterpolator,\n  WamProcessor_default as getWamProcessor,\n  WamEnv_default as initializeWamEnv,\n  WamGroup_default as initializeWamGroup,\n  initializeWamHost_default as initializeWamHost\n};\n//# sourceMappingURL=index.js.map\n","var __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\n\n// src/CompositeAudioNode.js\nvar CompositeAudioNode = class extends GainNode {\n  constructor() {\n    super(...arguments);\n    __publicField(this, \"_output\");\n    __publicField(this, \"_wamNode\");\n  }\n  get groupId() {\n    return this._wamNode.groupId;\n  }\n  get moduleId() {\n    return this._wamNode.moduleId;\n  }\n  get instanceId() {\n    return this._wamNode.instanceId;\n  }\n  get module() {\n    return this._wamNode.module;\n  }\n  addEventListener(...args) {\n    return this._wamNode.addEventListener(...args);\n  }\n  removeEventListener(...args) {\n    return this._wamNode.removeEventListener(...args);\n  }\n  dispatchEvent(...args) {\n    return this._wamNode.dispatchEvent(...args);\n  }\n  getParameterInfo(...args) {\n    return this._wamNode.getParameterInfo(...args);\n  }\n  getParameterValues(...args) {\n    return this._wamNode.getParameterValues(...args);\n  }\n  setParameterValues(...args) {\n    return this._wamNode.setParameterValues(...args);\n  }\n  getState() {\n    return this._wamNode.getState();\n  }\n  setState(...args) {\n    return this._wamNode.setState(...args);\n  }\n  getCompensationDelay() {\n    return this._wamNode.getCompensationDelay();\n  }\n  scheduleEvents(...args) {\n    return this._wamNode.scheduleEvents(...args);\n  }\n  clearEvents() {\n    return this._wamNode.clearEvents();\n  }\n  connectEvents(...args) {\n    return this._wamNode.connectEvents(...args);\n  }\n  disconnectEvents(...args) {\n    return this._wamNode.disconnectEvents(...args);\n  }\n  destroy() {\n    return this._wamNode.destroy();\n  }\n  set channelCount(count) {\n    if (this._output)\n      this._output.channelCount = count;\n    else\n      super.channelCount = count;\n  }\n  get channelCount() {\n    if (this._output)\n      return this._output.channelCount;\n    return super.channelCount;\n  }\n  set channelCountMode(mode) {\n    if (this._output)\n      this._output.channelCountMode = mode;\n    else\n      super.channelCountMode = mode;\n  }\n  get channelCountMode() {\n    if (this._output)\n      return this._output.channelCountMode;\n    return super.channelCountMode;\n  }\n  set channelInterpretation(interpretation) {\n    if (this._output)\n      this._output.channelInterpretation = interpretation;\n    else\n      super.channelInterpretation = interpretation;\n  }\n  get channelInterpretation() {\n    if (this._output)\n      return this._output.channelInterpretation;\n    return super.channelInterpretation;\n  }\n  get numberOfInputs() {\n    return super.numberOfInputs;\n  }\n  get numberOfOutputs() {\n    if (this._output)\n      return this._output.numberOfOutputs;\n    return super.numberOfOutputs;\n  }\n  get gain() {\n    return void 0;\n  }\n  connect(...args) {\n    if (this._output && this._output !== this)\n      return this._output.connect(...args);\n    return super.connect(...args);\n  }\n  disconnect(...args) {\n    if (this._output && this._output !== this)\n      return this._output.disconnect(...args);\n    return super.disconnect(...args);\n  }\n};\n\n// src/sdk/src/addFunctionModule.js\nvar addFunctionModule = (audioWorklet, processorFunction, ...injection) => {\n  const text = `(${processorFunction.toString()})(${injection.map((s) => JSON.stringify(s)).join(\", \")});`;\n  const url = URL.createObjectURL(new Blob([text], { type: \"text/javascript\" }));\n  return audioWorklet.addModule(url);\n};\nvar addFunctionModule_default = addFunctionModule;\n\n// src/ParamMgrProcessor.js\nvar processor = (moduleId, paramsConfig) => {\n  const audioWorkletGlobalScope = globalThis;\n  const {\n    AudioWorkletProcessor,\n    registerProcessor,\n    webAudioModules\n  } = audioWorkletGlobalScope;\n  const supportSharedArrayBuffer = !!globalThis.SharedArrayBuffer;\n  const SharedArrayBuffer = globalThis.SharedArrayBuffer || globalThis.ArrayBuffer;\n  const normExp = (x, e) => e === 0 ? x : x ** 1.5 ** -e;\n  const normalizeE = (x, min, max, e = 0) => min === 0 && max === 1 ? normExp(x, e) : normExp((x - min) / (max - min) || 0, e);\n  const normalize = (x, min, max) => min === 0 && max === 1 ? x : (x - min) / (max - min) || 0;\n  const denormalize = (x, min, max) => min === 0 && max === 1 ? x : x * (max - min) + min;\n  const mapValue = (x, eMin, eMax, sMin, sMax, tMin, tMax) => denormalize(normalize(normalize(Math.min(sMax, Math.max(sMin, x)), eMin, eMax), normalize(sMin, eMin, eMax), normalize(sMax, eMin, eMax)), tMin, tMax);\n  class ParamMgrProcessor extends AudioWorkletProcessor {\n    static get parameterDescriptors() {\n      return Object.entries(paramsConfig).map(([name, { defaultValue, minValue, maxValue }]) => ({\n        name,\n        defaultValue,\n        minValue,\n        maxValue\n      }));\n    }\n    constructor(options) {\n      super();\n      this.destroyed = false;\n      this.supportSharedArrayBuffer = supportSharedArrayBuffer;\n      const {\n        paramsMapping,\n        internalParamsMinValues,\n        internalParams,\n        groupId,\n        instanceId\n      } = options.processorOptions;\n      this.groupId = groupId;\n      this.moduleId = moduleId;\n      this.instanceId = instanceId;\n      this.internalParamsMinValues = internalParamsMinValues;\n      this.paramsConfig = paramsConfig;\n      this.paramsMapping = paramsMapping;\n      this.paramsValues = {};\n      Object.entries(paramsConfig).forEach(([name, { defaultValue }]) => {\n        this.paramsValues[name] = defaultValue;\n      });\n      this.internalParams = internalParams;\n      this.internalParamsCount = this.internalParams.length;\n      this.buffer = new SharedArrayBuffer((this.internalParamsCount + 1) * Float32Array.BYTES_PER_ELEMENT);\n      this.$lock = new Int32Array(this.buffer, 0, 1);\n      this.$internalParamsBuffer = new Float32Array(this.buffer, 4, this.internalParamsCount);\n      this.eventQueue = [];\n      this.handleEvent = null;\n      audioWorkletGlobalScope.webAudioModules.addWam(this);\n      this.messagePortRequestId = -1;\n      const resolves = {};\n      const rejects = {};\n      this.call = (call, ...args) => new Promise((resolve, reject) => {\n        const id = this.messagePortRequestId--;\n        resolves[id] = resolve;\n        rejects[id] = reject;\n        this.port.postMessage({ id, call, args });\n      });\n      this.handleMessage = ({ data }) => {\n        var _a, _b;\n        const { id, call, args, value, error } = data;\n        if (call) {\n          const r = { id };\n          try {\n            r.value = this[call](...args);\n          } catch (e) {\n            r.error = e;\n          }\n          this.port.postMessage(r);\n        } else {\n          if (error)\n            (_a = rejects[id]) == null ? void 0 : _a.call(rejects, error);\n          else if (resolves[id])\n            (_b = resolves[id]) == null ? void 0 : _b.call(resolves, value);\n          delete resolves[id];\n          delete rejects[id];\n        }\n      };\n      this.port.start();\n      this.port.addEventListener(\"message\", this.handleMessage);\n    }\n    setParamsMapping(mapping) {\n      this.paramsMapping = mapping;\n    }\n    getBuffer() {\n      return { lock: this.$lock, paramsBuffer: this.$internalParamsBuffer };\n    }\n    getCompensationDelay() {\n      return 128;\n    }\n    getParameterInfo(...parameterIdQuery) {\n      if (parameterIdQuery.length === 0)\n        parameterIdQuery = Object.keys(this.paramsConfig);\n      const parameterInfo = {};\n      parameterIdQuery.forEach((parameterId) => {\n        parameterInfo[parameterId] = this.paramsConfig[parameterId];\n      });\n      return parameterInfo;\n    }\n    getParameterValues(normalized, ...parameterIdQuery) {\n      if (parameterIdQuery.length === 0)\n        parameterIdQuery = Object.keys(this.paramsConfig);\n      const parameterValues = {};\n      parameterIdQuery.forEach((parameterId) => {\n        if (!(parameterId in this.paramsValues))\n          return;\n        const { minValue, maxValue, exponent } = this.paramsConfig[parameterId];\n        const value = this.paramsValues[parameterId];\n        parameterValues[parameterId] = {\n          id: parameterId,\n          value: normalized ? normalizeE(value, minValue, maxValue, exponent) : value,\n          normalized\n        };\n      });\n      return parameterValues;\n    }\n    scheduleEvents(...events) {\n      this.eventQueue.push(...events);\n      const { currentTime } = audioWorkletGlobalScope;\n      this.eventQueue.sort((a, b) => (a.time || currentTime) - (b.time || currentTime));\n    }\n    emitEvents(...events) {\n      webAudioModules.emitEvents(this, ...events);\n    }\n    clearEvents() {\n      this.eventQueue = [];\n    }\n    lock() {\n      if (globalThis.Atomics)\n        Atomics.store(this.$lock, 0, 1);\n    }\n    unlock() {\n      if (globalThis.Atomics)\n        Atomics.store(this.$lock, 0, 0);\n    }\n    process(inputs, outputs, parameters) {\n      if (this.destroyed)\n        return false;\n      const outputOffset = 1;\n      this.lock();\n      Object.entries(this.paramsConfig).forEach(([name, { minValue, maxValue }]) => {\n        const raw = parameters[name];\n        if (name in this.paramsValues)\n          this.paramsValues[name] = raw[raw.length - 1];\n        if (!this.paramsMapping[name])\n          return;\n        Object.entries(this.paramsMapping[name]).forEach(([targetName, targetMapping]) => {\n          const j = this.internalParams.indexOf(targetName);\n          if (j === -1)\n            return;\n          const intrinsicValue = this.internalParamsMinValues[j];\n          const { sourceRange, targetRange } = targetMapping;\n          const [sMin, sMax] = sourceRange;\n          const [tMin, tMax] = targetRange;\n          let out;\n          if (minValue !== tMin || maxValue !== tMax || minValue !== sMin || maxValue !== sMax) {\n            out = raw.map((v) => {\n              const mappedValue = mapValue(v, minValue, maxValue, sMin, sMax, tMin, tMax);\n              return mappedValue - intrinsicValue;\n            });\n          } else if (intrinsicValue) {\n            out = raw.map((v) => v - intrinsicValue);\n          } else {\n            out = raw;\n          }\n          if (out.length === 1)\n            outputs[j + outputOffset][0].fill(out[0]);\n          else\n            outputs[j + outputOffset][0].set(out);\n          this.$internalParamsBuffer[j] = out[0];\n        });\n      });\n      this.unlock();\n      if (!this.supportSharedArrayBuffer) {\n        this.call(\"setBuffer\", { lock: this.$lock, paramsBuffer: this.$internalParamsBuffer });\n      }\n      const { currentTime } = audioWorkletGlobalScope;\n      let $event;\n      for ($event = 0; $event < this.eventQueue.length; $event++) {\n        const event = this.eventQueue[$event];\n        if (event.time && event.time > currentTime)\n          break;\n        if (typeof this.handleEvent === \"function\")\n          this.handleEvent(event);\n        this.call(\"dispatchWamEvent\", event);\n      }\n      if ($event)\n        this.eventQueue.splice(0, $event);\n      return true;\n    }\n    connectEvents(wamInstanceId, output) {\n      webAudioModules.connectEvents(this.groupId, this.instanceId, wamInstanceId, output);\n    }\n    disconnectEvents(wamInstanceId, output) {\n      if (typeof wamInstanceId === \"undefined\") {\n        webAudioModules.disconnectEvents(this.groupId, this.instanceId);\n        return;\n      }\n      webAudioModules.disconnectEvents(this.groupId, this.instanceId, wamInstanceId, output);\n    }\n    destroy() {\n      audioWorkletGlobalScope.webAudioModules.removeWam(this);\n      this.destroyed = true;\n      this.port.close();\n    }\n  }\n  try {\n    registerProcessor(moduleId, ParamMgrProcessor);\n  } catch (error) {\n    console.warn(error);\n  }\n};\nvar ParamMgrProcessor_default = processor;\n\n// src/sdk/src/WamParameterInfo.js\nvar getWamParameterInfo = (moduleId) => {\n  const audioWorkletGlobalScope = globalThis;\n  const normExp = (x, e) => e === 0 ? x : x ** 1.5 ** -e;\n  const denormExp = (x, e) => e === 0 ? x : x ** 1.5 ** e;\n  const normalize = (x, min, max, e = 0) => min === 0 && max === 1 ? normExp(x, e) : normExp((x - min) / (max - min) || 0, e);\n  const denormalize = (x, min, max, e = 0) => min === 0 && max === 1 ? denormExp(x, e) : denormExp(x, e) * (max - min) + min;\n  const inRange = (x, min, max) => x >= min && x <= max;\n  class WamParameterInfo2 {\n    constructor(id, config = {}) {\n      let {\n        type,\n        label,\n        defaultValue,\n        minValue,\n        maxValue,\n        discreteStep,\n        exponent,\n        choices,\n        units\n      } = config;\n      if (type === void 0)\n        type = \"float\";\n      if (label === void 0)\n        label = \"\";\n      if (defaultValue === void 0)\n        defaultValue = 0;\n      if (choices === void 0)\n        choices = [];\n      if (type === \"boolean\" || type === \"choice\") {\n        discreteStep = 1;\n        minValue = 0;\n        if (choices.length)\n          maxValue = choices.length - 1;\n        else\n          maxValue = 1;\n      } else {\n        if (minValue === void 0)\n          minValue = 0;\n        if (maxValue === void 0)\n          maxValue = 1;\n        if (discreteStep === void 0)\n          discreteStep = 0;\n        if (exponent === void 0)\n          exponent = 0;\n        if (units === void 0)\n          units = \"\";\n      }\n      const errBase = `Param config error | ${id}: `;\n      if (minValue >= maxValue)\n        throw Error(errBase.concat(\"minValue must be less than maxValue\"));\n      if (!inRange(defaultValue, minValue, maxValue))\n        throw Error(errBase.concat(\"defaultValue out of range\"));\n      if (discreteStep % 1 || discreteStep < 0) {\n        throw Error(errBase.concat(\"discreteStep must be a non-negative integer\"));\n      } else if (discreteStep > 0 && (minValue % 1 || maxValue % 1 || defaultValue % 1)) {\n        throw Error(errBase.concat(\"non-zero discreteStep requires integer minValue, maxValue, and defaultValue\"));\n      }\n      if (type === \"choice\" && !choices.length) {\n        throw Error(errBase.concat(\"choice type parameter requires list of strings in choices\"));\n      }\n      this.id = id;\n      this.label = label;\n      this.type = type;\n      this.defaultValue = defaultValue;\n      this.minValue = minValue;\n      this.maxValue = maxValue;\n      this.discreteStep = discreteStep;\n      this.exponent = exponent;\n      this.choices = choices;\n      this.units = units;\n    }\n    normalize(value) {\n      return normalize(value, this.minValue, this.maxValue, this.exponent);\n    }\n    denormalize(valueNorm) {\n      return denormalize(valueNorm, this.minValue, this.maxValue, this.exponent);\n    }\n    valueString(value) {\n      if (this.choices)\n        return this.choices[value];\n      if (this.units !== \"\")\n        return `${value} ${this.units}`;\n      return `${value}`;\n    }\n  }\n  if (audioWorkletGlobalScope.AudioWorkletProcessor) {\n    const ModuleScope = audioWorkletGlobalScope.webAudioModules.getModuleScope(moduleId);\n    if (!ModuleScope.WamParameterInfo)\n      ModuleScope.WamParameterInfo = WamParameterInfo2;\n  }\n  return WamParameterInfo2;\n};\nvar WamParameterInfo_default = getWamParameterInfo;\n\n// src/ParamConfigurator.js\nvar WamParameterInfo = WamParameterInfo_default();\nvar ParamMappingConfigurator = class {\n  constructor(options = {}) {\n    __publicField(this, \"_paramsConfig\");\n    __publicField(this, \"_internalParamsConfig\");\n    __publicField(this, \"_paramsMapping\", {});\n    const { paramsConfig, paramsMapping, internalParamsConfig } = options;\n    this._paramsConfig = paramsConfig;\n    this._paramsMapping = paramsMapping;\n    this._internalParamsConfig = internalParamsConfig;\n  }\n  get paramsConfig() {\n    const { internalParamsConfig } = this;\n    return Object.entries(this._paramsConfig || internalParamsConfig).reduce((configs, [id, config]) => {\n      var _a, _b, _c, _d;\n      const internalParam = internalParamsConfig[id];\n      configs[id] = new WamParameterInfo(id, __spreadProps(__spreadValues({}, config), {\n        label: (_a = config.label) != null ? _a : id,\n        defaultValue: (_b = config.defaultValue) != null ? _b : internalParam == null ? void 0 : internalParam.defaultValue,\n        minValue: (_c = config.minValue) != null ? _c : internalParam == null ? void 0 : internalParam.minValue,\n        maxValue: (_d = config.maxValue) != null ? _d : internalParam == null ? void 0 : internalParam.maxValue\n      }));\n      return configs;\n    }, {});\n  }\n  get internalParamsConfig() {\n    return Object.entries(this._internalParamsConfig || {}).reduce((configs, [name, config]) => {\n      if (config instanceof AudioParam)\n        configs[name] = config;\n      else {\n        const defaultConfig = {\n          minValue: 0,\n          maxValue: 1,\n          defaultValue: 0,\n          automationRate: 30\n        };\n        configs[name] = __spreadValues(__spreadValues({}, defaultConfig), config);\n      }\n      return configs;\n    }, {});\n  }\n  get paramsMapping() {\n    const declared = this._paramsMapping || {};\n    const externalParams = this.paramsConfig;\n    const internalParams = this.internalParamsConfig;\n    return Object.entries(externalParams).reduce((mapping, [name, { minValue, maxValue }]) => {\n      const sourceRange = [minValue, maxValue];\n      const defaultMapping = { sourceRange, targetRange: [...sourceRange] };\n      if (declared[name]) {\n        const declaredTargets = Object.entries(declared[name]).reduce((targets, [targetName, targetMapping]) => {\n          if (internalParams[targetName]) {\n            targets[targetName] = __spreadValues(__spreadValues({}, defaultMapping), targetMapping);\n          }\n          return targets;\n        }, {});\n        mapping[name] = declaredTargets;\n      } else if (internalParams[name]) {\n        mapping[name] = { [name]: __spreadValues({}, defaultMapping) };\n      }\n      return mapping;\n    }, {});\n  }\n};\n\n// src/MgrAudioParam.js\nvar MgrAudioParam = class extends AudioParam {\n  constructor() {\n    super(...arguments);\n    __publicField(this, \"_info\");\n  }\n  get exponent() {\n    return this.info.exponent;\n  }\n  get info() {\n    return this._info;\n  }\n  set info(info) {\n    this._info = info;\n  }\n  set normalizedValue(valueIn) {\n    this.value = this.info.denormalize(valueIn);\n  }\n  get normalizedValue() {\n    return this.info.normalize(this.value);\n  }\n  setValueAtTime(value, startTime) {\n    return super.setValueAtTime(value, startTime);\n  }\n  setNormalizedValueAtTime(valueIn, startTime) {\n    const value = this.info.denormalize(valueIn);\n    return this.setValueAtTime(value, startTime);\n  }\n  linearRampToValueAtTime(value, endTime) {\n    return super.linearRampToValueAtTime(value, endTime);\n  }\n  linearRampToNormalizedValueAtTime(valueIn, endTime) {\n    const value = this.info.denormalize(valueIn);\n    return this.linearRampToValueAtTime(value, endTime);\n  }\n  exponentialRampToValueAtTime(value, endTime) {\n    return super.exponentialRampToValueAtTime(value, endTime);\n  }\n  exponentialRampToNormalizedValueAtTime(valueIn, endTime) {\n    const value = this.info.denormalize(valueIn);\n    return this.exponentialRampToValueAtTime(value, endTime);\n  }\n  setTargetAtTime(target, startTime, timeConstant) {\n    return super.setTargetAtTime(target, startTime, timeConstant);\n  }\n  setNormalizedTargetAtTime(targetIn, startTime, timeConstant) {\n    const target = this.info.denormalize(targetIn);\n    return this.setTargetAtTime(target, startTime, timeConstant);\n  }\n  setValueCurveAtTime(values, startTime, duration) {\n    return super.setValueCurveAtTime(values, startTime, duration);\n  }\n  setNormalizedValueCurveAtTime(valuesIn, startTime, duration) {\n    const values = Array.from(valuesIn).map((v) => this.info.denormalize(v));\n    return this.setValueCurveAtTime(values, startTime, duration);\n  }\n  cancelScheduledParamValues(cancelTime) {\n    return super.cancelScheduledValues(cancelTime);\n  }\n  cancelAndHoldParamAtTime(cancelTime) {\n    return super.cancelAndHoldAtTime(cancelTime);\n  }\n};\n\n// src/ParamMgrNode.js\nvar AudioWorkletNode = globalThis.AudioWorkletNode;\nvar ParamMgrNode = class extends AudioWorkletNode {\n  constructor(module, options) {\n    super(module.audioContext, module.moduleId, {\n      numberOfInputs: 0,\n      numberOfOutputs: 1 + options.processorOptions.internalParams.length,\n      parameterData: options.parameterData,\n      processorOptions: options.processorOptions\n    });\n    __publicField(this, \"requestDispatchIParamChange\", (name) => {\n      const config = this.internalParamsConfig[name];\n      if (!(\"onChange\" in config))\n        return;\n      const { automationRate, onChange } = config;\n      if (typeof automationRate !== \"number\" || !automationRate)\n        return;\n      const interval = 1e3 / automationRate;\n      const i = this.internalParams.indexOf(name);\n      if (i === -1)\n        return;\n      if (i >= this.internalParams.length)\n        return;\n      if (typeof this.paramsUpdateCheckFnRef[i] === \"number\") {\n        window.clearTimeout(this.paramsUpdateCheckFnRef[i]);\n      }\n      this.paramsUpdateCheckFn[i] = () => {\n        const prev = this.$prevParamsBuffer[i];\n        const cur = this.$paramsBuffer[i];\n        if (cur !== prev) {\n          onChange(cur, prev);\n          this.$prevParamsBuffer[i] = cur;\n        }\n        this.paramsUpdateCheckFnRef[i] = window.setTimeout(this.paramsUpdateCheckFn[i], interval);\n      };\n      this.paramsUpdateCheckFn[i]();\n    });\n    const { processorOptions, internalParamsConfig } = options;\n    this.initialized = false;\n    this.module = module;\n    this.paramsConfig = processorOptions.paramsConfig;\n    this.internalParams = processorOptions.internalParams;\n    this.internalParamsConfig = internalParamsConfig;\n    this.$prevParamsBuffer = new Float32Array(this.internalParams.length);\n    this.paramsUpdateCheckFn = [];\n    this.paramsUpdateCheckFnRef = [];\n    this.messageRequestId = 0;\n    Object.entries(this.getParams()).forEach(([name, param]) => {\n      Object.setPrototypeOf(param, MgrAudioParam.prototype);\n      param._info = this.paramsConfig[name];\n    });\n    const resolves = {};\n    const rejects = {};\n    this.call = (call, ...args) => {\n      const id = this.messageRequestId;\n      this.messageRequestId += 1;\n      return new Promise((resolve, reject) => {\n        resolves[id] = resolve;\n        rejects[id] = reject;\n        this.port.postMessage({ id, call, args });\n      });\n    };\n    this.handleMessage = ({ data }) => {\n      var _a, _b;\n      const { id, call, args, value, error } = data;\n      if (call) {\n        const r = { id };\n        try {\n          r.value = this[call](...args);\n        } catch (e) {\n          r.error = e;\n        }\n        this.port.postMessage(r);\n      } else {\n        if (error)\n          (_a = rejects[id]) == null ? void 0 : _a.call(rejects, error);\n        else if (resolves[id])\n          (_b = resolves[id]) == null ? void 0 : _b.call(resolves, value);\n        delete resolves[id];\n        delete rejects[id];\n      }\n    };\n    this.port.start();\n    this.port.addEventListener(\"message\", this.handleMessage);\n  }\n  get parameters() {\n    return super.parameters;\n  }\n  get groupId() {\n    return this.module.groupId;\n  }\n  get moduleId() {\n    return this.module.moduleId;\n  }\n  get instanceId() {\n    return this.module.instanceId;\n  }\n  async initialize() {\n    const response = await this.call(\"getBuffer\");\n    const { lock, paramsBuffer } = response;\n    this.$lock = lock;\n    this.$paramsBuffer = paramsBuffer;\n    const offset = 1;\n    Object.entries(this.internalParamsConfig).forEach(([name, config], i) => {\n      if (this.context.state === \"suspended\")\n        this.$paramsBuffer[i] = config.defaultValue;\n      if (config instanceof AudioParam) {\n        try {\n          config.automationRate = \"a-rate\";\n        } catch (e) {\n        } finally {\n          config.value = Math.max(0, config.minValue);\n          this.connect(config, offset + i);\n        }\n      } else if (config instanceof AudioNode) {\n        this.connect(config, offset + i);\n      } else {\n        this.requestDispatchIParamChange(name);\n      }\n    });\n    this.connect(this.module.audioContext.destination, 0, 0);\n    this.initialized = true;\n    return this;\n  }\n  setBuffer({ lock, paramsBuffer }) {\n    this.$lock = lock;\n    this.$paramsBuffer = paramsBuffer;\n  }\n  setParamsMapping(paramsMapping) {\n    return this.call(\"setParamsMapping\", paramsMapping);\n  }\n  getCompensationDelay() {\n    return this.call(\"getCompensationDelay\");\n  }\n  getParameterInfo(...parameterIdQuery) {\n    return this.call(\"getParameterInfo\", ...parameterIdQuery);\n  }\n  getParameterValues(normalized, ...parameterIdQuery) {\n    return this.call(\"getParameterValues\", normalized, ...parameterIdQuery);\n  }\n  scheduleAutomation(event) {\n    const time = event.time || this.context.currentTime;\n    const { id, normalized, value } = event.data;\n    const audioParam = this.getParam(id);\n    if (!audioParam)\n      return;\n    if (audioParam.info.type === \"float\") {\n      if (normalized)\n        audioParam.linearRampToNormalizedValueAtTime(value, time);\n      else\n        audioParam.linearRampToValueAtTime(value, time);\n    } else {\n      if (normalized)\n        audioParam.setNormalizedValueAtTime(value, time);\n      else\n        audioParam.setValueAtTime(value, time);\n    }\n  }\n  scheduleEvents(...events) {\n    events.forEach((event) => {\n      if (event.type === \"wam-automation\") {\n        this.scheduleAutomation(event);\n      }\n    });\n    this.call(\"scheduleEvents\", ...events);\n  }\n  emitEvents(...events) {\n    this.call(\"emitEvents\", ...events);\n  }\n  clearEvents() {\n    this.call(\"clearEvents\");\n  }\n  dispatchWamEvent(event) {\n    if (event.type === \"wam-automation\") {\n      this.scheduleAutomation(event);\n    } else {\n      this.dispatchEvent(new CustomEvent(event.type, { detail: event }));\n    }\n  }\n  async setParameterValues(parameterValues) {\n    Object.keys(parameterValues).forEach((parameterId) => {\n      const parameterUpdate = parameterValues[parameterId];\n      const parameter = this.parameters.get(parameterId);\n      if (!parameter)\n        return;\n      if (!parameterUpdate.normalized)\n        parameter.value = parameterUpdate.value;\n      else\n        parameter.normalizedValue = parameterUpdate.value;\n    });\n  }\n  async getState() {\n    return this.getParamsValues();\n  }\n  async setState(state) {\n    this.setParamsValues(state);\n  }\n  convertTimeToFrame(time) {\n    return Math.round(time * this.context.sampleRate);\n  }\n  convertFrameToTime(frame) {\n    return frame / this.context.sampleRate;\n  }\n  getIParamIndex(name) {\n    const i = this.internalParams.indexOf(name);\n    return i === -1 ? null : i;\n  }\n  connectIParam(name, dest, index) {\n    const offset = 1;\n    const i = this.getIParamIndex(name);\n    if (i !== null) {\n      if (dest instanceof AudioNode) {\n        if (typeof index === \"number\")\n          this.connect(dest, offset + i, index);\n        else\n          this.connect(dest, offset + i);\n      } else {\n        this.connect(dest, offset + i);\n      }\n    }\n  }\n  disconnectIParam(name, dest, index) {\n    const offset = 1;\n    const i = this.getIParamIndex(name);\n    if (i !== null) {\n      if (dest instanceof AudioNode) {\n        if (typeof index === \"number\")\n          this.disconnect(dest, offset + i, index);\n        else\n          this.disconnect(dest, offset + i);\n      } else {\n        this.disconnect(dest, offset + i);\n      }\n    }\n  }\n  getIParamValue(name) {\n    const i = this.getIParamIndex(name);\n    return i !== null ? this.$paramsBuffer[i] : null;\n  }\n  getIParamsValues() {\n    const values = {};\n    this.internalParams.forEach((name, i) => {\n      values[name] = this.$paramsBuffer[i];\n    });\n    return values;\n  }\n  getParam(name) {\n    return this.parameters.get(name) || null;\n  }\n  getParams() {\n    return Object.fromEntries(this.parameters);\n  }\n  getParamValue(name) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.value;\n  }\n  setParamValue(name, value) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return;\n    param.value = value;\n  }\n  getParamsValues() {\n    const values = {};\n    this.parameters.forEach((v, k) => {\n      values[k] = v.value;\n    });\n    return values;\n  }\n  setParamsValues(values) {\n    if (!values)\n      return;\n    Object.entries(values).forEach(([k, v]) => {\n      this.setParamValue(k, v);\n    });\n  }\n  getNormalizedParamValue(name) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.normalizedValue;\n  }\n  setNormalizedParamValue(name, value) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return;\n    param.normalizedValue = value;\n  }\n  getNormalizedParamsValues() {\n    const values = {};\n    this.parameters.forEach((v, k) => {\n      values[k] = this.getNormalizedParamValue(k);\n    });\n    return values;\n  }\n  setNormalizedParamsValues(values) {\n    if (!values)\n      return;\n    Object.entries(values).forEach(([k, v]) => {\n      this.setNormalizedParamValue(k, v);\n    });\n  }\n  setParamValueAtTime(name, value, startTime) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.setValueAtTime(value, startTime);\n  }\n  setNormalizedParamValueAtTime(name, value, startTime) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.setNormalizedValueAtTime(value, startTime);\n  }\n  linearRampToParamValueAtTime(name, value, endTime) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.linearRampToValueAtTime(value, endTime);\n  }\n  linearRampToNormalizedParamValueAtTime(name, value, endTime) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.linearRampToNormalizedValueAtTime(value, endTime);\n  }\n  exponentialRampToParamValueAtTime(name, value, endTime) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.exponentialRampToValueAtTime(value, endTime);\n  }\n  exponentialRampToNormalizedParamValueAtTime(name, value, endTime) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.exponentialRampToNormalizedValueAtTime(value, endTime);\n  }\n  setParamTargetAtTime(name, target, startTime, timeConstant) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.setTargetAtTime(target, startTime, timeConstant);\n  }\n  setNormalizedParamTargetAtTime(name, target, startTime, timeConstant) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.setNormalizedTargetAtTime(target, startTime, timeConstant);\n  }\n  setParamValueCurveAtTime(name, values, startTime, duration) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.setValueCurveAtTime(values, startTime, duration);\n  }\n  setNormalizedParamValueCurveAtTime(name, values, startTime, duration) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.setNormalizedValueCurveAtTime(values, startTime, duration);\n  }\n  cancelScheduledParamValues(name, cancelTime) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.cancelScheduledValues(cancelTime);\n  }\n  cancelAndHoldParamAtTime(name, cancelTime) {\n    const param = this.parameters.get(name);\n    if (!param)\n      return null;\n    return param.cancelAndHoldAtTime(cancelTime);\n  }\n  connectEvents(toId, output) {\n    this.call(\"connectEvents\", toId, output);\n  }\n  disconnectEvents(toId, output) {\n    this.call(\"disconnectEvents\", toId, output);\n  }\n  async destroy() {\n    this.disconnect();\n    this.paramsUpdateCheckFnRef.forEach((ref) => {\n      if (typeof ref === \"number\")\n        window.clearTimeout(ref);\n    });\n    await this.call(\"destroy\");\n    this.port.close();\n  }\n};\n\n// src/ParamMgrFactory.js\nvar ParamMgrFactory = class {\n  static async create(module, optionsIn = {}) {\n    const { audioContext, groupId, moduleId, instanceId } = module;\n    const { paramsConfig, paramsMapping, internalParamsConfig } = new ParamMappingConfigurator(optionsIn);\n    const initialParamsValue = Object.entries(paramsConfig).reduce((currentParams, [name, { defaultValue }]) => {\n      currentParams[name] = defaultValue;\n      return currentParams;\n    }, {});\n    const serializableParamsConfig = Object.entries(paramsConfig).reduce((currentParams, [name, { id, label, type, defaultValue, minValue, maxValue, discreteStep, exponent, choices, units }]) => {\n      currentParams[name] = { id, label, type, defaultValue, minValue, maxValue, discreteStep, exponent, choices, units };\n      return currentParams;\n    }, {});\n    await addFunctionModule_default(audioContext.audioWorklet, ParamMgrProcessor_default, moduleId, serializableParamsConfig);\n    const options = {\n      internalParamsConfig,\n      parameterData: initialParamsValue,\n      processorOptions: {\n        paramsConfig,\n        paramsMapping,\n        internalParamsMinValues: Object.values(internalParamsConfig).map((config) => Math.max(0, (config == null ? void 0 : config.minValue) || 0)),\n        internalParams: Object.keys(internalParamsConfig),\n        groupId,\n        instanceId,\n        moduleId\n      }\n    };\n    const node = new ParamMgrNode(module, options);\n    await node.initialize();\n    return node;\n  }\n};\nexport {\n  CompositeAudioNode,\n  ParamMgrFactory\n};\n//# sourceMappingURL=index.js.map\n","/* eslint-disable no-underscore-dangle */\n/** @template P @template I @typedef { import('@webaudiomodules/sdk-parammgr').ParamMgrNode<P, I> } ParamMgrNode */\nimport { CompositeAudioNode } from '@webaudiomodules/sdk-parammgr';\n\n/**\n * @typedef {\"feedback\" | \"time\" | \"mix\" | \"enabled\"} Params\n * @typedef {\"feedback\" | \"delayLeftTime\" | \"delayRightTime\"\n * | \"dryGain\" | \"wetGain\" | \"enabled\"} InternalParams\n */\n// name is not so important here, the file Node.js is imported\n// Normally the class does no need to be exported as\n// an async mehod createNode is expored at the end of this\n// file.\nexport default class PingPongDelayNode extends CompositeAudioNode {\n\t/**\n\t * @type {ParamMgrNode<Params, InternalParams>}\n\t */\n\t_wamNode = undefined;\n\n\tget paramMgr() {\n\t\treturn this._wamNode;\n\t}\n\n\t// plugin is an instance of he class that exends WebAudioModule\n\t// this instance is he plugin as an Observable\n\t// options is an extra container that could be ussed to indicate\n\t// the number of inputs and outputs...\n\tconstructor(audioContext, options) {\n\t\tsuper(audioContext, options);\n\t\tconsole.log('CONSTRUCTOR CompositeAudioNode');\n\t\tthis.createNodes();\n\t}\n\n\t/*  #########  Personnal code for the web audio graph  #########   */\n\tcreateNodes() {\n\t\tthis._input = this.context.createGain();\n\t\tsuper.connect(this._input);\n\t\tthis._output = this.context.createGain();\n\t\tthis.delayNodeLeft = this.context.createDelay();\n\t\tthis.delayNodeRight = this.context.createDelay();\n\t\tthis.dryGainNode = this.context.createGain();\n\t\tthis.wetGainNode = this.context.createGain();\n\t\tthis.feedbackGainNode = this.context.createGain();\n\t\tthis.channelMerger = this.context.createChannelMerger(2);\n\t}\n\n\tconnectNodes() {\n\t\t// dry mix\n\t\tthis._input.connect(this.dryGainNode);\n\t\t// dry mix out\n\t\tthis.dryGainNode.connect(this._output);\n\n\t\t// the feedback loop\n\t\tthis.delayNodeLeft.connect(this.channelMerger, 0, 0);\n\t\tthis.delayNodeRight.connect(this.channelMerger, 0, 1);\n\n\t\tthis.feedbackGainNode.connect(this.delayNodeLeft);\n\t\tthis.delayNodeRight.connect(this.feedbackGainNode);\n\n\t\tthis.delayNodeLeft.connect(this.delayNodeRight);\n\n\t\t// wet mix\n\t\tthis._input.connect(this.feedbackGainNode);\n\n\t\t// wet out\n\t\tthis.channelMerger.connect(this.wetGainNode);\n\t\tthis.wetGainNode.connect(this._output);\n\t}\n\n\t/**\n\t * @param {ParamMgrNode<Params, InternalParams>} wamNode\n\t */\n\tsetup(wamNode) {\n\t\tthis._wamNode = wamNode;\n\t\tthis.connectNodes();\n\t}\n\n\tisEnabled = true;\n\n\tset status(_sig) {\n\t\tif (this.isEnabled === _sig) return;\n\t\tthis.isEnabled = _sig;\n\t\tif (_sig) {\n\t\t\tthis._input.disconnect(this._output);\n\t\t\tthis._input.connect(this.feedbackGainNode);\n\t\t\tthis._input.connect(this.dryGainNode);\n\t\t} else {\n\t\t\tthis._input.disconnect(this.feedbackGainNode);\n\t\t\tthis._input.disconnect(this.dryGainNode);\n\t\t\tthis._input.connect(this._output);\n\t\t}\n\t}\n}\n","/* *\n *\n *  WebAudio-Controls is based on\n *    webaudio-knob by Eiji Kitamura http://google.com/+agektmr\n *    webaudio-slider by RYoya Kawai https://plus.google.com/108242669191458983485/posts\n *    webaudio-switch by Keisuke Ai http://d.hatena.ne.jp/aike/\n *  Integrated and enhanced by g200kg http://www.g200kg.com/\n *\n *\tCopyright 2013 Eiji Kitamura / Ryoya KAWAI / Keisuke Ai / g200kg(Tatsuya Shinyagaito)\n *\n *\t Licensed under the Apache License, Version 2.0 (the \"License\");\n *\t you may not use this file except in compliance with the License.\n *\t You may obtain a copy of the License at\n *\n *\t http://www.apache.org/licenses/LICENSE-2.0\n *\n *\t Unless required by applicable law or agreed to in writing, software\n *\t distributed under the License is distributed on an \"AS IS\" BASIS,\n *\t WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\t See the License for the specific language governing permissions and\n *\t limitations under the License.\n *\n * */\n if (window.customElements) {\n\tlet styles = document.createElement(\"style\");\n\tstyles.innerHTML =\n\t\t`#webaudioctrl-context-menu {\n  display: none;\n  position: absolute;\n  z-index: 10;\n  padding: 0;\n  width: 100px;\n  color:#eee;\n  background-color: #268;\n  border: solid 1px #888;\n  box-shadow: 1px 1px 2px #888;\n  font-family: sans-serif;\n  font-size: 11px;\n  line-height:1.7em;\n  text-align:center;\n  cursor:pointer;\n  color:#fff;\n  list-style: none;\n}\n#webaudioctrl-context-menu.active {\n  display: block;\n}\n.webaudioctrl-context-menu__item {\n  display: block;\n  margin: 0;\n  padding: 0;\n  color: #000;\n  background-color:#eee;\n  text-decoration: none;\n}\n.webaudioctrl-context-menu__title{\n  font-weight:bold;\n}\n.webaudioctrl-context-menu__item:last-child {\n  margin-bottom: 0;\n}\n.webaudioctrl-context-menu__item:hover {\n  background-color: #b8b8b8;\n}\n`;\n\tdocument.head.appendChild(styles);\n\tlet midimenu = document.createElement(\"ul\");\n\tmidimenu.id = \"webaudioctrl-context-menu\";\n\tmidimenu.innerHTML =\n\t\t`<li class=\"webaudioctrl-context-menu__title\">MIDI Learn</li>\n<li class=\"webaudioctrl-context-menu__item\" id=\"webaudioctrl-context-menu-learn\" onclick=\"webAudioControlsMidiManager.contextMenuLearn()\">Learn</li>\n<li class=\"webaudioctrl-context-menu__item\" onclick=\"webAudioControlsMidiManager.contextMenuClear()\">Clear</li>\n<li class=\"webaudioctrl-context-menu__item\" onclick=\"webAudioControlsMidiManager.contextMenuClose()\">Close</li>\n`;\n\tlet opt = {\n\t\tuseMidi: 0,\n\t\tmidilearn: 0,\n\t\tmididump: 0,\n\t\toutline: 0,\n\t\tknobSrc: null,\n\t\tknobSprites: 0,\n\t\tknobWidth: 0,\n\t\tknobHeight: 0,\n\t\tknobDiameter: 64,\n\t\tknobColors: \"#fff;#000;#000\",\n\t\tsliderSrc: null,\n\t\tsliderKnobsrc: null,\n\t\tsliderWidth: 0,\n\t\tsliderHeight: 0,\n\t\tsliderKnobwidth: 0,\n\t\tsliderKnobheight: 0,\n\t\tsliderDitchlength: 0,\n\t\tsliderColors: \"#bbb;#444;#fff\",\n\t\tswitchWidth: 0,\n\t\tswitchHeight: 0,\n\t\tswitchDiameter: 24,\n\t\tswitchColors: \"#e00;#000;#fcc\",\n\t\tparamWidth: 32,\n\t\tparamHeight: 16,\n\t\tparamColors: \"#fff;#000\",\n\t};\n\tif (window.WebAudioControlsOptions)\n\t\tObject.assign(opt, window.WebAudioControlsOptions);\n\tclass WebAudioControlsWidget extends HTMLElement {\n\t\tconstructor() {\n\t\t\tsuper();\n\t\t\tthis.addEventListener(\"keydown\", this.keydown);\n\t\t\tthis.addEventListener(\"mousedown\", this.pointerdown, { passive: false });\n\t\t\tthis.addEventListener(\"touchstart\", this.pointerdown, { passive: false });\n\t\t\tthis.addEventListener(\"wheel\", this.wheel, { passive: true });\n\t\t\tthis.addEventListener(\"mouseover\", this.pointerover);\n\t\t\tthis.addEventListener(\"mouseout\", this.pointerout);\n\t\t\tthis.addEventListener(\"contextmenu\", this.contextMenu);\n\t\t\tthis.hover = this.drag = 0;\n\t\t\tdocument.body.appendChild(midimenu);\n\t\t\tthis.basestyle = `\n.webaudioctrl-tooltip{\n  display:inline-block;\n  position:absolute;\n  margin:0 -1000px;\n  z-index: 999;\n  background:#eee;\n  color:#000;\n  border:1px solid #666;\n  border-radius:4px;\n  padding:5px 10px;\n  text-align:center;\n  left:0; top:0;\n  font-size:11px;\n  opacity:0;\n  visibility:hidden;\n}\n.webaudioctrl-tooltip:before{\n  content: \"\";\n\tposition: absolute;\n\ttop: 100%;\n\tleft: 50%;\n \tmargin-left: -8px;\n\tborder: 8px solid transparent;\n\tborder-top: 8px solid #666;\n}\n.webaudioctrl-tooltip:after{\n  content: \"\";\n\tposition: absolute;\n\ttop: 100%;\n\tleft: 50%;\n \tmargin-left: -6px;\n\tborder: 6px solid transparent;\n\tborder-top: 6px solid #eee;\n}\n`;\n\t\t}\n\t\tsendEvent(ev) {\n\t\t\tlet event;\n\t\t\tevent = document.createEvent(\"HTMLEvents\");\n\t\t\tevent.initEvent(ev, false, true);\n\t\t\tthis.dispatchEvent(event);\n\t\t}\n\t\tgetAttr(n, def) {\n\t\t\tlet v = this.getAttribute(n);\n\t\t\tif (v == \"\" || v == null) return def;\n\t\t\tswitch (typeof (def)) {\n\t\t\t\tcase \"number\":\n\t\t\t\t\tif (v == \"true\") return 1;\n\t\t\t\t\tv = +v;\n\t\t\t\t\tif (isNaN(v)) return 0;\n\t\t\t\t\treturn v;\n\t\t\t}\n\t\t\treturn v;\n\t\t}\n\t\tshowtip(d) {\n\t\t\tfunction numformat(s, x) {\n\t\t\t\tlet i = s.indexOf(\"%\");\n\t\t\t\tlet c = [0, 0], type = 0, m = 0, r = \"\", j = i + 1;\n\t\t\t\tfor (; j < s.length; ++j) {\n\t\t\t\t\tif (\"dfxXs\".indexOf(s[j]) >= 0) {\n\t\t\t\t\t\ttype = s[j];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif (s[j] == \".\")\n\t\t\t\t\t\tm = 1;\n\t\t\t\t\telse\n\t\t\t\t\t\tc[m] = c[m] * 10 + parseInt(s[j]);\n\t\t\t\t}\n\t\t\t\tswitch (type) {\n\t\t\t\t\tcase \"x\": r = (x | 0).toString(16); break;\n\t\t\t\t\tcase \"X\": r = (x | 0).toString(16).toUpperCase(); break;\n\t\t\t\t\tcase \"d\": r = (x | 0).toString(); break;\n\t\t\t\t\tcase \"f\": r = x.toFixed(c[1]); break;\n\t\t\t\t\tcase \"s\": r = x.toString(); break;\n\t\t\t\t}\n\t\t\t\tif (c[0] > 0)\n\t\t\t\t\tr = (\"               \" + r).slice(-c[0]);\n\t\t\t\tr = s.replace(/%.*[xXdfs]/, r);\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tlet s = this.tooltip;\n\t\t\tif (this.drag || this.hover) {\n\t\t\t\tif (this.valuetip) {\n\t\t\t\t\tif (s == null)\n\t\t\t\t\t\ts = `%.${this.digits}f`;\n\t\t\t\t\telse if (s.indexOf(\"%\") < 0)\n\t\t\t\t\t\ts += ` : %.${this.digits}f`;\n\t\t\t\t}\n\t\t\t\tif (s) {\n\t\t\t\t\tthis.ttframe.innerHTML = numformat(s, this.convValue);\n\t\t\t\t\tthis.ttframe.style.display = \"inline-block\";\n\t\t\t\t\tthis.ttframe.style.width = \"auto\";\n\t\t\t\t\tthis.ttframe.style.height = \"auto\";\n\t\t\t\t\tthis.ttframe.style.transition = \"opacity 0.5s \" + d + \"s,visibility 0.5s \" + d + \"s\";\n\t\t\t\t\tthis.ttframe.style.opacity = 0.9;\n\t\t\t\t\tthis.ttframe.style.visibility = \"visible\";\n\t\t\t\t\tlet rc = this.getBoundingClientRect(), rc2 = this.ttframe.getBoundingClientRect(), rc3 = document.documentElement.getBoundingClientRect();\n\t\t\t\t\tthis.ttframe.style.left = ((rc.width - rc2.width) * 0.5 + 1000) + \"px\";\n\t\t\t\t\tthis.ttframe.style.top = (-rc2.height - 8) + \"px\";\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.ttframe.style.transition = \"opacity 0.1s \" + d + \"s,visibility 0.1s \" + d + \"s\";\n\t\t\tthis.ttframe.style.opacity = 0;\n\t\t\tthis.ttframe.style.visibility = \"hidden\";\n\t\t}\n\t\tpointerover(e) {\n\t\t\tthis.hover = 1;\n\t\t\tthis.showtip(0.6);\n\t\t}\n\t\tpointerout(e) {\n\t\t\tthis.hover = 0;\n\t\t\tthis.showtip(0);\n\t\t}\n\t\tcontextMenu(e) {\n\t\t\tif (window.webAudioControlsMidiManager && this.midilearn) {\n\t\t\t\twebAudioControlsMidiManager.contextMenuOpen(e, this);\n\t\t\t}\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t}\n\t\tsetMidiController(channel, cc) {\n\t\t\tif (this.listeningToThisMidiController(channel, cc)) return;\n\t\t\tthis.midiController = { 'channel': channel, 'cc': cc };\n\t\t\tconsole.log(\"Added mapping for channel=\" + channel + \" cc=\" + cc + \" tooltip=\" + this.tooltip);\n\t\t}\n\t\tlisteningToThisMidiController(channel, cc) {\n\t\t\tconst c = this.midiController;\n\t\t\tif ((c.channel === channel || c.channel < 0) && c.cc === cc)\n\t\t\t\treturn true;\n\t\t\treturn false;\n\t\t}\n\t\tprocessMidiEvent(event) {\n\t\t\tconst channel = event.data[0] & 0xf;\n\t\t\tconst controlNumber = event.data[1];\n\t\t\tif (this.midiMode == 'learn') {\n\t\t\t\tthis.setMidiController(channel, controlNumber);\n\t\t\t\twebAudioControlsMidiManager.contextMenuClose();\n\t\t\t\tthis.midiMode = 'normal';\n\t\t\t}\n\t\t\tif (this.listeningToThisMidiController(channel, controlNumber)) {\n\t\t\t\tif (this.tagName == \"WEBAUDIO-SWITCH\") {\n\t\t\t\t\tswitch (this.type) {\n\t\t\t\t\t\tcase \"toggle\":\n\t\t\t\t\t\t\tif (event.data[2] >= 64)\n\t\t\t\t\t\t\t\tthis.setValue(1 - this.value, true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"kick\":\n\t\t\t\t\t\t\tthis.setValue(event.data[2] >= 64 ? 1 : 0);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"radio\":\n\t\t\t\t\t\t\tlet els = document.querySelectorAll(\"webaudio-switch[type='radio'][group='\" + this.group + \"']\");\n\t\t\t\t\t\t\tfor (let i = 0; i < els.length; ++i) {\n\t\t\t\t\t\t\t\tif (els[i] == this)\n\t\t\t\t\t\t\t\t\tels[i].setValue(1);\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tels[i].setValue(0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tconst val = this.min + (this.max - this.min) * event.data[2] / 127;\n\t\t\t\t\tthis.setValue(val, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\ttry {\n\t\tcustomElements.define(\"webaudio-knob\", class WebAudioKnob extends WebAudioControlsWidget {\n\t\t\tconstructor() {\n\t\t\t\tsuper();\n\t\t\t}\n\t\t\tget src() { return this._src; }\n\t\t\tset src(v) { this._src = v; this.setupImage(); }\n\t\t\tget value() { return this._value; }\n\t\t\tset value(v) { this._value = +v; this.redraw(); }\n\t\t\tget min() { return this._min; }\n\t\t\tset min(v) { this._min = +v; this.redraw(); }\n\t\t\tget max() { return this._max; }\n\t\t\tset max(v) { this._max = +v; this.redraw(); }\n\t\t\tget step() { return this._step; }\n\t\t\tset step(v) { this._step = +v; this.redraw(); }\n\t\t\tget sprites() { return this._sprites; }\n\t\t\tset sprites(v) { this._sprites = +v; this.setupImage(); }\n\t\t\tget width() { return this._width; }\n\t\t\tset width(v) { this._width = +v; this.setupImage(); }\n\t\t\tget height() { return this._height; }\n\t\t\tset height(v) { this._height = +v; this.setupImage(); }\n\t\t\tget diameter() { return this._diameter; }\n\t\t\tset diameter(v) { this._diameter = +v; this.setupImage(); }\n\t\t\tget colors() { return this._colors; }\n\t\t\tset colors(v) { this._colors = v; this.setupImage(); }\n\n\t\t\tconnectedCallback() {\n\t\t\t\tlet root;\n\t\t\t\t//      if(this.attachShadow)\n\t\t\t\t//        root=this.attachShadow({mode: 'open'});\n\t\t\t\t//      else\n\t\t\t\troot = this;\n\t\t\t\troot.innerHTML =\n\t\t\t\t\t`<style>\n${this.basestyle}\nwebaudio-knob{\n  display:inline-block;\n  position:relative;\n  margin:0;\n  padding:0;\n  cursor:pointer;\n  font-family: sans-serif;\n  font-size: 11px;\n}\n.webaudio-knob-body{\n  display:inline-block;\n  position:relative;\n  z-index:1;\n  margin:0;\n  padding:0;\n}\n</style>\n<div class='webaudio-knob-body' tabindex='1' touch-action='none'></div><div class='webaudioctrl-tooltip'></div>\n`;\n\t\t\t\tthis.elem = root.childNodes[2];\n\t\t\t\tthis.ttframe = root.childNodes[3];\n\t\t\t\tthis.enable = this.getAttr(\"enable\", 1);\n\t\t\t\tthis._src = this.getAttr(\"src\", opt.knobSrc);\n\t\t\t\tthis._value = this.getAttr(\"value\", 0);\n\t\t\t\tthis.defvalue = this.getAttr(\"defvalue\", 0);\n\t\t\t\tthis._min = this.getAttr(\"min\", 0);\n\t\t\t\tthis._max = this.getAttr(\"max\", 100);\n\t\t\t\tthis._step = this.getAttr(\"step\", 1);\n\t\t\t\tthis._sprites = this.getAttr(\"sprites\", opt.knobSprites);\n\t\t\t\tthis._width = this.getAttr(\"width\", opt.knobWidth);\n\t\t\t\tthis._height = this.getAttr(\"height\", opt.knobHeight);\n\t\t\t\tthis._diameter = this.getAttr(\"diameter\", opt.knobDiameter);\n\t\t\t\tthis._colors = this.getAttr(\"colors\", opt.knobColors);\n\t\t\t\tthis.outline = this.getAttr(\"outline\", opt.outline);\n\t\t\t\tthis.sensitivity = this.getAttr(\"sensitivity\", 1);\n\t\t\t\tthis.valuetip = this.getAttr(\"valuetip\", 1);\n\t\t\t\tthis.tooltip = this.getAttr(\"tooltip\", null);\n\t\t\t\tthis.conv = this.getAttr(\"conv\", null);\n\t\t\t\tif (this.conv)\n\t\t\t\t\tthis.convValue = eval(this.conv)(this._value);\n\t\t\t\telse\n\t\t\t\t\tthis.convValue = this._value;\n\t\t\t\tthis.midilearn = this.getAttr(\"midilearn\", opt.midilearn);\n\t\t\t\tthis.midicc = this.getAttr(\"midicc\", null);\n\n\t\t\t\tthis.midiController = {};\n\t\t\t\tthis.midiMode = \"normal\";\n\t\t\t\tif (this.midicc) {\n\t\t\t\t\tlet ch = parseInt(this.midicc.substring(0, this.midicc.lastIndexOf(\".\"))) - 1;\n\t\t\t\t\tlet cc = parseInt(this.midicc.substring(this.midicc.lastIndexOf(\".\") + 1));\n\t\t\t\t\tthis.setMidiController(ch, cc);\n\t\t\t\t}\n\t\t\t\tthis.setupImage();\n\t\t\t\tthis.digits = 0;\n\t\t\t\tthis.coltab = [\"#e00\", \"#000\", \"#000\"];\n\t\t\t\tif (window.webAudioControlsMidiManager)\n\t\t\t\t\t//        window.webAudioControlsMidiManager.updateWidgets();\n\t\t\t\t\twindow.webAudioControlsMidiManager.addWidget(this);\n\t\t\t}\n\t\t\tdisconnectedCallback() { }\n\t\t\tsetupImage() {\n\t\t\t\tthis.kw = this.width || this.diameter;\n\t\t\t\tthis.kh = this.height || this.diameter;\n\t\t\t\tif (!this.src) {\n\t\t\t\t\tif (this.colors)\n\t\t\t\t\t\tthis.coltab = this.colors.split(\";\");\n\t\t\t\t\tif (!this.coltab)\n\t\t\t\t\t\tthis.coltab = [\"#e00\", \"#000\", \"#000\"];\n\t\t\t\t\tlet svg =\n\t\t\t\t\t\t`<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"64\" height=\"6464\" preserveAspectRatio=\"none\">\n<radialGradient id=\"gr\" cx=\"30%\" cy=\"30%\"><stop offset=\"0%\" stop-color=\"${this.coltab[2]}\"/><stop offset=\"100%\" stop-color=\"${this.coltab[1]}\"/></radialGradient>\n<defs><circle id=\"B\" cx=\"32\" cy=\"32\" r=\"30\" fill=\"url(#gr)\"/></defs>\n<defs><line id=\"K\" x1=\"32\" y1=\"28\" x2=\"32\" y2=\"7\" stroke-linecap=\"round\" stroke-width=\"6\" stroke=\"${this.coltab[0]}\"/></defs>`;\n\t\t\t\t\tfor (let i = 0; i < 101; ++i) {\n\t\t\t\t\t\tsvg += `<use xlink:href=\"#B\" y=\"${64 * i}\"/>`;\n\t\t\t\t\t\tsvg += `<use xlink:href=\"#K\" y=\"${64 * i}\" transform=\"rotate(${(-135 + 270 * i / 101).toFixed(2)},32,${64 * i + 32})\"/>`;\n\t\t\t\t\t}\n\t\t\t\t\tsvg += \"</svg>\";\n\t\t\t\t\tthis.elem.style.backgroundImage = \"url(data:image/svg+xml;base64,\" + btoa(svg) + \")\";\n\t\t\t\t\t//        this.elem.style.backgroundSize = \"100% 10100%\";\n\t\t\t\t\tthis.elem.style.backgroundSize = `${this.kw}px ${this.kh * 101}px`;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.elem.style.backgroundImage = \"url(\" + (this.src) + \")\";\n\t\t\t\t\tif (!this.sprites)\n\t\t\t\t\t\tthis.elem.style.backgroundSize = \"100% 100%\";\n\t\t\t\t\telse {\n\t\t\t\t\t\t//          this.elem.style.backgroundSize = `100% ${(this.sprites+1)*100}%`;\n\t\t\t\t\t\tthis.elem.style.backgroundSize = `${this.kw}px ${this.kh * (this.sprites + 1)}px`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.elem.style.outline = this.outline ? \"\" : \"none\";\n\t\t\t\tthis.elem.style.width = this.kw + \"px\";\n\t\t\t\tthis.elem.style.height = this.kh + \"px\";\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t\tredraw() {\n\t\t\t\tif (!this.isConnected) return;\n\t\t\t\tthis.digits = 0;\n\t\t\t\tif (this.step && this.step < 1) {\n\t\t\t\t\tfor (let n = this.step; n < 1; n *= 10)\n\t\t\t\t\t\t++this.digits;\n\t\t\t\t}\n\t\t\t\tif (this.value < this.min) {\n\t\t\t\t\tthis.value = this.min;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this.value > this.max) {\n\t\t\t\t\tthis.value = this.max;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet range = this.max - this.min;\n\t\t\t\tlet style = this.elem.style;\n\t\t\t\tlet sp = this.src ? this.sprites : 100;\n\t\t\t\tif (sp >= 1) {\n\t\t\t\t\tlet offset = ((sp * (this.value - this.min) / range) | 0);\n\t\t\t\t\tstyle.backgroundPosition = \"0px \" + (-offset * this.kh) + \"px\";\n\t\t\t\t\tstyle.transform = 'rotate(0deg)';\n\t\t\t\t} else {\n\t\t\t\t\tlet deg = 270 * ((this.value - this.min) / range - 0.5);\n\t\t\t\t\tstyle.backgroundPosition = \"0px 0px\";\n\t\t\t\t\tstyle.transform = 'rotate(' + deg + 'deg)';\n\t\t\t\t}\n\t\t\t}\n\t\t\t_setValue(v) {\n\t\t\t\tif (this.step)\n\t\t\t\t\tv = (Math.round((v - this.min) / this.step)) * this.step + this.min;\n\t\t\t\tthis._value = Math.min(this.max, Math.max(this.min, v));\n\t\t\t\tif (this._value != this.oldvalue) {\n\t\t\t\t\tthis.oldvalue = this._value;\n\t\t\t\t\tif (this.conv)\n\t\t\t\t\t\tthis.convValue = eval(this.conv)(this._value);\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.convValue = this._value;\n\t\t\t\t\tthis.redraw();\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tsetValue(v, f) {\n\t\t\t\tif (this._setValue(v) && f)\n\t\t\t\t\tthis.sendEvent(\"input\"), this.sendEvent(\"change\");\n\t\t\t}\n\t\t\twheel(e) {\n\t\t\t\tlet delta = (this.max - this.min) * 0.01;\n\t\t\t\tdelta = e.deltaY > 0 ? -delta : delta;\n\t\t\t\tif (!e.shiftKey)\n\t\t\t\t\tdelta *= 5;\n\t\t\t\tif (Math.abs(delta) < this.step)\n\t\t\t\t\tdelta = (delta > 0) ? +this.step : -this.step;\n\t\t\t\tthis.setValue(+this.value + delta, true);\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t\tpointerdown(ev) {\n\t\t\t\tif (!this.enable)\n\t\t\t\t\treturn;\n\t\t\t\tlet e = ev;\n\t\t\t\tif (ev.touches) {\n\t\t\t\t\te = ev.changedTouches[0];\n\t\t\t\t\tthis.identifier = e.identifier;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (e.buttons != 1 && e.button != 0)\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.elem.focus();\n\t\t\t\tthis.drag = 1;\n\t\t\t\tthis.showtip(0);\n\t\t\t\tlet pointermove = (ev) => {\n\t\t\t\t\tlet e = ev;\n\t\t\t\t\tif (ev.touches) {\n\t\t\t\t\t\tfor (let i = 0; i < ev.touches.length; ++i) {\n\t\t\t\t\t\t\tif (ev.touches[i].identifier == this.identifier) {\n\t\t\t\t\t\t\t\te = ev.touches[i];\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (this.lastShift !== e.shiftKey) {\n\t\t\t\t\t\tthis.lastShift = e.shiftKey;\n\t\t\t\t\t\tthis.startPosX = e.pageX;\n\t\t\t\t\t\tthis.startPosY = e.pageY;\n\t\t\t\t\t\tthis.startVal = this.value;\n\t\t\t\t\t}\n\t\t\t\t\tlet offset = (this.startPosY - e.pageY - this.startPosX + e.pageX) * this.sensitivity;\n\t\t\t\t\tthis._setValue(this.min + ((((this.startVal + (this.max - this.min) * offset / ((e.shiftKey ? 4 : 1) * 128)) - this.min) / this.step) | 0) * this.step);\n\t\t\t\t\tthis.sendEvent(\"input\");\n\t\t\t\t\tif (e.preventDefault)\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\tif (e.stopPropagation)\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tlet pointerup = (ev) => {\n\t\t\t\t\tlet e = ev;\n\t\t\t\t\tif (ev.touches) {\n\t\t\t\t\t\tfor (let i = 0; ;) {\n\t\t\t\t\t\t\tif (ev.changedTouches[i].identifier == this.identifier) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (++i >= ev.changedTouches.length)\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.drag = 0;\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\tthis.startPosX = this.startPosY = null;\n\t\t\t\t\twindow.removeEventListener('mousemove', pointermove);\n\t\t\t\t\twindow.removeEventListener('touchmove', pointermove, { passive: false });\n\t\t\t\t\twindow.removeEventListener('mouseup', pointerup);\n\t\t\t\t\twindow.removeEventListener('touchend', pointerup);\n\t\t\t\t\twindow.removeEventListener('touchcancel', pointerup);\n\t\t\t\t\tdocument.body.removeEventListener('touchstart', preventScroll, { passive: false });\n\t\t\t\t\tthis.sendEvent(\"change\");\n\t\t\t\t}\n\t\t\t\tlet preventScroll = (e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t\tif (e.ctrlKey || e.metaKey)\n\t\t\t\t\tthis.setValue(this.defvalue, true);\n\t\t\t\telse {\n\t\t\t\t\tthis.startPosX = e.pageX;\n\t\t\t\t\tthis.startPosY = e.pageY;\n\t\t\t\t\tthis.startVal = this.value;\n\t\t\t\t\twindow.addEventListener('mousemove', pointermove);\n\t\t\t\t\twindow.addEventListener('touchmove', pointermove, { passive: false });\n\t\t\t\t}\n\t\t\t\twindow.addEventListener('mouseup', pointerup);\n\t\t\t\twindow.addEventListener('touchend', pointerup);\n\t\t\t\twindow.addEventListener('touchcancel', pointerup);\n\t\t\t\tdocument.body.addEventListener('touchstart', preventScroll, { passive: false });\n\t\t\t\tev.preventDefault();\n\t\t\t\tev.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t} catch (error) {\n\t\t//console.log(\"webaudio-knob already defined\");\n\t}\n\n\ttry {\n\t\tcustomElements.define(\"webaudio-slider\", class WebAudioSlider extends WebAudioControlsWidget {\n\t\t\tconstructor() {\n\t\t\t\tsuper();\n\t\t\t}\n\t\t\tget src() { return this._src; }\n\t\t\tset src(v) { this._src = v; this.setupImage(); }\n\t\t\tget knobsrc() { return this._knobsrc; }\n\t\t\tset knobsrc(v) { this._knobsrc = v; this.setupImage(); }\n\t\t\tget value() { return this._value; }\n\t\t\tset value(v) { this._value = +v; this.redraw(); }\n\t\t\tget min() { return this._min; }\n\t\t\tset min(v) { this._min = +v; this.redraw(); }\n\t\t\tget max() { return this._max; }\n\t\t\tset max(v) { this._max = +v; this.redraw(); }\n\t\t\tget step() { return this._step; }\n\t\t\tset step(v) { this._step = +v; this.redraw(); }\n\t\t\tget sprites() { return this._sprites; }\n\t\t\tset sprites(v) { this._sprites = +v; this.setupImage(); }\n\t\t\tget direction() { return this._direction; }\n\t\t\tset direction(v) { this._direction = +v; this.setupImage(); }\n\t\t\tget width() { return this._width; }\n\t\t\tset width(v) { this._width = +v; this.setupImage(); }\n\t\t\tget height() { return this._height; }\n\t\t\tset height(v) { this._height = +v; this.setupImage(); }\n\t\t\tget knobwidth() { return this._knobwidth; }\n\t\t\tset knobwidth(v) { this._knobwidth = +v; this.setupImage(); }\n\t\t\tget knobheight() { return this._knobheight; }\n\t\t\tset knobheight(v) { this._knobheight = +v; this.setupImage(); }\n\t\t\tget ditchlength() { return this._ditchlength; }\n\t\t\tset ditchlength(v) { this._ditchlength = +v; this.setupImage(); }\n\t\t\tget colors() { return this._colors; }\n\t\t\tset colors(v) { this._colors = v; this.setupImage(); }\n\n\t\t\tconnectedCallback() {\n\t\t\t\tlet root;\n\t\t\t\t//      if(this.attachShadow)\n\t\t\t\t//        root=this.attachShadow({mode: 'open'});\n\t\t\t\t//      else\n\t\t\t\troot = this;\n\t\t\t\troot.innerHTML =\n\t\t\t\t\t`<style>\n${this.basestyle}\nwebaudio-slider{\n  display:inline-block;\n  position:relative;\n  margin:0;\n  padding:0;\n  font-family: sans-serif;\n  font-size: 11px;\n  cursor:pointer;\n}\n.webaudio-slider-body{\n  display:inline-block;\n  position:relative;\n  margin:0;\n  padding:0;\n}\n.webaudio-slider-knob{\n  display:inline-block;\n  position:absolute;\n  margin:0;\n  padding:0;\n}\n</style>\n<div class='webaudio-slider-body' tabindex='1' touch-action='none'><div class='webaudio-slider-knob' touch-action='none'></div></div><div class='webaudioctrl-tooltip'></div>\n`;\n\t\t\t\tthis.elem = root.childNodes[2];\n\t\t\t\tthis.knob = this.elem.childNodes[0];\n\t\t\t\tthis.ttframe = root.childNodes[3];\n\t\t\t\tthis.enable = this.getAttr(\"enable\", 1);\n\t\t\t\tthis._src = this.getAttr(\"src\", opt.sliderSrc);\n\t\t\t\tthis._knobsrc = this.getAttr(\"knobsrc\", opt.sliderKnobsrc);\n\t\t\t\tthis._value = this.getAttr(\"value\", 0);\n\t\t\t\tthis.defvalue = this.getAttr(\"defvalue\", 0);\n\t\t\t\tthis._min = this.getAttr(\"min\", 0);\n\t\t\t\tthis._max = this.getAttr(\"max\", 100);\n\t\t\t\tthis._step = this.getAttr(\"step\", 1);\n\t\t\t\tthis._sprites = this.getAttr(\"sprites\", 0);\n\t\t\t\tthis._direction = this.getAttr(\"direction\", null);\n\t\t\t\tthis._width = this.getAttr(\"width\", opt.sliderWidth);\n\t\t\t\tthis._height = this.getAttr(\"height\", opt.sliderHeight);\n\t\t\t\tif (this._direction == \"horz\") {\n\t\t\t\t\tif (this._width == 0) this._width = 128;\n\t\t\t\t\tif (this._height == 0) this._height = 24;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (this._width == 0) this._width = 24;\n\t\t\t\t\tif (this._height == 0) this._height = 128;\n\t\t\t\t}\n\t\t\t\tthis._knobwidth = this.getAttr(\"knobwidth\", opt.sliderKnobwidth);\n\t\t\t\tthis._knobheight = this.getAttr(\"knbheight\", opt.sliderKnobheight);\n\t\t\t\tthis._ditchlength = this.getAttr(\"ditchlength\", opt.sliderDitchlength);\n\t\t\t\tthis._colors = this.getAttr(\"colors\", opt.sliderColors);\n\t\t\t\tthis.outline = this.getAttr(\"outline\", opt.outline);\n\t\t\t\tthis.sensitivity = this.getAttr(\"sensitivity\", 1);\n\t\t\t\tthis.valuetip = this.getAttr(\"valuetip\", 1);\n\t\t\t\tthis.tooltip = this.getAttr(\"tooltip\", null);\n\t\t\t\tthis.conv = this.getAttr(\"conv\", null);\n\t\t\t\tif (this.conv)\n\t\t\t\t\tthis.convValue = eval(this.conv)(this._value);\n\t\t\t\telse\n\t\t\t\t\tthis.convValue = this._value;\n\t\t\t\tthis.midilearn = this.getAttr(\"midilearn\", opt.midilearn);\n\t\t\t\tthis.midicc = this.getAttr(\"midicc\", null);\n\t\t\t\tthis.midiController = {};\n\t\t\t\tthis.midiMode = \"normal\";\n\t\t\t\tif (this.midicc) {\n\t\t\t\t\tlet ch = parseInt(this.midicc.substring(0, this.midicc.lastIndexOf(\".\"))) - 1;\n\t\t\t\t\tlet cc = parseInt(this.midicc.substring(this.midicc.lastIndexOf(\".\") + 1));\n\t\t\t\t\tthis.setMidiController(ch, cc);\n\t\t\t\t}\n\t\t\t\tthis.setupImage();\n\t\t\t\tthis.digits = 0;\n\t\t\t\tif (window.webAudioControlsMidiManager)\n\t\t\t\t\t//        window.webAudioControlsMidiManager.updateWidgets();\n\t\t\t\t\twindow.webAudioControlsMidiManager.addWidget(this);\n\t\t\t\tthis.elem.onclick = (e) => { e.stopPropagation() };\n\t\t\t}\n\t\t\tdisconnectedCallback() { }\n\t\t\tsetupImage() {\n\t\t\t\tthis.coltab = this.colors.split(\";\");\n\t\t\t\tthis.dr = this.direction;\n\t\t\t\tthis.dlen = this.ditchlength;\n\t\t\t\tif (!this.width) {\n\t\t\t\t\tif (this.dr == \"horz\")\n\t\t\t\t\t\tthis.width = 128;\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.width = 24;\n\t\t\t\t}\n\t\t\t\tif (!this.height) {\n\t\t\t\t\tif (this.dr == \"horz\")\n\t\t\t\t\t\tthis.height = 24;\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.height = 128;\n\t\t\t\t}\n\t\t\t\tif (!this.dr)\n\t\t\t\t\tthis.dr = (this.width <= this.height) ? \"vert\" : \"horz\";\n\t\t\t\tif (this.dr == \"vert\") {\n\t\t\t\t\tif (!this.dlen)\n\t\t\t\t\t\tthis.dlen = this.height - this.width;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (!this.dlen)\n\t\t\t\t\t\tthis.dlen = this.width - this.height;\n\t\t\t\t}\n\t\t\t\tthis.knob.style.backgroundSize = \"100% 100%\";\n\t\t\t\tthis.elem.style.backgroundSize = \"100% 100%\";\n\t\t\t\tthis.elem.style.width = this.width + \"px\";\n\t\t\t\tthis.elem.style.height = this.height + \"px\";\n\t\t\t\tthis.kwidth = this.knobwidth || (this.dr == \"horz\" ? this.height : this.width);\n\t\t\t\tthis.kheight = this.knobheight || (this.dr == \"horz\" ? this.height : this.width);\n\t\t\t\tthis.knob.style.width = this.kwidth + \"px\";\n\t\t\t\tthis.knob.style.height = this.kheight + \"px\";\n\t\t\t\tif (!this.src) {\n\t\t\t\t\tlet r = Math.min(this.width, this.height) * 0.5;\n\t\t\t\t\tlet svgbody =\n\t\t\t\t\t\t`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${this.width}\" height=\"${this.height}\" preserveAspectRatio=\"none\">\n<rect x=\"1\" y=\"1\" rx=\"${r}\" ry=\"${r}\" width=\"${this.width - 2}\" height=\"${this.height - 2}\" fill=\"${this.coltab[1]}\"/></svg>`;\n\t\t\t\t\tthis.elem.style.backgroundImage = \"url(data:image/svg+xml;base64,\" + btoa(svgbody) + \")\";\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.elem.style.backgroundImage = \"url(\" + (this.src) + \")\";\n\t\t\t\t}\n\t\t\t\tif (!this.knobsrc) {\n\t\t\t\t\tlet svgthumb =\n\t\t\t\t\t\t`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${this.kwidth}\" height=\"${this.kheight}\" preserveAspectRatio=\"none\">\n<radialGradient id=\"gr\" cx=\"30%\" cy=\"30%\"><stop offset=\"0%\" stop-color=\"${this.coltab[2]}\"/><stop offset=\"100%\" stop-color=\"${this.coltab[0]}\"/></radialGradient>\n<rect x=\"2\" y=\"2\" width=\"${this.kwidth - 4}\" height=\"${this.kheight - 4}\" rx=\"${this.kwidth * 0.5}\" ry=\"${this.kheight * 0.5}\" fill=\"url(#gr)\"/></svg>`;\n\t\t\t\t\tthis.knob.style.backgroundImage = \"url(data:image/svg+xml;base64,\" + btoa(svgthumb) + \")\";\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.knob.style.backgroundImage = \"url(\" + (this.knobsrc) + \")\";\n\t\t\t\t}\n\t\t\t\tthis.elem.style.outline = this.outline ? \"\" : \"none\";\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t\tredraw() {\n\t\t\t\tif (!this.isConnected) return;\n\t\t\t\tthis.digits = 0;\n\t\t\t\tif (this.step && this.step < 1) {\n\t\t\t\t\tfor (let n = this.step; n < 1; n *= 10)\n\t\t\t\t\t\t++this.digits;\n\t\t\t\t}\n\t\t\t\tif (this.value < this.min) {\n\t\t\t\t\tthis.value = this.min;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this.value > this.max) {\n\t\t\t\t\tthis.value = this.max;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet range = this.max - this.min;\n\t\t\t\tlet style = this.knob.style;\n\t\t\t\tif (this.dr == \"vert\") {\n\t\t\t\t\tstyle.left = (this.width - this.kwidth) * 0.5 + \"px\";\n\t\t\t\t\tstyle.top = (1 - (this.value - this.min) / range) * this.dlen + \"px\";\n\t\t\t\t\tthis.sensex = 0; this.sensey = 1;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tstyle.top = (this.height - this.kheight) * 0.5 + \"px\";\n\t\t\t\t\tstyle.left = (this.value - this.min) / range * this.dlen + \"px\";\n\t\t\t\t\tthis.sensex = 1; this.sensey = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\t_setValue(v) {\n\t\t\t\tv = (Math.round((v - this.min) / this.step)) * this.step + this.min;\n\t\t\t\tthis._value = Math.min(this.max, Math.max(this.min, v));\n\t\t\t\tif (this._value != this.oldvalue) {\n\t\t\t\t\tthis.oldvalue = this._value;\n\t\t\t\t\tif (this.conv)\n\t\t\t\t\t\tthis.convValue = eval(this.conv)(this._value);\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.convValue = this._value;\n\t\t\t\t\tthis.redraw();\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tsetValue(v, f) {\n\t\t\t\tif (this._setValue(v) && f)\n\t\t\t\t\tthis.sendEvent(\"input\"), this.sendEvent(\"change\");\n\t\t\t}\n\t\t\twheel(e) {\n\t\t\t\tlet delta = (this.max - this.min) * 0.01;\n\t\t\t\tdelta = e.deltaY > 0 ? -delta : delta;\n\t\t\t\tif (!e.shiftKey)\n\t\t\t\t\tdelta *= 5;\n\t\t\t\tif (Math.abs(delta) < this.step)\n\t\t\t\t\tdelta = (delta > 0) ? +this.step : -this.step;\n\t\t\t\tthis.setValue(+this.value + delta, true);\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t\tpointerdown(ev) {\n\t\t\t\tif (!this.enable)\n\t\t\t\t\treturn;\n\t\t\t\tlet e = ev;\n\t\t\t\tif (ev.touches) {\n\t\t\t\t\te = ev.changedTouches[0];\n\t\t\t\t\tthis.identifier = e.identifier;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (e.buttons != 1 && e.button != 0)\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.elem.focus();\n\t\t\t\tthis.drag = 1;\n\t\t\t\tthis.showtip(0);\n\t\t\t\tlet pointermove = (ev) => {\n\t\t\t\t\tlet e = ev;\n\t\t\t\t\tif (ev.touches) {\n\t\t\t\t\t\tfor (let i = 0; i < ev.touches.length; ++i) {\n\t\t\t\t\t\t\tif (ev.touches[i].identifier == this.identifier) {\n\t\t\t\t\t\t\t\te = ev.touches[i];\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (this.lastShift !== e.shiftKey) {\n\t\t\t\t\t\tthis.lastShift = e.shiftKey;\n\t\t\t\t\t\tthis.startPosX = e.pageX;\n\t\t\t\t\t\tthis.startPosY = e.pageY;\n\t\t\t\t\t\tthis.startVal = this.value;\n\t\t\t\t\t}\n\t\t\t\t\tlet offset = ((this.startPosY - e.pageY) * this.sensey - (this.startPosX - e.pageX) * this.sensex) * this.sensitivity;\n\t\t\t\t\tthis._setValue(this.min + ((((this.startVal + (this.max - this.min) * offset / ((e.shiftKey ? 4 : 1) * this.dlen)) - this.min) / this.step) | 0) * this.step);\n\t\t\t\t\tthis.sendEvent(\"input\");\n\t\t\t\t\tif (e.preventDefault)\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\tif (e.stopPropagation)\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tlet pointerup = (ev) => {\n\t\t\t\t\tlet e = ev;\n\t\t\t\t\tif (ev.touches) {\n\t\t\t\t\t\tfor (let i = 0; ;) {\n\t\t\t\t\t\t\tif (ev.changedTouches[i].identifier == this.identifier) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (++i >= ev.changedTouches.length)\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.drag = 0;\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\tthis.startPosX = this.startPosY = null;\n\t\t\t\t\twindow.removeEventListener('mousemove', pointermove);\n\t\t\t\t\twindow.removeEventListener('touchmove', pointermove, { passive: false });\n\t\t\t\t\twindow.removeEventListener('mouseup', pointerup);\n\t\t\t\t\twindow.removeEventListener('touchend', pointerup);\n\t\t\t\t\twindow.removeEventListener('touchcancel', pointerup);\n\t\t\t\t\tdocument.body.removeEventListener('touchstart', preventScroll, { passive: false });\n\t\t\t\t\tthis.sendEvent(\"change\");\n\t\t\t\t}\n\t\t\t\tlet preventScroll = (e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t\tif (e.touches)\n\t\t\t\t\te = e.touches[0];\n\t\t\t\tif (e.ctrlKey || e.metaKey)\n\t\t\t\t\tthis.setValue(this.defvalue, true);\n\t\t\t\telse {\n\t\t\t\t\tthis.startPosX = e.pageX;\n\t\t\t\t\tthis.startPosY = e.pageY;\n\t\t\t\t\tthis.startVal = this.value;\n\t\t\t\t\twindow.addEventListener('mousemove', pointermove);\n\t\t\t\t\twindow.addEventListener('touchmove', pointermove, { passive: false });\n\t\t\t\t}\n\t\t\t\twindow.addEventListener('mouseup', pointerup);\n\t\t\t\twindow.addEventListener('touchend', pointerup);\n\t\t\t\twindow.addEventListener('touchcancel', pointerup);\n\t\t\t\tdocument.body.addEventListener('touchstart', preventScroll, { passive: false });\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t} catch (error) {\n\t\t//console.log(\"webaudio-slider already defined\");\n\t}\n\n\ttry {\n\t\tcustomElements.define(\"webaudio-switch\", class WebAudioSwitch extends WebAudioControlsWidget {\n\t\t\tconstructor() {\n\t\t\t\tsuper();\n\t\t\t}\n\t\t\tget src() { return this._src; }\n\t\t\tset src(v) { this._src = v; this.setupImage(); }\n\t\t\tget value() { return this._value; }\n\t\t\tset value(v) { this._value = +v; this.redraw(); }\n\t\t\tget width() { return this._width; }\n\t\t\tset width(v) { this._width = +v; this.setupImage(); }\n\t\t\tget height() { return this._height; }\n\t\t\tset height(v) { this._height = +v; this.setupImage(); }\n\t\t\tget diameter() { return this._diameter; }\n\t\t\tset diameter(v) { this._diameter = +v; this.setupImage(); }\n\t\t\tget colors() { return this._colors; }\n\t\t\tset colors(v) { this._colors = v; this.setupImage(); }\n\n\t\t\tconnectedCallback() {\n\t\t\t\tlet root;\n\t\t\t\t//      if(this.attachShadow)\n\t\t\t\t//        root=this.attachShadow({mode: 'open'});\n\t\t\t\t//      else\n\t\t\t\troot = this;\n\t\t\t\troot.innerHTML =\n\t\t\t\t\t`<style>\n${this.basestyle}\nwebaudio-switch{\n  display:inline-block;\n  margin:0;\n  padding:0;\n  font-family: sans-serif;\n  font-size: 11px;\n  cursor:pointer;\n}\n.webaudio-switch-body{\n  display:inline-block;\n  margin:0;\n  padding:0;\n}\n</style>\n<div class='webaudio-switch-body' tabindex='1' touch-action='none'><div class='webaudioctrl-tooltip'></div></div>\n`;\n\t\t\t\tthis.elem = root.childNodes[2];\n\t\t\t\tthis.ttframe = this.elem.childNodes[0];\n\n\t\t\t\tthis.enable = this.getAttr(\"enable\", 1);\n\t\t\t\tthis._src = this.getAttr(\"src\", null);\n\t\t\t\tthis._value = this.getAttr(\"value\", 0);\n\t\t\t\tthis.defvalue = this.getAttr(\"defvalue\", 0);\n\t\t\t\tthis.type = this.getAttr(\"type\", \"toggle\");\n\t\t\t\tthis.group = this.getAttr(\"group\", \"\");\n\t\t\t\tthis._width = this.getAttr(\"width\", 0);\n\t\t\t\tthis._height = this.getAttr(\"height\", 0);\n\t\t\t\tthis._diameter = this.getAttr(\"diameter\", 0);\n\t\t\t\tthis.invert = this.getAttr(\"invert\", 0);\n\t\t\t\tthis._colors = this.getAttr(\"colors\", opt.switchColors);\n\t\t\t\tthis.outline = this.getAttr(\"outline\", opt.outline);\n\t\t\t\tthis.valuetip = 0;\n\t\t\t\tthis.tooltip = this.getAttr(\"tooltip\", null);\n\t\t\t\tthis.midilearn = this.getAttr(\"midilearn\", opt.midilearn);\n\t\t\t\tthis.midicc = this.getAttr(\"midicc\", null);\n\t\t\t\tthis.midiController = {};\n\t\t\t\tthis.midiMode = \"normal\";\n\t\t\t\tif (this.midicc) {\n\t\t\t\t\tlet ch = parseInt(this.midicc.substring(0, this.midicc.lastIndexOf(\".\"))) - 1;\n\t\t\t\t\tlet cc = parseInt(this.midicc.substring(this.midicc.lastIndexOf(\".\") + 1));\n\t\t\t\t\tthis.setMidiController(ch, cc);\n\t\t\t\t}\n\t\t\t\tthis.setupImage();\n\t\t\t\tthis.digits = 0;\n\t\t\t\tif (window.webAudioControlsMidiManager)\n\t\t\t\t\t//        window.webAudioControlsMidiManager.updateWidgets();\n\t\t\t\t\twindow.webAudioControlsMidiManager.addWidget(this);\n\t\t\t\tthis.elem.onclick = (e) => { e.stopPropagation() };\n\t\t\t}\n\t\t\tdisconnectedCallback() { }\n\t\t\tsetupImage() {\n\t\t\t\tlet w = this.width || this.diameter || opt.switchWidth || opt.switchDiameter;\n\t\t\t\tlet h = this.height || this.diameter || opt.switchHeight || opt.switchDiameter;\n\t\t\t\tif (!this.src) {\n\t\t\t\t\tthis.coltab = this.colors.split(\";\");\n\t\t\t\t\tlet mm = Math.min(w, h);\n\t\t\t\t\tlet svg =\n\t\t\t\t\t\t`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${w}\" height=\"${h * 2}\" preserveAspectRatio=\"none\">\n<radialGradient id=\"gr\" cx=\"30%\" cy=\"30%\"><stop offset=\"0%\" stop-color=\"${this.coltab[2]}\"/><stop offset=\"100%\" stop-color=\"${this.coltab[0]}\"/></radialGradient>\n<rect x=\"${w * 0.05}\" y=\"${h * 0.05}\" width=\"${w * 0.9}\" height=\"${h * 0.9}\" rx=\"${mm * 0.1}\" ry=\"${mm * 0.1}\" fill=\"${this.coltab[1]}\"/>\n<rect x=\"${w * 0.05}\" y=\"${h * 1.05}\" width=\"${w * 0.9}\" height=\"${h * 0.9}\" rx=\"${mm * 0.1}\" ry=\"${mm * 0.1}\" fill=\"${this.coltab[1]}\"/>\n<circle cx=\"${w * 0.5}\" cy=\"${h * 0.5}\" r=\"${mm * 0.3}\" stroke=\"${this.coltab[0]}\" stroke-width=\"2\"/>\n<circle cx=\"${w * 0.5}\" cy=\"${h * 1.5}\" r=\"${mm * 0.3}\" stroke=\"${this.coltab[0]}\" stroke-width=\"2\" fill=\"url(#gr)\"/></svg>`;\n\t\t\t\t\tthis.elem.style.backgroundImage = \"url(data:image/svg+xml;base64,\" + btoa(svg) + \")\";\n\t\t\t\t\tthis.elem.style.backgroundSize = \"100% 200%\";\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.elem.style.backgroundImage = \"url(\" + (this.src) + \")\";\n\t\t\t\t\tif (!this.sprites)\n\t\t\t\t\t\tthis.elem.style.backgroundSize = \"100% 200%\";\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.elem.style.backgroundSize = `100% ${(this.sprites + 1) * 100}%`;\n\t\t\t\t}\n\t\t\t\tthis.elem.style.width = w + \"px\";\n\t\t\t\tthis.elem.style.height = h + \"px\";\n\t\t\t\tthis.elem.style.outline = this.outline ? \"\" : \"none\";\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t\tredraw() {\n\t\t\t\tif (!this.isConnected) return;\n\t\t\t\tlet style = this.elem.style;\n\t\t\t\tif (this.value ^ this.invert)\n\t\t\t\t\tstyle.backgroundPosition = \"0px -100%\";\n\t\t\t\telse\n\t\t\t\t\tstyle.backgroundPosition = \"0px 0px\";\n\t\t\t}\n\t\t\tsetValue(v, f) {\n\t\t\t\tconsole.log(v, f)\n\t\t\t\tthis.value = v;\n\t\t\t\tthis.checked = (!!v);\n\t\t\t\tif (this.value != this.oldvalue) {\n\t\t\t\t\tthis.redraw();\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\tif (f) {\n\t\t\t\t\t\tthis.sendEvent(\"input\");\n\t\t\t\t\t\tthis.sendEvent(\"change\");\n\t\t\t\t\t}\n\t\t\t\t\tthis.oldvalue = this.value;\n\t\t\t\t}\n\t\t\t}\n\t\t\tpointerdown(ev) {\n\t\t\t\tif (!this.enable)\n\t\t\t\t\treturn;\n\t\t\t\tlet e = ev;\n\t\t\t\tif (ev.touches) {\n\t\t\t\t\te = ev.changedTouches[0];\n\t\t\t\t\tthis.identifier = e.identifier;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (e.buttons != 1 && e.button != 0)\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.elem.focus();\n\t\t\t\tthis.drag = 1;\n\t\t\t\tthis.showtip(0);\n\t\t\t\tlet pointermove = (e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tlet pointerup = (e) => {\n\t\t\t\t\tthis.drag = 0;\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\twindow.removeEventListener('mousemove', pointermove);\n\t\t\t\t\twindow.removeEventListener('touchmove', pointermove, { passive: false });\n\t\t\t\t\twindow.removeEventListener('mouseup', pointerup);\n\t\t\t\t\twindow.removeEventListener('touchend', pointerup);\n\t\t\t\t\twindow.removeEventListener('touchcancel', pointerup);\n\t\t\t\t\tdocument.body.removeEventListener('touchstart', preventScroll, { passive: false });\n\t\t\t\t\tif (this.type == \"kick\") {\n\t\t\t\t\t\tthis.value = 0;\n\t\t\t\t\t\tthis.checked = false;\n\t\t\t\t\t\tthis.redraw();\n\t\t\t\t\t\tthis.sendEvent(\"change\");\n\t\t\t\t\t}\n\t\t\t\t\tthis.sendEvent(\"click\");\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t\tlet preventScroll = (e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t\tswitch (this.type) {\n\t\t\t\t\tcase \"kick\":\n\t\t\t\t\t\tthis.setValue(1);\n\t\t\t\t\t\tthis.sendEvent(\"change\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"toggle\":\n\t\t\t\t\t\tif (e.ctrlKey || e.metaKey)\n\t\t\t\t\t\t\tthis.value = defvalue;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthis.value = 1 - this.value;\n\t\t\t\t\t\tthis.checked = !!this.value;\n\t\t\t\t\t\tthis.sendEvent(\"change\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"radio\":\n\t\t\t\t\t\tlet els = document.querySelectorAll(\"webaudio-switch[type='radio'][group='\" + this.group + \"']\");\n\t\t\t\t\t\tfor (let i = 0; i < els.length; ++i) {\n\t\t\t\t\t\t\tif (els[i] == this)\n\t\t\t\t\t\t\t\tels[i].setValue(1);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tels[i].setValue(0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.sendEvent(\"change\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\twindow.addEventListener('mouseup', pointerup);\n\t\t\t\twindow.addEventListener('touchend', pointerup);\n\t\t\t\twindow.addEventListener('touchcancel', pointerup);\n\t\t\t\tdocument.body.addEventListener('touchstart', preventScroll, { passive: false });\n\t\t\t\tthis.redraw();\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t} catch (error) {\n\t\t//console.log(\"webaudio-switch already defined\");\n\t}\n\n\ttry {\n\t\tcustomElements.define(\"webaudio-param\", class WebAudioParam extends WebAudioControlsWidget {\n\t\t\tconstructor() {\n\t\t\t\tsuper();\n\t\t\t\tthis.addEventListener(\"keydown\", this.keydown);\n\t\t\t\tthis.addEventListener(\"mousedown\", this.pointerdown, { passive: false });\n\t\t\t\tthis.addEventListener(\"touchstart\", this.pointerdown, { passive: false });\n\t\t\t\tthis.addEventListener(\"wheel\", this.wheel);\n\t\t\t\tthis.addEventListener(\"mouseover\", this.pointerover);\n\t\t\t\tthis.addEventListener(\"mouseout\", this.pointerout);\n\t\t\t\tthis.addEventListener(\"contextmenu\", this.contextMenu);\n\t\t\t}\n\t\t\tget src() { return this._src; }\n\t\t\tset src(v) { this._src = v; this.setupImage(); }\n\t\t\tget value() { return this._value; }\n\t\t\tset value(v) { this._value = +v; this.redraw(); }\n\t\t\tget fontsize() { return this._fontsize; }\n\t\t\tset fontsize(v) { this._fontsize = +v; this.setupImage(); }\n\t\t\tget width() { return this._width; }\n\t\t\tset width(v) { this._width = +v; this.setupImage(); }\n\t\t\tget height() { return this._height; }\n\t\t\tset height(v) { this._height = +v; this.setupImage(); }\n\t\t\tget colors() { return this._colors; }\n\t\t\tset colors(v) { this._colors = v; this.setupImage(); }\n\n\t\t\tconnectedCallback() {\n\t\t\t\tlet root;\n\t\t\t\t//      if(this.attachShadow)\n\t\t\t\t//        root=this.attachShadow({mode: 'open'});\n\t\t\t\t//      else\n\t\t\t\troot = this;\n\t\t\t\troot.innerHTML =\n\t\t\t\t\t`<style>\n${this.basestyle}\nwebaudio-param{\n  display:inline-block;\n  user-select:none;\n  margin:0;\n  padding:0;\n  font-family: sans-serif;\n  font-size: 8px;\n  cursor:pointer;\n}\n.webaudio-param-body{\n  display:inline-block;\n  text-align:center;\n  vertical-align:middle;\n  position:relative;\n  border:1px solid #888;\n  background:none;\n  border-radius:4px;\n  margin:0;\n  padding:0;\n  font-family:sans-serif;\n  font-size:11px;\n}\n</style>\n<input class='webaudio-param-body' value='0' tabindex='1' touch-action='none'/><div class='webaudioctrl-tooltip'></div>\n`;\n\t\t\t\tthis.elem = root.childNodes[2];\n\t\t\t\tthis.ttframe = root.childNodes[3];\n\t\t\t\tthis.enable = this.getAttr(\"enable\", 1);\n\t\t\t\tthis._value = this.getAttr(\"value\", 0);\n\t\t\t\tthis.defvalue = this.getAttr(\"defvalue\", 0);\n\t\t\t\tthis._fontsize = this.getAttr(\"fontsize\", 9);\n\t\t\t\tthis._src = this.getAttr(\"src\", null);\n\t\t\t\tthis.link = this.getAttr(\"link\", \"\");\n\t\t\t\tthis._width = this.getAttr(\"width\", 32);\n\t\t\t\tthis._height = this.getAttr(\"height\", 16);\n\t\t\t\tthis._colors = this.getAttr(\"colors\", \"#fff;#000\");\n\t\t\t\tthis.outline = this.getAttr(\"outline\", opt.outline);\n\t\t\t\tthis.midiController = {};\n\t\t\t\tthis.midiMode = \"normal\";\n\t\t\t\tif (this.midicc) {\n\t\t\t\t\tlet ch = parseInt(this.midicc.substring(0, this.midicc.lastIndexOf(\".\"))) - 1;\n\t\t\t\t\tlet cc = parseInt(this.midicc.substring(this.midicc.lastIndexOf(\".\") + 1));\n\t\t\t\t\tthis.setMidiController(ch, cc);\n\t\t\t\t}\n\t\t\t\tthis.setupImage();\n\t\t\t\tif (window.webAudioControlsMidiManager)\n\t\t\t\t\t//        window.webAudioControlsMidiManager.updateWidgets();\n\t\t\t\t\twindow.webAudioControlsMidiManager.addWidget(this);\n\t\t\t\tthis.fromLink = ((e) => {\n\t\t\t\t\tthis.setValue(e.target.convValue.toFixed(e.target.digits));\n\t\t\t\t}).bind(this);\n\t\t\t\tthis.elem.onchange = () => {\n\t\t\t\t\tlet le = document.getElementById(this.link);\n\t\t\t\t\tif (le)\n\t\t\t\t\t\tle.setValue(+this.elem.value);\n\t\t\t\t}\n\t\t\t}\n\t\t\tdisconnectedCallback() { }\n\t\t\tsetupImage() {\n\t\t\t\tthis.coltab = this.colors.split(\";\");\n\t\t\t\tthis.elem.style.color = this.coltab[0];\n\t\t\t\tif (!this.src) {\n\t\t\t\t\tthis.elem.style.backgroundColor = this.coltab[1];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.elem.style.backgroundImage = \"url(\" + (this.src) + \")\";\n\t\t\t\t\tthis.elem.style.backgroundSize = \"100% 100%\";\n\t\t\t\t}\n\t\t\t\tthis.elem.style.width = this.width + \"px\";\n\t\t\t\tthis.elem.style.height = this.height + \"px\";\n\t\t\t\tthis.elem.style.fontSize = this.fontsize + \"px\";\n\t\t\t\tthis.elem.style.outline = this.outline ? \"\" : \"none\";\n\t\t\t\tlet l = document.getElementById(this.link);\n\t\t\t\tif (l) {\n\t\t\t\t\tthis.setValue(l.value.toFixed(l.digits));\n\t\t\t\t\tl.addEventListener(\"input\", (e) => { this.setValue(l.value.toFixed(l.digits)) });\n\t\t\t\t}\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t\tredraw() {\n\t\t\t\tif (!this.isConnected) return;\n\t\t\t\tthis.elem.value = this.value;\n\t\t\t}\n\t\t\tsetValue(v, f) {\n\t\t\t\tthis.value = v;\n\t\t\t\tif (this.value != this.oldvalue) {\n\t\t\t\t\tthis.redraw();\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\tif (f) {\n\t\t\t\t\t\tlet event = document.createEvent(\"HTMLEvents\");\n\t\t\t\t\t\tevent.initEvent(\"change\", false, true);\n\t\t\t\t\t\tthis.dispatchEvent(event);\n\t\t\t\t\t}\n\t\t\t\t\tthis.oldvalue = this.value;\n\t\t\t\t}\n\t\t\t}\n\t\t\tpointerdown(ev) {\n\t\t\t\tif (!this.enable)\n\t\t\t\t\treturn;\n\t\t\t\tlet e = ev;\n\t\t\t\tif (ev.touches)\n\t\t\t\t\te = ev.touches[0];\n\t\t\t\telse {\n\t\t\t\t\tif (e.buttons != 1 && e.button != 0)\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.elem.focus();\n\t\t\t\tthis.drag = 1;\n\t\t\t\tthis.showtip(0);\n\t\t\t\tlet pointermove = (e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tlet pointerup = (e) => {\n\t\t\t\t\tthis.drag = 0;\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\twindow.removeEventListener('mouseup', pointerup);\n\t\t\t\t\twindow.removeEventListener('touchend', pointerup);\n\t\t\t\t\twindow.removeEventListener('touchcancel', pointerup);\n\t\t\t\t\tdocument.body.removeEventListener('touchstart', preventScroll, { passive: false });\n\t\t\t\t}\n\t\t\t\tlet preventScroll = (e) => {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t\twindow.addEventListener('mouseup', pointerup);\n\t\t\t\twindow.addEventListener('touchend', pointerup);\n\t\t\t\twindow.addEventListener('touchcancel', pointerup);\n\t\t\t\tdocument.body.addEventListener('touchstart', preventScroll, { passive: false });\n\t\t\t\tthis.redraw();\n\t\t\t\tif (e.preventDefault)\n\t\t\t\t\te.preventDefault();\n\t\t\t\tif (e.stopPropagation)\n\t\t\t\t\te.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t} catch (error) {\n\t\t//console.log(\"webaudio-param already defined\");\n\t}\n\n\ttry {\n\t\tcustomElements.define(\"webaudio-keyboard\", class WebAudioKeyboard extends WebAudioControlsWidget {\n\t\t\tconstructor() {\n\t\t\t\tsuper();\n\t\t\t}\n\t\t\tget width() { return this._width; }\n\t\t\tset width(v) { this._width = v; this.setupImage(); }\n\t\t\tget height() { return this._height; }\n\t\t\tset height(v) { this._height = v; this.setupImage(); }\n\t\t\tget min() { return this._min; }\n\t\t\tset min(v) { this._min = +v; this.redraw(); }\n\t\t\tget step() { return this._step; }\n\t\t\tset step(v) { this._step = +v; this.redraw(); }\n\t\t\tget keys() { return this._keys; }\n\t\t\tset keys(v) { this._keys = +v; this.setupImage(); }\n\t\t\tget colors() { return this._colors; }\n\t\t\tset colors(v) { this._colors = v; this.setupImage(); }\n\n\t\t\tconnectedCallback() {\n\t\t\t\tlet root;\n\t\t\t\t//      if(this.attachShadow)\n\t\t\t\t//        root=this.attachShadow({mode: 'open'});\n\t\t\t\t//      else\n\t\t\t\troot = this;\n\t\t\t\troot.innerHTML =\n\t\t\t\t\t`<style>\n${this.basestyle}\nwebaudio-keyboard{\n  display:inline-block;\n  position:relative;\n  margin:0;\n  padding:0;\n  font-family: sans-serif;\n  font-size: 11px;\n}\n.webaudio-keyboard-body{\n  display:inline-block;\n  margin:0;\n  padding:0;\n}\n</style>\n<canvas class='webaudio-keyboard-body' tabindex='1' touch-action='none'></canvas><div class='webauioctrl-tooltip'></div>\n`;\n\t\t\t\tthis.cv = root.childNodes[2];\n\t\t\t\tthis.ttframe = root.childNodes[3];\n\t\t\t\tthis.ctx = this.cv.getContext(\"2d\");\n\t\t\t\tthis._values = [];\n\t\t\t\tthis.enable = this.getAttr(\"enable\", 1);\n\t\t\t\tthis._width = this.getAttr(\"width\", 480);\n\t\t\t\tthis._height = this.getAttr(\"height\", 128);\n\t\t\t\tthis._min = this.getAttr(\"min\", 0);\n\t\t\t\tthis._keys = this.getAttr(\"keys\", 25);\n\t\t\t\tthis._colors = this.getAttr(\"colors\", \"#222;#eee;#ccc;#333;#000;#e88;#c44;#c33;#800\");\n\t\t\t\tthis.outline = this.getAttr(\"outline\", opt.outline);\n\t\t\t\tthis.midilearn = this.getAttr(\"midilearn\", 0);\n\t\t\t\tthis.midicc = this.getAttr(\"midicc\", null);\n\t\t\t\tthis.press = 0;\n\t\t\t\tthis.keycodes1 = [90, 83, 88, 68, 67, 86, 71, 66, 72, 78, 74, 77, 188, 76, 190, 187, 191, 226];\n\t\t\t\tthis.keycodes2 = [81, 50, 87, 51, 69, 82, 53, 84, 54, 89, 55, 85, 73, 57, 79, 48, 80, 192, 222, 219];\n\t\t\t\tthis.addEventListener(\"keyup\", this.keyup);\n\t\t\t\tthis.midiController = {};\n\t\t\t\tthis.midiMode = \"normal\";\n\t\t\t\tif (this.midicc) {\n\t\t\t\t\tlet ch = parseInt(this.midicc.substring(0, this.midicc.lastIndexOf(\".\"))) - 1;\n\t\t\t\t\tlet cc = parseInt(this.midicc.substring(this.midicc.lastIndexOf(\".\") + 1));\n\t\t\t\t\tthis.setMidiController(ch, cc);\n\t\t\t\t}\n\t\t\t\tthis.setupImage();\n\t\t\t\tthis.digits = 0;\n\t\t\t\tthis.addEventListener(\"mousemove\", this.pointermove);\n\t\t\t\tthis.addEventListener(\"touchmove\", this.pointermove, { passive: false });\n\t\t\t\tthis.addEventListener(\"mouseup\", this.pointerup);\n\t\t\t\tthis.addEventListener(\"touchend\", this.pointerup);\n\t\t\t\tthis.addEventListener(\"touchcancel\", this.pointerup);\n\t\t\t\tif (window.webAudioControlsMidiManager)\n\t\t\t\t\t//        window.webAudioControlsMidiManager.updateWidgets();\n\t\t\t\t\twindow.webAudioControlsMidiManager.addWidget(this);\n\t\t\t}\n\t\t\tdisconnectedCallback() { }\n\t\t\tsetupImage() {\n\t\t\t\tthis.cv.style.width = this.width + \"px\";\n\t\t\t\tthis.cv.style.height = this.height + \"px\";\n\t\t\t\tthis.bheight = this.height * 0.55;\n\t\t\t\tthis.kp = [0, 7 / 12, 1, 3 * 7 / 12, 2, 3, 6 * 7 / 12, 4, 8 * 7 / 12, 5, 10 * 7 / 12, 6];\n\t\t\t\tthis.kf = [0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0];\n\t\t\t\tthis.ko = [0, 0, (7 * 2) / 12 - 1, 0, (7 * 4) / 12 - 2, (7 * 5) / 12 - 3, 0, (7 * 7) / 12 - 4, 0, (7 * 9) / 12 - 5, 0, (7 * 11) / 12 - 6];\n\t\t\t\tthis.kn = [0, 2, 4, 5, 7, 9, 11];\n\t\t\t\tthis.coltab = this.colors.split(\";\");\n\t\t\t\tthis.cv.width = this.width;\n\t\t\t\tthis.cv.height = this.height;\n\t\t\t\tthis.cv.style.width = this.width + 'px';\n\t\t\t\tthis.cv.style.height = this.height + 'px';\n\t\t\t\tthis.cv.style.outline = this.outline ? \"\" : \"none\";\n\t\t\t\tthis.bheight = this.height * 0.55;\n\t\t\t\tthis.max = this.min + this.keys - 1;\n\t\t\t\tthis.dispvalues = [];\n\t\t\t\tthis.valuesold = [];\n\t\t\t\tif (this.kf[this.min % 12])\n\t\t\t\t\t--this.min;\n\t\t\t\tif (this.kf[this.max % 12])\n\t\t\t\t\t++this.max;\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t\tredraw() {\n\t\t\t\tif (!this.isConnected) return;\n\t\t\t\tfunction rrect(ctx, x, y, w, h, r, c1, c2) {\n\t\t\t\t\tif (c2) {\n\t\t\t\t\t\tlet g = ctx.createLinearGradient(x, y, x + w, y);\n\t\t\t\t\t\tg.addColorStop(0, c1);\n\t\t\t\t\t\tg.addColorStop(1, c2);\n\t\t\t\t\t\tctx.fillStyle = g;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tctx.fillStyle = c1;\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.moveTo(x, y);\n\t\t\t\t\tctx.lineTo(x + w, y);\n\t\t\t\t\tctx.lineTo(x + w, y + h - r);\n\t\t\t\t\tctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);\n\t\t\t\t\tctx.lineTo(x + r, y + h);\n\t\t\t\t\tctx.quadraticCurveTo(x, y + h, x, y + h - r);\n\t\t\t\t\tctx.lineTo(x, y);\n\t\t\t\t\tctx.fill();\n\t\t\t\t}\n\t\t\t\tthis.ctx.fillStyle = this.coltab[0];\n\t\t\t\tthis.ctx.fillRect(0, 0, this.width, this.height);\n\t\t\t\tlet x0 = 7 * ((this.min / 12) | 0) + this.kp[this.min % 12];\n\t\t\t\tlet x1 = 7 * ((this.max / 12) | 0) + this.kp[this.max % 12];\n\t\t\t\tlet n = x1 - x0;\n\t\t\t\tthis.wwidth = (this.width - 1) / (n + 1);\n\t\t\t\tthis.bwidth = this.wwidth * 7 / 12;\n\t\t\t\tlet h2 = this.bheight;\n\t\t\t\tlet r = Math.min(8, this.wwidth * 0.2);\n\t\t\t\tfor (let i = this.min, j = 0; i <= this.max; ++i) {\n\t\t\t\t\tif (this.kf[i % 12] == 0) {\n\t\t\t\t\t\tlet x = this.wwidth * (j++) + 1;\n\t\t\t\t\t\tif (this.dispvalues.indexOf(i) >= 0)\n\t\t\t\t\t\t\trrect(this.ctx, x, 1, this.wwidth - 1, this.height - 2, r, this.coltab[5], this.coltab[6]);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\trrect(this.ctx, x, 1, this.wwidth - 1, this.height - 2, r, this.coltab[1], this.coltab[2]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tr = Math.min(8, this.bwidth * 0.3);\n\t\t\t\tfor (let i = this.min; i < this.max; ++i) {\n\t\t\t\t\tif (this.kf[i % 12]) {\n\t\t\t\t\t\tlet x = this.wwidth * this.ko[this.min % 12] + this.bwidth * (i - this.min) + 1;\n\t\t\t\t\t\tif (this.dispvalues.indexOf(i) >= 0)\n\t\t\t\t\t\t\trrect(this.ctx, x, 1, this.bwidth, h2, r, this.coltab[7], this.coltab[8]);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\trrect(this.ctx, x, 1, this.bwidth, h2, r, this.coltab[3], this.coltab[4]);\n\t\t\t\t\t\tthis.ctx.strokeStyle = this.coltab[0];\n\t\t\t\t\t\tthis.ctx.stroke();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t_setValue(v) {\n\t\t\t\tif (this.step)\n\t\t\t\t\tv = (Math.round((v - this.min) / this.step)) * this.step + this.min;\n\t\t\t\tthis._value = Math.min(this.max, Math.max(this.min, v));\n\t\t\t\tif (this._value != this.oldvalue) {\n\t\t\t\t\tthis.oldvalue = this._value;\n\t\t\t\t\tthis.redraw();\n\t\t\t\t\tthis.showtip(0);\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tsetValue(v, f) {\n\t\t\t\tif (this._setValue(v) && f)\n\t\t\t\t\tthis.sendEvent(\"input\"), this.sendEvent(\"change\");\n\t\t\t}\n\t\t\twheel(e) { }\n\t\t\tkeydown(e) {\n\t\t\t\tlet m = Math.floor((this.min + 11) / 12) * 12;\n\t\t\t\tlet k = this.keycodes1.indexOf(e.keyCode);\n\t\t\t\tif (k < 0) {\n\t\t\t\t\tk = this.keycodes2.indexOf(e.keyCode);\n\t\t\t\t\tif (k >= 0) k += 12;\n\t\t\t\t}\n\t\t\t\tif (k >= 0) {\n\t\t\t\t\tk += m;\n\t\t\t\t\tif (this.currentKey != k) {\n\t\t\t\t\t\tthis.currentKey = k;\n\t\t\t\t\t\tthis.sendEventFromKey(1, k);\n\t\t\t\t\t\tthis.setNote(1, k);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tkeyup(e) {\n\t\t\t\tlet m = Math.floor((this.min + 11) / 12) * 12;\n\t\t\t\tlet k = this.keycodes1.indexOf(e.keyCode);\n\t\t\t\tif (k < 0) {\n\t\t\t\t\tk = this.keycodes2.indexOf(e.keyCode);\n\t\t\t\t\tif (k >= 0) k += 12;\n\t\t\t\t}\n\t\t\t\tif (k >= 0) {\n\t\t\t\t\tk += m;\n\t\t\t\t\tthis.currentKey = -1;\n\t\t\t\t\tthis.sendEventFromKey(0, k);\n\t\t\t\t\tthis.setNote(0, k);\n\t\t\t\t}\n\t\t\t}\n\t\t\tpointerdown(e) {\n\t\t\t\tthis.cv.focus();\n\t\t\t\t//      document.body.addEventListener('touchstart',this.preventScroll,{passive:false});\n\t\t\t\tif (this.enable) {\n\t\t\t\t\t++this.press;\n\t\t\t\t\tthis.pointermove(e);\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\tpointermove(e) {\n\t\t\t\tif (!this.enable)\n\t\t\t\t\treturn;\n\t\t\t\tlet r = this.getBoundingClientRect();\n\t\t\t\tlet v = [], p;\n\t\t\t\tif (e.touches)\n\t\t\t\t\tp = e.targetTouches;\n\t\t\t\telse if (this.press)\n\t\t\t\t\tp = [e];\n\t\t\t\telse\n\t\t\t\t\tp = [];\n\t\t\t\tif (p.length > 0)\n\t\t\t\t\tthis.drag = 1;\n\t\t\t\tfor (let i = 0; i < p.length; ++i) {\n\t\t\t\t\tlet px = p[i].clientX - r.left;\n\t\t\t\t\tlet py = p[i].clientY - r.top;\n\t\t\t\t\tlet x, k, ko;\n\t\t\t\t\tif (py < this.bheight) {\n\t\t\t\t\t\tx = px - this.wwidth * this.ko[this.min % 12];\n\t\t\t\t\t\tk = this.min + ((x / this.bwidth) | 0);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tk = (px / this.wwidth) | 0;\n\t\t\t\t\t\tko = this.kp[this.min % 12];\n\t\t\t\t\t\tk += ko;\n\t\t\t\t\t\tk = this.min + ((k / 7) | 0) * 12 + this.kn[k % 7] - this.kn[ko % 7];\n\t\t\t\t\t}\n\t\t\t\t\tif (k >= this.min && k <= this.max)\n\t\t\t\t\t\tv.push(k);\n\t\t\t\t}\n\t\t\t\tv.sort();\n\t\t\t\tthis.values = v;\n\t\t\t\tthis.sendevent();\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t\tpointerup(e) {\n\t\t\t\tif (this.enable) {\n\t\t\t\t\t--this.press;\n\t\t\t\t\tthis.pointermove(e);\n\t\t\t\t\tthis.sendevent();\n\t\t\t\t\tthis.redraw();\n\t\t\t\t}\n\t\t\t\tthis.drag = 0;\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\tsendEventFromKey(s, k) {\n\t\t\t\tlet ev = document.createEvent('HTMLEvents');\n\t\t\t\tev.initEvent('change', true, true);\n\t\t\t\tev.note = [s, k];\n\t\t\t\tthis.dispatchEvent(ev);\n\t\t\t}\n\t\t\tsendevent() {\n\t\t\t\tlet notes = [];\n\t\t\t\tfor (let i = 0, j = this.valuesold.length; i < j; ++i) {\n\t\t\t\t\tif (this.values.indexOf(this.valuesold[i]) < 0)\n\t\t\t\t\t\tnotes.push([0, this.valuesold[i]]);\n\t\t\t\t}\n\t\t\t\tfor (let i = 0, j = this.values.length; i < j; ++i) {\n\t\t\t\t\tif (this.valuesold.indexOf(this.values[i]) < 0)\n\t\t\t\t\t\tnotes.push([1, this.values[i]]);\n\t\t\t\t}\n\t\t\t\tif (notes.length) {\n\t\t\t\t\tthis.valuesold = this.values;\n\t\t\t\t\tfor (let i = 0; i < notes.length; ++i) {\n\t\t\t\t\t\tthis.setdispvalues(notes[i][0], notes[i][1]);\n\t\t\t\t\t\tlet ev = document.createEvent('HTMLEvents');\n\t\t\t\t\t\tev.initEvent('change', true, true);\n\t\t\t\t\t\tev.note = notes[i];\n\t\t\t\t\t\tthis.dispatchEvent(ev);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tsetdispvalues(state, note) {\n\t\t\t\tlet n = this.dispvalues.indexOf(note);\n\t\t\t\tif (state) {\n\t\t\t\t\tif (n < 0) this.dispvalues.push(note);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (n >= 0) this.dispvalues.splice(n, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t\tsetNote(state, note) {\n\t\t\t\tthis.setdispvalues(state, note);\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t});\n\t} catch (error) {\n\t\t//console.log(\"webaudio-keyboard already defined\");\n\t}\n\n\t// FOR MIDI LEARN\n\tclass WebAudioControlsMidiManager {\n\t\tconstructor() {\n\t\t\tthis.midiAccess = null;\n\t\t\tthis.listOfWidgets = [];\n\t\t\tthis.listOfExternalMidiListeners = [];\n\t\t\tthis.updateWidgets();\n\t\t\tthis.initWebAudioControls();\n\t\t}\n\t\taddWidget(w) {\n\t\t\tthis.listOfWidgets.push(w);\n\t\t}\n\t\tupdateWidgets() {\n\t\t\t//      this.listOfWidgets = document.querySelectorAll(\"webaudio-knob,webaudio-slider,webaudio-switch\");\n\t\t}\n\t\tinitWebAudioControls() {\n\t\t\tif (navigator.requestMIDIAccess) {\n\t\t\t\tnavigator.requestMIDIAccess().then(\n\t\t\t\t\t(ma) => { this.midiAccess = ma, this.enableInputs() },\n\t\t\t\t\t(err) => { console.log(\"MIDI not initialized - error encountered:\" + err.code) }\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tenableInputs() {\n\t\t\tlet inputs = this.midiAccess.inputs.values();\n\t\t\t//console.log(\"Found \" + this.midiAccess.inputs.size + \" MIDI input(s)\");\n\t\t\tfor (let input = inputs.next(); input && !input.done; input = inputs.next()) {\n\t\t\t\t//console.log(\"Connected input: \" + input.value.name);\n\t\t\t\tinput.value.onmidimessage = this.handleMIDIMessage.bind(this);\n\t\t\t}\n\t\t}\n\t\tmidiConnectionStateChange(e) {\n\t\t\t// console.log(\"connection: \" + e.port.name + \" \" + e.port.connection + \" \" + e.port.state);\n\t\t\tenableInputs();\n\t\t}\n\n\t\tonMIDIStarted(midi) {\n\t\t\tthis.midiAccess = midi;\n\t\t\tmidi.onstatechange = this.midiConnectionStateChange;\n\t\t\tenableInputs(midi);\n\t\t}\n\t\t// Add hooks for external midi listeners support\n\t\taddMidiListener(callback) {\n\t\t\tthis.listOfExternalMidiListeners.push(callback);\n\t\t}\n\t\tgetCurrentConfigAsJSON() {\n\t\t\treturn currentConfig.stringify();\n\t\t}\n\t\thandleMIDIMessage(event) {\n\t\t\tthis.listOfExternalMidiListeners.forEach(function (externalListener) {\n\t\t\t\texternalListener(event);\n\t\t\t});\n\t\t\tif (((event.data[0] & 0xf0) == 0xf0) || ((event.data[0] & 0xf0) == 0xb0 && event.data[1] >= 120))\n\t\t\t\treturn;\n\t\t\tfor (let w of this.listOfWidgets) {\n\t\t\t\tif (w.processMidiEvent)\n\t\t\t\t\tw.processMidiEvent(event);\n\t\t\t}\n\t\t\tif (opt.mididump)\n\t\t\t\tconsole.log(event.data);\n\t\t}\n\t\tcontextMenuOpen(e, knob) {\n\t\t\tif (!this.midiAccess)\n\t\t\t\treturn;\n\t\t\tlet menu = document.getElementById(\"webaudioctrl-context-menu\");\n\t\t\tmenu.style.left = e.pageX + \"px\";\n\t\t\tmenu.style.top = e.pageY + \"px\";\n\t\t\tmenu.knob = knob;\n\t\t\tmenu.classList.add(\"active\");\n\t\t\tmenu.knob.focus();\n\t\t\t//      document.activeElement.onblur=this.contextMenuClose;\n\t\t\tmenu.knob.addEventListener(\"keydown\", this.contextMenuCloseByKey.bind(this));\n\t\t}\n\t\tcontextMenuCloseByKey(e) {\n\t\t\tif (e.keyCode == 27)\n\t\t\t\tthis.contextMenuClose();\n\t\t}\n\t\tcontextMenuClose() {\n\t\t\tlet menu = document.getElementById(\"webaudioctrl-context-menu\");\n\t\t\tmenu.knob.removeEventListener(\"keydown\", this.contextMenuCloseByKey);\n\t\t\tmenu.classList.remove(\"active\");\n\t\t\tlet menuItemLearn = document.getElementById(\"webaudioctrl-context-menu-learn\");\n\t\t\tmenuItemLearn.innerHTML = 'Learn';\n\t\t\tmenu.knob.midiMode = 'normal';\n\t\t}\n\t\tcontextMenuLearn() {\n\t\t\tlet menu = document.getElementById(\"webaudioctrl-context-menu\");\n\t\t\tlet menuItemLearn = document.getElementById(\"webaudioctrl-context-menu-learn\");\n\t\t\tmenuItemLearn.innerHTML = 'Listening...';\n\t\t\tmenu.knob.midiMode = 'learn';\n\t\t}\n\t\tcontextMenuClear(e) {\n\t\t\tlet menu = document.getElementById(\"webaudioctrl-context-menu\");\n\t\t\tmenu.knob.midiController = {};\n\t\t\tthis.contextMenuClose();\n\t\t}\n\t}\n\tif (window.UseWebAudioControlsMidi || opt.useMidi)\n\t\twindow.webAudioControlsMidiManager = new WebAudioControlsMidiManager();\n}\n","export default \"assets/nux_black_white_stripe.png\"","export default \"assets/switch_1.png\"","// This works when youuse a bundler such as rollup\n// If you do no wan to use a bundler, then  look at other examples\n// that build in pure JS the syles and html template directly\n// in the code...\nimport style from './Gui.css';\nimport template from './Gui.template.html';\nimport './utils/webaudio-controls.js';\n\nimport knobImg from './assets/nux_black_white_stripe.png';\nimport switchImg from './assets/switch_1.png';\n\nconst getAssetUrl = (asset) => {\n\tconst base = new URL('.', import.meta.url);\n\treturn `${base}${asset}`;\n};\n\n// The GUI is a WebComponent. Not mandatory but useful.\n// MANDORY : the GUI should be a DOM node. WebComponents are\n// practical as they encapsulate everyhing in a shadow dom\nexport default class PingPongDelayHTMLElement extends HTMLElement {\n\t/**\n\t * plugin = the same that is passed in the DSP part. It's the instance\n\t * of the class that extends WebAudioModule. It's an Observable plugin\n\t * @param {import('@webaudiomodules/sdk').WebAudioModule<import('../Node').default>} plugin\n\t * @memberof PingPongDelayHTMLElement\n\t */\n\tconstructor(plugin) {\n\t\tsuper();\n\n\t\tthis.root = this.attachShadow({ mode: 'open' });\n\t\tthis.root.innerHTML = `<style>${style}</style>${template}`;\n\n\t\t// MANDATORY for the GUI to observe the plugin state\n\t\tthis.plugin = plugin;\n\n\t\tthis.setResources();\n\t\tthis.setKnobs();\n\t\tthis.setSwitchListener();\n\t}\n\n\thandleAnimationFrame = () => {\n\t\tconst {\n\t\t\tfeedback,\n\t\t\tmix,\n\t\t\ttime,\n\t\t\tenabled,\n\t\t} = this.plugin.audioNode.paramMgr.getParamsValues();\n\t\tthis.shadowRoot.querySelector('#knob1').value = feedback * 100;\n\t\tthis.shadowRoot.querySelector('#knob2').value = time * 100;\n\t\tthis.shadowRoot.querySelector('#knob3').value = mix * 100;\n\t\tthis.shadowRoot.querySelector('#switch1').value = enabled;\n\t\twindow.requestAnimationFrame(this.handleAnimationFrame);\n\t}\n\n\t// Provided by the WebComponent API, called when the plugin is\n\t// connected to the DOM\n\tconnectedCallback() {\n\t\twindow.requestAnimationFrame(this.handleAnimationFrame);\n\t}\n\n\t/**\n\t * Change relative URLS to absolute URLs for CSS assets, webaudio controls spritesheets etc.\n\t */\n\tsetResources() {\n\t\t// Set up the background img & style\n\t\t// Setting up the knobs imgs, those are loaded from the assets\n\t\tthis.root.querySelectorAll('.knob').forEach((knob) => {\n\t\t\tknob.setAttribute('src', getAssetUrl(knobImg));\n\t\t});\n\t\tthis.root.querySelectorAll('.switch').forEach((sw) => {\n\t\t\tsw.setAttribute('src', getAssetUrl(switchImg));\n\t\t});\n\t}\n\n\tsetKnobs() {\n\t\tthis.shadowRoot\n\t\t\t.querySelector('#knob1')\n\t\t\t.addEventListener('input', (e) => {\n\t\t\t\tif (this.plugin.audioContext.state === 'suspended') this.plugin.audioNode.paramMgr.setParamValue('feedback', e.target.value / 100);\n\t\t\t\telse this.plugin.audioNode.paramMgr.setParamTargetAtTime('feedback', e.target.value / 100, this.plugin.audioContext.currentTime, 0.01);\n\t\t\t});\n\t\tthis.shadowRoot\n\t\t\t.querySelector('#knob2')\n\t\t\t.addEventListener('input', (e) => {\n\t\t\t\tif (this.plugin.audioContext.state === 'suspended') this.plugin.audioNode.paramMgr.setParamValue('time', e.target.value / 100);\n\t\t\t\telse this.plugin.audioNode.paramMgr.setParamTargetAtTime('time', e.target.value / 100, this.plugin.audioContext.currentTime, 0.01);\n\t\t\t});\n\t\tthis.shadowRoot\n\t\t\t.querySelector('#knob3')\n\t\t\t.addEventListener('input', (e) => {\n\t\t\t\tif (this.plugin.audioContext.state === 'suspended') this.plugin.audioNode.paramMgr.setParamValue('mix', e.target.value / 100);\n\t\t\t\telse this.plugin.audioNode.paramMgr.setParamTargetAtTime('mix', e.target.value / 100, this.plugin.audioContext.currentTime, 0.01);\n\t\t\t});\n\t}\n\n\tsetSwitchListener() {\n\t\tconst { plugin } = this;\n\t\tthis.shadowRoot\n\t\t\t.querySelector('#switch1')\n\t\t\t.addEventListener('change', function onChange() {\n\t\t\t\tplugin.audioNode.paramMgr.setParamValue('enabled', +!!this.checked);\n\t\t\t});\n\t}\n\n\t// name of the custom HTML element associated\n\t// with the plugin. Will appear in the DOM if\n\t// the plugin is visible\n\tstatic is() {\n\t\treturn 'wasabi-pingpongdelay';\n\t}\n}\n\nif (!customElements.get(PingPongDelayHTMLElement.is())) {\n\tcustomElements.define(PingPongDelayHTMLElement.is(), PingPongDelayHTMLElement);\n}\n","// This file is the factory for the GUI part..bundleRenderer.renderToStream\n// The imporant thing here is the createElement async method\n// This file must be an es module in order to be loaded with the SDK (with dynamic imports)\nimport PingPongDelayHTMLElement from './Gui.js';\n\nexport { PingPongDelayHTMLElement };\n\n/**\n * A mandatory method if you want a gui for your plugin\n * @param {import('@webaudiomodules/api').WebAudioModule} plugin - the plugin instance\n * @returns {Node} - the plugin root node that is inserted in the DOM of the host\n */\nexport async function createElement(plugin, ...args) {\n\t// here we return the WebComponent GUI but it could be\n// any DOM node\n\treturn new PingPongDelayHTMLElement(plugin, ...args);\n}\n","/* eslint-disable no-underscore-dangle */\n// Double role for WebAudioModule :\n// 1 - Factory for providing the DSP/WebAudio node and GUI\n// 2 - This makes the instance of the current class an Observable\n//     (state in WebAudioModule, initialized with the default values of\n//      the params variable below...)\nimport { WebAudioModule } from '@webaudiomodules/sdk';\nimport { ParamMgrFactory } from '@webaudiomodules/sdk-parammgr';\nimport PingPongDelayNode from './Node.js';\nimport { createElement } from './Gui/index.js';\n\n/**\n * @param {URL} relativeURL\n * @returns {string}\n */\nconst getBasetUrl = (relativeURL) => {\n\tconst baseURL = relativeURL.href.substring(0, relativeURL.href.lastIndexOf('/'));\n\treturn baseURL;\n};\n\n/**\n * Definition of a new plugin\n *\n * @class PingPongDelayPlugin\n * @extends {WebAudioModule<PingPongDelayNode>}\n */\nexport default class PingPongDelayPlugin extends WebAudioModule {\n\t_baseURL = getBasetUrl(new URL('.', import.meta.url));\n\n\t_descriptorUrl = `${this._baseURL}/descriptor.json`;\n\n\tasync _loadDescriptor() {\n\t\tconst url = this._descriptorUrl;\n\t\tif (!url) throw new TypeError('Descriptor not found');\n\t\tconst response = await fetch(url);\n\t\tconst descriptor = await response.json();\n\t\tObject.assign(this.descriptor, descriptor);\n\t}\n\n\tasync initialize(state) {\n\t\tawait this._loadDescriptor();\n\t\treturn super.initialize(state);\n\t}\n\n\tasync createAudioNode(initialState) {\n\t\tconst pingPongDelayNode = new PingPongDelayNode(this.audioContext);\n\n\t\tconst paramsConfig = {\n\t\t\tfeedback: {\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t},\n\t\t\ttime: {\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t},\n\t\t\tmix: {\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t},\n\t\t\tenabled: {\n\t\t\t\tdefaultValue: 1,\n\t\t\t},\n\t\t};\n\t\tconst internalParamsConfig = {\n\t\t\tdelayLeftTime: pingPongDelayNode.delayNodeLeft.delayTime,\n\t\t\tdelayRightTime: pingPongDelayNode.delayNodeRight.delayTime,\n\t\t\tdryGain: pingPongDelayNode.dryGainNode.gain,\n\t\t\twetGain: pingPongDelayNode.wetGainNode.gain,\n\t\t\tfeedback: pingPongDelayNode.feedbackGainNode.gain,\n\t\t\tenabled: { onChange: (value) => { pingPongDelayNode.status = !!value; } },\n\t\t};\n\t\tconst paramsMapping = {\n\t\t\ttime: {\n\t\t\t\tdelayLeftTime: {},\n\t\t\t\tdelayRightTime: {},\n\t\t\t},\n\t\t\tmix: {\n\t\t\t\tdryGain: {\n\t\t\t\t\tsourceRange: [0.5, 1],\n\t\t\t\t\ttargetRange: [1, 0],\n\t\t\t\t},\n\t\t\t\twetGain: {\n\t\t\t\t\tsourceRange: [0, 0.5],\n\t\t\t\t\ttargetRange: [0, 1],\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\tconst optionsIn = { internalParamsConfig, paramsConfig, paramsMapping };\n\t\tconst paramMgrNode = await ParamMgrFactory.create(this, optionsIn);\n\t\tpingPongDelayNode.setup(paramMgrNode);\n\t\tif (initialState) pingPongDelayNode.setState(initialState);\n\t\treturn pingPongDelayNode;\n\t}\n\n\tcreateGui() {\n\t\treturn createElement(this);\n\t}\n}\n"],"names":["groupId","audioContext","initialState","initialize","constructor","_groupId","_audioContext","_initialized","_audioNode","_timestamp","performance","now","_guiModuleUrl","_descriptorUrl","_descriptor","name","vendor","description","version","apiVersion","thumbnail","keywords","isInstrument","website","hasAudioInput","hasAudioOutput","hasAutomationInput","hasAutomationOutput","hasMidiInput","hasMidiOutput","hasMpeInput","hasMpeOutput","hasOscInput","hasOscOutput","hasSysexInput","hasSysexOutput","moduleId","descriptor","initialized","console","warn","node","value","TypeError","state","audioNode","createAudioNode","url","response","fetch","json","Object","assign","createElement","_loadGui","destroyGui","WebAudioModule_default","WebAudioModule","GainNode","__publicField","_wamNode","instanceId","module","addEventListener","args","removeEventListener","dispatchEvent","getParameterInfo","getParameterValues","setParameterValues","getState","setState","getCompensationDelay","scheduleEvents","clearEvents","connectEvents","disconnectEvents","destroy","count","_output","channelCount","mode","channelCountMode","interpretation","channelInterpretation","numberOfInputs","numberOfOutputs","connect","disconnect","PingPongDelayNode","CompositeAudioNode","paramMgr","options","undefined","log","createNodes","_input","context","createGain","delayNodeLeft","createDelay","delayNodeRight","dryGainNode","wetGainNode","feedbackGainNode","channelMerger","createChannelMerger","connectNodes","setup","wamNode","status","_sig","isEnabled","window","customElements","styles","document","innerHTML","head","appendChild","midimenu","id","opt","useMidi","midilearn","mididump","outline","knobSrc","knobSprites","knobWidth","knobHeight","knobDiameter","knobColors","sliderSrc","sliderKnobsrc","sliderWidth","sliderHeight","sliderKnobwidth","sliderKnobheight","sliderDitchlength","sliderColors","switchWidth","switchHeight","switchDiameter","switchColors","paramWidth","paramHeight","paramColors","WebAudioControlsOptions","WebAudioControlsWidget","HTMLElement","keydown","pointerdown","passive","wheel","pointerover","pointerout","contextMenu","hover","drag","body","basestyle","sendEvent","ev","event","createEvent","initEvent","getAttr","n","def","v","getAttribute","isNaN","showtip","d","numformat","s","x","i","indexOf","c","type","m","r","j","length","parseInt","toString","toUpperCase","toFixed","slice","replace","tooltip","valuetip","digits","ttframe","convValue","style","display","width","height","transition","opacity","visibility","rc","getBoundingClientRect","rc2","documentElement","left","top","e","webAudioControlsMidiManager","contextMenuOpen","preventDefault","stopPropagation","setMidiController","channel","cc","listeningToThisMidiController","midiController","processMidiEvent","data","controlNumber","midiMode","contextMenuClose","tagName","setValue","els","querySelectorAll","group","val","min","max","define","WebAudioKnob","src","_src","setupImage","_value","redraw","_min","_max","step","_step","sprites","_sprites","_width","_height","diameter","_diameter","colors","_colors","connectedCallback","root","elem","childNodes","enable","defvalue","sensitivity","conv","eval","midicc","ch","substring","lastIndexOf","coltab","addWidget","disconnectedCallback","kw","kh","split","svg","backgroundImage","btoa","backgroundSize","isConnected","range","sp","offset","backgroundPosition","transform","deg","_setValue","Math","round","oldvalue","f","delta","deltaY","shiftKey","abs","touches","changedTouches","identifier","buttons","button","focus","pointermove","lastShift","startPosX","pageX","startPosY","pageY","startVal","pointerup","preventScroll","ctrlKey","metaKey","error","WebAudioSlider","knobsrc","_knobsrc","direction","_direction","knobwidth","_knobwidth","knobheight","_knobheight","ditchlength","_ditchlength","knob","onclick","dr","dlen","kwidth","kheight","svgbody","svgthumb","sensex","sensey","WebAudioSwitch","invert","w","h","mm","checked","WebAudioParam","fontsize","_fontsize","link","fromLink","target","bind","onchange","le","getElementById","color","backgroundColor","fontSize","l","WebAudioKeyboard","keys","_keys","cv","ctx","getContext","_values","press","keycodes1","keycodes2","keyup","bheight","kp","kf","ko","kn","dispvalues","valuesold","rrect","y","c1","c2","g","createLinearGradient","addColorStop","fillStyle","beginPath","moveTo","lineTo","quadraticCurveTo","fill","fillRect","x0","x1","wwidth","bwidth","h2","strokeStyle","stroke","floor","k","keyCode","currentKey","sendEventFromKey","setNote","p","targetTouches","px","clientX","py","clientY","push","sort","values","sendevent","note","notes","setdispvalues","splice","WebAudioControlsMidiManager","midiAccess","listOfWidgets","listOfExternalMidiListeners","updateWidgets","initWebAudioControls","navigator","requestMIDIAccess","then","ma","enableInputs","err","code","inputs","input","next","done","onmidimessage","handleMIDIMessage","midiConnectionStateChange","onMIDIStarted","midi","onstatechange","addMidiListener","callback","getCurrentConfigAsJSON","currentConfig","stringify","forEach","externalListener","menu","classList","add","contextMenuCloseByKey","remove","menuItemLearn","contextMenuLearn","contextMenuClear","UseWebAudioControlsMidi","getAssetUrl","asset","base","URL","import","meta","PingPongDelayHTMLElement","plugin","feedback","mix","time","enabled","getParamsValues","shadowRoot","querySelector","requestAnimationFrame","handleAnimationFrame","attachShadow","template","setResources","setKnobs","setSwitchListener","setAttribute","knobImg","sw","switchImg","setParamValue","setParamTargetAtTime","currentTime","onChange","is","get","getBasetUrl","relativeURL","baseURL","href","PingPongDelayPlugin","_baseURL","_loadDescriptor","pingPongDelayNode","paramsConfig","minValue","maxValue","defaultValue","internalParamsConfig","delayLeftTime","delayTime","delayRightTime","dryGain","gain","wetGain","paramsMapping","sourceRange","targetRange","optionsIn","paramMgrNode","ParamMgrFactory","create","createGui"],"mappings":"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"}